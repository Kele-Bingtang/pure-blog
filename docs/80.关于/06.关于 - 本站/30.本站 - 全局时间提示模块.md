---
title: æœ¬ç«™ - å…¨å±€æ—¶é—´æç¤ºæ¨¡å—
date: 2022-02-13 21:26:37
permalink: /about/website/global-tip/
titleTag: åŸåˆ›
categories:
  - å…³äº - æœ¬ç«™
tags: 
  - æœ¬ç«™
---

::: note

è¿™åªæ˜¯ä¸€ä¸ªå°åŠŸèƒ½ï¼Œæ— è®ºè¿›å…¥æœ¬ç«™çš„ä»»æ„ç½‘é¡µï¼Œéƒ½ä¼šæœ‰æ¸©é¦¨çš„æ—¶é—´æç¤ºã€‚

::: right

2021-01-11 @Young Kbt

:::

[[TOC]]



## å‰è¨€

ç›®å‰é€‚ç”¨ç‰ˆæœ¬æ˜¯ Vdoing v1.xã€‚

å½“ä½ è¿›å…¥æœ¬ç«™ä»»æ„ç½‘é¡µæ—¶ï¼Œéƒ½ä¼šæœ‰ä¸åŒçš„æ—¶é—´æç¤ºï¼Œæ—¶é—´æç¤ºåˆ†ä¸ºäº”ç§ï¼šæ—©ä¸Šã€ä¸‹åˆã€é»„æ˜ã€æ™šä¸Šã€æ·±å¤œã€‚

æœ¬å†…å®¹æ­¥éª¤åˆ†ä¸ºä¸‰æ­¥ï¼š

- æ·»åŠ æ—¶é—´æ¶ˆæ¯æç¤ºçš„å›¾æ ‡
- ç¼–å†™å…¨å±€æ—¶é—´æç¤ºçš„ Vue ç»„ä»¶
- å…¨å±€æ³¨å†Œ Vue ç»„ä»¶

## æ·»åŠ æ¶ˆæ¯å›¾æ ‡

å›¾æ ‡åº“æ¥è‡ªé˜¿é‡Œäº‘ï¼š`https://www.iconfont.cn/`ã€‚

å¦‚æœä½ æ²¡æœ‰è´¦å·ï¼Œæˆ–è€…è§‰å¾—æ·»åŠ æ¯”è¾ƒéº»çƒ¦ï¼Œå°±ä½¿ç”¨æˆ‘çš„å›¾æ ‡åº“åœ°å€ï¼Œ**å½“ä½ å‘ç°å›¾æ ‡å¤±æ•ˆäº†ï¼Œå°±è¯·æ¥è¿™é‡Œè·å–æ–°çš„åœ°å€ï¼Œå¦‚æœè¿˜æ²¡æœ‰æ›´æ–°ï¼Œè¯·åœ¨è¯„è®ºåŒºç•™è¨€**ã€‚

å½“ç„¶ï¼Œå»ºè®®ä½ ä½¿ç”¨è‡ªå·±çš„å›¾æ ‡åº“ï¼Œæ¯”è¾ƒç¨³å®šã€‚

åœ¨ docs/.vuepress/config.jsï¼ˆæ–°ç‰ˆæ˜¯ config.tsï¼‰çš„ head æ¨¡å—é‡Œæ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```js
['link', { rel: 'stylesheet', href: '//at.alicdn.com/t/font_3114978_qe0b39no76.css' }],
```

## æ·»åŠ Vueç»„ä»¶

> å»ºè®®ï¼šæœ¬å†…å®¹ä»£ç å—æ¯”è¾ƒé•¿ï¼Œå¯ä»¥ç‚¹å‡»ä»£ç å—çš„å³ä¾§ç®­å¤´æ¥æŠ˜å ï¼Œç„¶åç‚¹å‡»å¤åˆ¶å›¾æ ‡è¿›è¡Œå¤åˆ¶å³å¯ã€‚

åœ¨ docs/.vuepress/components ç›®å½•ä¸‹åˆ›å»º Vue ç»„ä»¶ï¼š`GlobalTip.vue`ã€‚å¦‚æœä¸å­˜åœ¨ components ç›®å½•ï¼Œåˆ™è¯·åˆ›å»ºã€‚

æ·»åŠ å¦‚ä¸‹å†…å®¹ï¼š

```vue
<template></template>
<script>
// é¦–é¡µæ˜¯å¦å¼€å¯æ—¶é—´æ¶ˆæ¯æç¤ºï¼Œé»˜è®¤ falseã€‚å› ä¸ºé¦–é¡µå¤§å›¾æ¨¡å—å·²ç»å†…ç½®æ—¶é—´æ¶ˆæ¯æç¤ºï¼Œæ‰€ä»¥è¿™é‡Œä¸éœ€è¦å¼€å¯ï¼Œå¦‚æœæ‚¨ä¸ä½¿ç”¨é¦–é¡µå¤§å›¾æ¨¡å—ï¼Œå¯ä»¥å°†æ­¤å€¼è®¾ç½®ä¸º trueã€‚
const indexTip = false;
export default {
  mounted() {
    // é¦–é¡µä¸å¼¹å‡ºæ¶ˆæ¯æç¤ºï¼Œå› ä¸ºé¦–é¡µå¤§å›¾æ¨¡å—å·²ç»å†…ç½®é¦–é¡µçš„æ¶ˆæ¯æç¤º
    if (indexTip || this.$route.path != "/") {
      this.bgTimeColor();
    }
  },
  watch: {
    $route(to, from) {
      let gloablTip = document.getElementsByClassName("gloablTip");
      // å¦‚æœå·²ç»å­˜åœ¨ä¸€ä¸ªæ¶ˆæ¯æç¤ºï¼Œåˆ™ä¸ä¼šé‡æ–°å¼¹å‡ºï¼Œé™¤éæ¶ˆæ¯æç¤ºå·²ç»æ¶ˆå¤±
      if(gloablTip.length <= 0){
        if (indexTip || (this.$route.path != "/" && this.$route.hash == "")) {
          this.bgTimeColor();
        }
      }
    },
  },
  methods: {
    bgTimeColor() {
      var hours = new Date().getHours();
      var minutes = new Date().getMinutes();
      var seconds = new Date().getSeconds();
      hours = hours < 10 ? "0" + hours : hours;
      minutes = minutes < 10 ? "0" + minutes : minutes;
      seconds = seconds < 10 ? "0" + seconds : seconds;
      let div = document.createElement("div");
      div.className = "banner-color";
      if (hours >= 6 && hours < 11) {
        addTip(
          `æ—©ä¸Šå¥½å‘€~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œåƒæ—©é¤äº†å—ï¼ŸğŸ˜ŠğŸ¤­`,
          "info",
          50,
          4000
        );
      } else if (hours >= 12 && hours <= 16) {
        addTip(
          `ä¸‹åˆå¥½å‘€~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œç¹å¿™çš„ä¸‹åˆä¹Ÿè¦é€‚å½“ä¼‘æ¯å“¦ğŸ¥¤ğŸ€~~`,
          "info",
          50,
          4000
        );
      } else if (hours >= 16 && hours <= 19) {
        addTip(
          `åˆ°é»„æ˜äº†~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œè¯¥å‡†å¤‡åƒé¥­å•¦ğŸ¥—ğŸ–~~`,
          "info",
          50,
          4000
        );
      } else if (hours >= 19 && hours < 24) {
        addTip(
          `æ™šä¸Šå¥½å‘€~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œè¯¥å‡†å¤‡æ´—æ¼±ç¡è§‰å•¦ğŸ¥±ğŸ˜ª~~`,
          "info",
          50,
          4000
        );
      } else if (hours >= 0 && hours < 6) {
        addTip(
          `åˆ«å†ç†¬å¤œäº†~~ï¼Œç°åœ¨æ˜¯ ${hours}:${minutes}:${seconds}ï¼Œæ—©ç‚¹ç¡å§ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¬£èµæ—©ä¸Šçš„å¤ªé˜³~~ğŸ˜‡ğŸ›`,
          "info",
          50,
          4000
        );
      }
      document.body.append(div);
    },
  },
};

/**
 * æ·»åŠ æ¶ˆæ¯æç¤º
 * contentï¼šå†…å®¹
 * typeï¼šå¼¹çª—ç±»å‹ï¼ˆtipã€successã€warningã€dangerï¼‰
 * startHeightï¼šç¬¬ä¸€ä¸ªå¼¹çª—çš„é«˜åº¦ï¼Œé»˜è®¤ 50
 * dieTimeï¼šå¼¹çª—æ¶ˆå¤±æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰ï¼Œé»˜è®¤ 3000 æ¯«ç§’
 * 
 * åœ¨ head é‡Œæ·»åŠ å›¾æ ‡ link åœ°å€ï¼šhttps://at.alicdn.com/t/font_3114978_qe0b39no76.css
 */
function addTip(content, type, startHeight = 50, dieTime = 3000) {
  var tip = document.querySelectorAll(".global-tip");
  var time = new Date().getTime();
  // è·å–æœ€åæ¶ˆæ¯æç¤ºå…ƒç´ çš„é«˜åº¦
  var top = tip.length == 0 ? 0 : tip[tip.length - 1].getAttribute("data-top");
  // å¦‚æœäº§ç”Ÿä¸¤ä¸ªä»¥ä¸Šçš„æ¶ˆæ¯æç¤ºï¼Œåˆ™å‡ºç°åœ¨ä¸Šä¸€ä¸ªæç¤ºçš„ä¸‹é¢ï¼Œå³é«˜åº¦æ·»åŠ ï¼Œå¦åˆ™é»˜è®¤ 50
  var lastTop =
    parseInt(top) +
    (tip.length != 0 ? tip[tip.length - 1].offsetHeight + 17 : startHeight);

  let div = document.createElement("div");
  div.className = `global-tip tip-${type} ${time} gloablTip`;
  div.style.top = parseInt(top) + "px";
  div.setAttribute("data-top", lastTop);
  if (type == "info" || type == 1) {
    div.innerHTML = `<i class="iconfont icon-info icon"></i><p class="tip-info-content">${content}</p>`;
  } else if (type == "success" || type == 2) {
    div.innerHTML = `<i class="iconfont icon-dagouyouquan icon"></i><p class="tip-success-content">${content}</p>`;
  } else if (type == "danger" || type == 3) {
    div.innerHTML = `<i class="iconfont icon-cuowu icon"></i><p class="tip-danger-content">${content}</p>`;
  } else if (type == "warning" || type == 4) {
    div.innerHTML = `<i class="iconfont icon-gantanhao icon"></i><p class="tip-warning-content">${content}</p>`;
  }
  document.body.appendChild(div);

  let timeTip = document.getElementsByClassName(time)[0];
  setTimeout(() => {
    timeTip.style.top = parseInt(lastTop) + "px";
    timeTip.style.opacity = "1";
  }, 10);

  // æ¶ˆæ¯æç¤º dieTime ç§’åéšè—å¹¶è¢«åˆ é™¤
  setTimeout(() => {
    timeTip.style.top = "0px";
    timeTip.style.opacity = "0";

    // ä¸‹é¢çš„æ‰€æœ‰å…ƒç´ å›åˆ°å„è‡ªæ›¾ç»çš„å‡ºå‘ç‚¹
    var allTipElement = nextAllTipElement(timeTip);
    for (let i = 0; i < allTipElement.length; i++) {
      var next = allTipElement[i];
      var top =
        parseInt(next.getAttribute("data-top")) - next.offsetHeight - 17;
      next.setAttribute("data-top", top);
      next.style.top = top + "px";
    }
    setTimeout(() => {
      timeTip.remove();
    }, 500);
  }, dieTime);
}
/**
 * è·å–åé¢çš„å…„å¼Ÿå…ƒç´ 
 */
function nextAllTipElement(elem) {
  var r = [];
  var n = elem;
  for (; n; n = n.nextSibling) {
    if (n.nodeType === 1 && n !== elem) {
      r.push(n);
    }
  }
  return r;
}
</script>

<style>
/* æç¤ºæ¡†å…ƒç´  */
.global-tip {
  position: fixed;
  display: flex;
  top: -10px;
  left: 50%;
  opacity: 0;
  min-width: 320px;
  transform: translateX(-50%);
  transition: opacity 0.3s linear, top 0.4s, transform 0.4s;
  z-index: 99999;
  padding: 15px 15px 15px 20px;
  border: 1px solid #ebeef5;
  border-radius: 4px;
  grid-row: 1;
  line-height: 17px;
}

.global-tip p {
  line-height: 17px;
  margin: 0;
  font-size: 14px;
}

.icon {
  margin-right: 10px;
  line-height: 17px;
}

.tip-success {
  color: #67c23a;
  background-color: #f0f9eb;
  border-color: #e1f3d8;
}

.tip-success .tip-success-content {
  color: #67c23a;
}

.tip-danger {
  color: #f56c6c;
  background-color: #fef0f0;
  border-color: #fde2e2;
}

.tip-danger .tip-danger-content {
  color: #f56c6c;
}

.tip-info {
  background-color: #edf2fc;
  border-color: #ebeef5;
}

.tip-info .tip-info-content {
  color: #909399;
}

.tip-warning {
  color: #e6a23c;
  background-color: #fdf6ec;
  border-color: #faecd8;
}

.tip-warning .tip-warning-content {
  margin: 0;
  color: #e6a23c;
  line-height: 21px;
  font-size: 14px;
}
</style>
```

ä»£ç é»˜è®¤ä¸å¼€å¯é¦–é¡µçš„æ—¶é—´æç¤ºï¼Œä¹Ÿå°±æ˜¯é™¤äº†é¦–é¡µï¼Œå…¶ä»–ç½‘é¡µéƒ½ä¼šæç¤ºã€‚å› ä¸ºæˆ‘é…ç½®äº†é¦–é¡µå¤§å›¾æ¨¡å—ï¼Œè¯¥æ¨¡å—å·²ç»å†…ç½®æ—¶é—´æç¤ºï¼Œæ‰€ä»¥å¦‚æœä½ æ²¡æœ‰é…ç½®é¦–é¡µå¤§å›¾æ¨¡å—ï¼Œåˆ™åœ¨ç¬¬ 4 è¡Œæ”¹ä¸º trueã€‚

35ã€42ã€49ã€56ã€63 è¡Œæ˜¯ä¸åŒæ—¶é—´çš„æ—¶é—´æç¤ºï¼Œæ›´åŠ è‡ªå·±çš„å–œå¥½è¿›è¡Œä¿®æ”¹ã€‚

36ã€43ã€50ã€57ã€64 è¡Œé»˜è®¤æ—¶é—´æç¤ºçš„èƒŒæ™¯è‰²æ˜¯ infoï¼ˆç°è‰²ï¼‰ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¸‰ç§ï¼šsuccessï¼ˆç»¿è‰²ï¼‰ã€warningï¼ˆé»„è‰²ï¼‰ã€dangerï¼ˆçº¢è‰²ï¼‰ã€‚

## æ³¨å†ŒVueç»„ä»¶

åœ¨ docs/.vuepress/config.jsï¼ˆæ–°ç‰ˆæ˜¯ config.tsï¼‰çš„ plugins ä¸­æ·»åŠ æ’ä»¶é…ç½®ã€‚



:::: tabs :options="{ useUrlFragment: false }"

::: tab JS

```js
module.exports = {
    plugins: [
        {
            name: 'custom-plugins',
            globalUIComponents: ["GlobalTip"] // 2.x ç‰ˆæœ¬ globalUIComponents æ”¹åä¸º clientAppRootComponentFiles
        }
    ],
}
```

:::

::: tab TS

```tsx
import { UserPlugins } from 'vuepress/config'
plugins: <UserPlugins>[
    [
    	{
        	name: 'custom-plugins',
        	globalUIComponents: ["GlobalTip"] // 2.x ç‰ˆæœ¬ globalUIComponents æ”¹åä¸º clientAppRootComponentFiles
    	}
    ]
]
```

:::

::::

## ç»“æŸè¯­

å¦‚æœä½ è¿˜æœ‰ç–‘æƒ‘ï¼Œå¯ä»¥å»æˆ‘çš„ GitHub ä»“åº“æˆ–è€… Gitee ä»“åº“æŸ¥çœ‹æºç ã€‚

- [GitHub](https://github.com/Kele-Bingtang/Kele-Bingtang.github.io)

- [Gitee](https://gitee.com/kele-bingtang/Kele-Bingtang)

å¦‚æœä½ æœ‰æ›´å¥½çš„æ–¹å¼ï¼Œè¯„è®ºåŒºç•™è¨€å‘Šè¯‰æˆ‘ï¼Œæˆ–è€…åŠ å…¥ Vdoing ä¸»é¢˜çš„ QQ ç¾¤ï¼š694387113ã€‚è°¢è°¢ï¼
