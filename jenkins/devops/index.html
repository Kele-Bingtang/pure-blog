<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Jenkins - DevOps | Young Kbt blog</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <script>var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?14366b81d7983944862ae088864b209e"; 
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
          })();
          </script>
    <meta name="description" content="Young Kbt个人博客, VuePress搭建, 使用了 Vdoing 主题, 学习Java, Web, 框架, 微服务, 工具, 前端等相关知识, 记录生活和技术路程, 同时分享编程技巧。">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="keywords" content="Young Kbt个人博客, VuePress搭建, 学习Java、Web、框架、微服务、工具、前端等相关知识, 记录生活和技术路程。">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.b07bbc3a.css" as="style"><link rel="preload" href="/assets/js/app.7d9f7e76.js" as="script"><link rel="preload" href="/assets/js/2.7b39a60a.js" as="script"><link rel="preload" href="/assets/js/311.daf5fc45.js" as="script"><link rel="preload" href="/assets/js/7.e563704e.js" as="script"><link rel="preload" href="/assets/js/4.e30b0885.js" as="script"><link rel="prefetch" href="/assets/js/10.b6825257.js"><link rel="prefetch" href="/assets/js/100.d103d95b.js"><link rel="prefetch" href="/assets/js/101.ae6e3c8f.js"><link rel="prefetch" href="/assets/js/102.526b5644.js"><link rel="prefetch" href="/assets/js/103.68abd23e.js"><link rel="prefetch" href="/assets/js/104.bd57d04b.js"><link rel="prefetch" href="/assets/js/105.0642aac9.js"><link rel="prefetch" href="/assets/js/106.6b8f9f08.js"><link rel="prefetch" href="/assets/js/107.cc7e19b8.js"><link rel="prefetch" href="/assets/js/108.c4525208.js"><link rel="prefetch" href="/assets/js/109.0b1c7898.js"><link rel="prefetch" href="/assets/js/11.b5afe39f.js"><link rel="prefetch" href="/assets/js/110.8afa0063.js"><link rel="prefetch" href="/assets/js/111.28d673dc.js"><link rel="prefetch" href="/assets/js/112.66d9bd11.js"><link rel="prefetch" href="/assets/js/113.433669e6.js"><link rel="prefetch" href="/assets/js/114.e1cc4ff7.js"><link rel="prefetch" href="/assets/js/115.debd1417.js"><link rel="prefetch" href="/assets/js/116.f8015493.js"><link rel="prefetch" href="/assets/js/117.0ca04914.js"><link rel="prefetch" href="/assets/js/118.92cef09d.js"><link rel="prefetch" href="/assets/js/119.58db364e.js"><link rel="prefetch" href="/assets/js/12.0dcf3b8d.js"><link rel="prefetch" href="/assets/js/120.2fca89dd.js"><link rel="prefetch" href="/assets/js/121.682beb68.js"><link rel="prefetch" href="/assets/js/122.16c4338c.js"><link rel="prefetch" href="/assets/js/123.4bcb5658.js"><link rel="prefetch" href="/assets/js/124.f0812337.js"><link rel="prefetch" href="/assets/js/125.9547ffac.js"><link rel="prefetch" href="/assets/js/126.260b028e.js"><link rel="prefetch" href="/assets/js/127.35c305f1.js"><link rel="prefetch" href="/assets/js/128.51518491.js"><link rel="prefetch" href="/assets/js/129.4abce5b6.js"><link rel="prefetch" href="/assets/js/13.1917ed59.js"><link rel="prefetch" href="/assets/js/130.30b94ef1.js"><link rel="prefetch" href="/assets/js/131.043ebb9a.js"><link rel="prefetch" href="/assets/js/132.600a69b3.js"><link rel="prefetch" href="/assets/js/133.93f00f2b.js"><link rel="prefetch" href="/assets/js/134.6e0b6076.js"><link rel="prefetch" href="/assets/js/135.b48e1b10.js"><link rel="prefetch" href="/assets/js/136.a4467daa.js"><link rel="prefetch" href="/assets/js/137.defb23b7.js"><link rel="prefetch" href="/assets/js/138.a26227ea.js"><link rel="prefetch" href="/assets/js/139.5961a7f4.js"><link rel="prefetch" href="/assets/js/14.ce95fd70.js"><link rel="prefetch" href="/assets/js/140.5903e789.js"><link rel="prefetch" href="/assets/js/141.d255f04e.js"><link rel="prefetch" href="/assets/js/142.465e7162.js"><link rel="prefetch" href="/assets/js/143.50d0f8f7.js"><link rel="prefetch" href="/assets/js/144.340337d2.js"><link rel="prefetch" href="/assets/js/145.36c59bff.js"><link rel="prefetch" href="/assets/js/146.73100c57.js"><link rel="prefetch" href="/assets/js/147.e331cefd.js"><link rel="prefetch" href="/assets/js/148.87ae373b.js"><link rel="prefetch" href="/assets/js/149.f22b1782.js"><link rel="prefetch" href="/assets/js/15.9e02ccda.js"><link rel="prefetch" href="/assets/js/150.b4592a09.js"><link rel="prefetch" href="/assets/js/151.4f3d1dda.js"><link rel="prefetch" href="/assets/js/152.d8b4915b.js"><link rel="prefetch" href="/assets/js/153.2924288b.js"><link rel="prefetch" href="/assets/js/154.581cf5cf.js"><link rel="prefetch" href="/assets/js/155.6005dd53.js"><link rel="prefetch" href="/assets/js/156.4a9ed2cb.js"><link rel="prefetch" href="/assets/js/157.602dddd3.js"><link rel="prefetch" href="/assets/js/158.708e482f.js"><link rel="prefetch" href="/assets/js/159.425755c1.js"><link rel="prefetch" href="/assets/js/16.df720a5d.js"><link rel="prefetch" href="/assets/js/160.be1c227e.js"><link rel="prefetch" href="/assets/js/161.1f895b84.js"><link rel="prefetch" href="/assets/js/162.9ef108c5.js"><link rel="prefetch" href="/assets/js/163.dc1dd396.js"><link rel="prefetch" href="/assets/js/164.0df8355a.js"><link rel="prefetch" href="/assets/js/165.050ac25b.js"><link rel="prefetch" href="/assets/js/166.f7587509.js"><link rel="prefetch" href="/assets/js/167.8c7cfc7b.js"><link rel="prefetch" href="/assets/js/168.b50375d4.js"><link rel="prefetch" href="/assets/js/169.2d4bb241.js"><link rel="prefetch" href="/assets/js/17.1fd9e299.js"><link rel="prefetch" href="/assets/js/170.85b5600d.js"><link rel="prefetch" href="/assets/js/171.f138cd88.js"><link rel="prefetch" href="/assets/js/172.0ad47eee.js"><link rel="prefetch" href="/assets/js/173.2a5faa99.js"><link rel="prefetch" href="/assets/js/174.3324ae57.js"><link rel="prefetch" href="/assets/js/175.61bf147f.js"><link rel="prefetch" href="/assets/js/176.80292c8b.js"><link rel="prefetch" href="/assets/js/177.7999417a.js"><link rel="prefetch" href="/assets/js/178.e32debc3.js"><link rel="prefetch" href="/assets/js/179.f9463959.js"><link rel="prefetch" href="/assets/js/18.c42f17a3.js"><link rel="prefetch" href="/assets/js/180.09ef873d.js"><link rel="prefetch" href="/assets/js/181.d610926e.js"><link rel="prefetch" href="/assets/js/182.2e3e68ec.js"><link rel="prefetch" href="/assets/js/183.0e9b7309.js"><link rel="prefetch" href="/assets/js/184.ac5346d7.js"><link rel="prefetch" href="/assets/js/185.d21bcd1b.js"><link rel="prefetch" href="/assets/js/186.28ccb3ee.js"><link rel="prefetch" href="/assets/js/187.bcbcd0f4.js"><link rel="prefetch" href="/assets/js/188.de487e32.js"><link rel="prefetch" href="/assets/js/189.169cf767.js"><link rel="prefetch" href="/assets/js/19.3582dff6.js"><link rel="prefetch" href="/assets/js/190.7e6bf93c.js"><link rel="prefetch" href="/assets/js/191.0f5e1658.js"><link rel="prefetch" href="/assets/js/192.a32dbf35.js"><link rel="prefetch" href="/assets/js/193.a593fe1d.js"><link rel="prefetch" href="/assets/js/194.719cc463.js"><link rel="prefetch" href="/assets/js/195.1259e47a.js"><link rel="prefetch" href="/assets/js/196.a99da1c7.js"><link rel="prefetch" href="/assets/js/197.b0b21515.js"><link rel="prefetch" href="/assets/js/198.aa1ba0d6.js"><link rel="prefetch" href="/assets/js/199.6ed1691e.js"><link rel="prefetch" href="/assets/js/20.6c0cb91f.js"><link rel="prefetch" href="/assets/js/200.ba92f02f.js"><link rel="prefetch" href="/assets/js/201.11f54a16.js"><link rel="prefetch" href="/assets/js/202.58cd694b.js"><link rel="prefetch" href="/assets/js/203.2211b234.js"><link rel="prefetch" href="/assets/js/204.c547f4fe.js"><link rel="prefetch" href="/assets/js/205.50ab5161.js"><link rel="prefetch" href="/assets/js/206.1ce5b3a2.js"><link rel="prefetch" href="/assets/js/207.179f9bd4.js"><link rel="prefetch" href="/assets/js/208.aff15d57.js"><link rel="prefetch" href="/assets/js/209.7aacec3f.js"><link rel="prefetch" href="/assets/js/21.778fd061.js"><link rel="prefetch" href="/assets/js/210.b0da74e3.js"><link rel="prefetch" href="/assets/js/211.e34a57d1.js"><link rel="prefetch" href="/assets/js/212.1c389f99.js"><link rel="prefetch" href="/assets/js/213.4968ec40.js"><link rel="prefetch" href="/assets/js/214.96cd7dc1.js"><link rel="prefetch" href="/assets/js/215.2294f023.js"><link rel="prefetch" href="/assets/js/216.94b79bd7.js"><link rel="prefetch" href="/assets/js/217.66873941.js"><link rel="prefetch" href="/assets/js/218.46127ee9.js"><link rel="prefetch" href="/assets/js/219.8d56ef2a.js"><link rel="prefetch" href="/assets/js/22.089d9f58.js"><link rel="prefetch" href="/assets/js/220.88c5d45c.js"><link rel="prefetch" href="/assets/js/221.00faba44.js"><link rel="prefetch" href="/assets/js/222.eeb2a5f0.js"><link rel="prefetch" href="/assets/js/223.b9fc4f54.js"><link rel="prefetch" href="/assets/js/224.ac5a667f.js"><link rel="prefetch" href="/assets/js/225.4cc60a26.js"><link rel="prefetch" href="/assets/js/226.dffd6bb9.js"><link rel="prefetch" href="/assets/js/227.2a359dae.js"><link rel="prefetch" href="/assets/js/228.bf1438fd.js"><link rel="prefetch" href="/assets/js/229.dec18b07.js"><link rel="prefetch" href="/assets/js/23.93a4e46a.js"><link rel="prefetch" href="/assets/js/230.548f31e7.js"><link rel="prefetch" href="/assets/js/231.1c78b57d.js"><link rel="prefetch" href="/assets/js/232.3b857fb1.js"><link rel="prefetch" href="/assets/js/233.911b81f2.js"><link rel="prefetch" href="/assets/js/234.be86b8fe.js"><link rel="prefetch" href="/assets/js/235.cc8ea54a.js"><link rel="prefetch" href="/assets/js/236.b7bb40cd.js"><link rel="prefetch" href="/assets/js/237.2642218d.js"><link rel="prefetch" href="/assets/js/238.cfaf71b5.js"><link rel="prefetch" href="/assets/js/239.1034bf3d.js"><link rel="prefetch" href="/assets/js/24.c4395ec9.js"><link rel="prefetch" href="/assets/js/240.955ca6a3.js"><link rel="prefetch" href="/assets/js/241.6564b15e.js"><link rel="prefetch" href="/assets/js/242.1d1a8251.js"><link rel="prefetch" href="/assets/js/243.4765c501.js"><link rel="prefetch" href="/assets/js/244.c6274062.js"><link rel="prefetch" href="/assets/js/245.21362c48.js"><link rel="prefetch" href="/assets/js/246.462c1742.js"><link rel="prefetch" href="/assets/js/247.7ae3a9d0.js"><link rel="prefetch" href="/assets/js/248.d73ad74c.js"><link rel="prefetch" href="/assets/js/249.c2456396.js"><link rel="prefetch" href="/assets/js/25.5096818d.js"><link rel="prefetch" href="/assets/js/250.e8f1dc24.js"><link rel="prefetch" href="/assets/js/251.a33207d0.js"><link rel="prefetch" href="/assets/js/252.2f3c133d.js"><link rel="prefetch" href="/assets/js/253.2d6c1fb3.js"><link rel="prefetch" href="/assets/js/254.c4dde29b.js"><link rel="prefetch" href="/assets/js/255.9adfbab0.js"><link rel="prefetch" href="/assets/js/256.91139fda.js"><link rel="prefetch" href="/assets/js/257.b86b15e3.js"><link rel="prefetch" href="/assets/js/258.56cffe32.js"><link rel="prefetch" href="/assets/js/259.4dd27ce8.js"><link rel="prefetch" href="/assets/js/26.8043e201.js"><link rel="prefetch" href="/assets/js/260.37db56f7.js"><link rel="prefetch" href="/assets/js/261.26e412ed.js"><link rel="prefetch" href="/assets/js/262.64f081b2.js"><link rel="prefetch" href="/assets/js/263.d9fa3de2.js"><link rel="prefetch" href="/assets/js/264.2b7fb8fc.js"><link rel="prefetch" href="/assets/js/265.be87c3e1.js"><link rel="prefetch" href="/assets/js/266.17216d4f.js"><link rel="prefetch" href="/assets/js/267.3f13de5d.js"><link rel="prefetch" href="/assets/js/268.2ecc1c61.js"><link rel="prefetch" href="/assets/js/269.b2313ca5.js"><link rel="prefetch" href="/assets/js/27.7722643a.js"><link rel="prefetch" href="/assets/js/270.21277a28.js"><link rel="prefetch" href="/assets/js/271.3fb4b191.js"><link rel="prefetch" href="/assets/js/272.f8308978.js"><link rel="prefetch" href="/assets/js/273.de07e8f8.js"><link rel="prefetch" href="/assets/js/274.efadd2d2.js"><link rel="prefetch" href="/assets/js/275.a67b32c1.js"><link rel="prefetch" href="/assets/js/276.01c2f99a.js"><link rel="prefetch" href="/assets/js/277.a1e4c17a.js"><link rel="prefetch" href="/assets/js/278.3597dad7.js"><link rel="prefetch" href="/assets/js/279.39eb5fe6.js"><link rel="prefetch" href="/assets/js/28.950fd757.js"><link rel="prefetch" href="/assets/js/280.6ff96471.js"><link rel="prefetch" href="/assets/js/281.103fe69f.js"><link rel="prefetch" href="/assets/js/282.be71da36.js"><link rel="prefetch" href="/assets/js/283.de64f17d.js"><link rel="prefetch" href="/assets/js/284.9eb0b8fc.js"><link rel="prefetch" href="/assets/js/285.761859fc.js"><link rel="prefetch" href="/assets/js/286.346ccdc2.js"><link rel="prefetch" href="/assets/js/287.22ddf0f9.js"><link rel="prefetch" href="/assets/js/288.69b02cc4.js"><link rel="prefetch" href="/assets/js/289.1fc91664.js"><link rel="prefetch" href="/assets/js/29.e3efef75.js"><link rel="prefetch" href="/assets/js/290.09b43cdf.js"><link rel="prefetch" href="/assets/js/291.670c597a.js"><link rel="prefetch" href="/assets/js/292.3c8be194.js"><link rel="prefetch" href="/assets/js/293.ce187eca.js"><link rel="prefetch" href="/assets/js/294.a91e3d30.js"><link rel="prefetch" href="/assets/js/295.08100fa2.js"><link rel="prefetch" href="/assets/js/296.160bc832.js"><link rel="prefetch" href="/assets/js/297.4274595e.js"><link rel="prefetch" href="/assets/js/298.2f39a31a.js"><link rel="prefetch" href="/assets/js/299.5762f2da.js"><link rel="prefetch" href="/assets/js/3.78b8ad1e.js"><link rel="prefetch" href="/assets/js/30.b7735995.js"><link rel="prefetch" href="/assets/js/300.f39b59cc.js"><link rel="prefetch" href="/assets/js/301.9174b188.js"><link rel="prefetch" href="/assets/js/302.c0199c18.js"><link rel="prefetch" href="/assets/js/303.36446fe4.js"><link rel="prefetch" href="/assets/js/304.28526293.js"><link rel="prefetch" href="/assets/js/305.8c961411.js"><link rel="prefetch" href="/assets/js/306.35e14e4d.js"><link rel="prefetch" href="/assets/js/307.90595fb1.js"><link rel="prefetch" href="/assets/js/308.07ba8434.js"><link rel="prefetch" href="/assets/js/309.f1118e35.js"><link rel="prefetch" href="/assets/js/31.9e4bb835.js"><link rel="prefetch" href="/assets/js/310.8f818ee1.js"><link rel="prefetch" href="/assets/js/312.6f5b159a.js"><link rel="prefetch" href="/assets/js/313.2d5139a9.js"><link rel="prefetch" href="/assets/js/314.b3df01a2.js"><link rel="prefetch" href="/assets/js/315.d1a08dc7.js"><link rel="prefetch" href="/assets/js/316.43c3f8bc.js"><link rel="prefetch" href="/assets/js/317.30abc7e4.js"><link rel="prefetch" href="/assets/js/318.52698790.js"><link rel="prefetch" href="/assets/js/319.b646604d.js"><link rel="prefetch" href="/assets/js/32.803ad8dc.js"><link rel="prefetch" href="/assets/js/320.cef634e4.js"><link rel="prefetch" href="/assets/js/321.ab001cc2.js"><link rel="prefetch" href="/assets/js/322.afe55670.js"><link rel="prefetch" href="/assets/js/323.c663a8ec.js"><link rel="prefetch" href="/assets/js/324.3f8d5693.js"><link rel="prefetch" href="/assets/js/325.6ed9477b.js"><link rel="prefetch" href="/assets/js/326.60c465cd.js"><link rel="prefetch" href="/assets/js/327.bec7ea7a.js"><link rel="prefetch" href="/assets/js/328.3ef962e2.js"><link rel="prefetch" href="/assets/js/329.d6ccccab.js"><link rel="prefetch" href="/assets/js/33.0b3cff33.js"><link rel="prefetch" href="/assets/js/330.a1076e53.js"><link rel="prefetch" href="/assets/js/331.76598413.js"><link rel="prefetch" href="/assets/js/332.9e7f848a.js"><link rel="prefetch" href="/assets/js/333.6a6d7f3d.js"><link rel="prefetch" href="/assets/js/334.eff8c014.js"><link rel="prefetch" href="/assets/js/335.c8e1c83e.js"><link rel="prefetch" href="/assets/js/336.930669ce.js"><link rel="prefetch" href="/assets/js/337.b1feba3b.js"><link rel="prefetch" href="/assets/js/338.7dfa3e68.js"><link rel="prefetch" href="/assets/js/339.ae11034f.js"><link rel="prefetch" href="/assets/js/34.d0ee60c4.js"><link rel="prefetch" href="/assets/js/340.e2dfab8c.js"><link rel="prefetch" href="/assets/js/341.859b1112.js"><link rel="prefetch" href="/assets/js/342.a585d93c.js"><link rel="prefetch" href="/assets/js/343.f1d73e84.js"><link rel="prefetch" href="/assets/js/344.f875fd3c.js"><link rel="prefetch" href="/assets/js/345.9e174120.js"><link rel="prefetch" href="/assets/js/346.0248797e.js"><link rel="prefetch" href="/assets/js/347.6e2b880e.js"><link rel="prefetch" href="/assets/js/348.60468a87.js"><link rel="prefetch" href="/assets/js/349.88f9db3f.js"><link rel="prefetch" href="/assets/js/35.d885736b.js"><link rel="prefetch" href="/assets/js/350.c630111b.js"><link rel="prefetch" href="/assets/js/351.64adf51f.js"><link rel="prefetch" href="/assets/js/352.09555b5f.js"><link rel="prefetch" href="/assets/js/353.b912a2d5.js"><link rel="prefetch" href="/assets/js/354.fa20079b.js"><link rel="prefetch" href="/assets/js/355.926705f1.js"><link rel="prefetch" href="/assets/js/356.fad4ff0b.js"><link rel="prefetch" href="/assets/js/357.7cc580d8.js"><link rel="prefetch" href="/assets/js/358.f9719f2b.js"><link rel="prefetch" href="/assets/js/359.b69f7a3a.js"><link rel="prefetch" href="/assets/js/36.d32e0c7d.js"><link rel="prefetch" href="/assets/js/360.801d8b40.js"><link rel="prefetch" href="/assets/js/361.90d6e346.js"><link rel="prefetch" href="/assets/js/362.1e7346ac.js"><link rel="prefetch" href="/assets/js/363.f22c9fca.js"><link rel="prefetch" href="/assets/js/364.76d34c40.js"><link rel="prefetch" href="/assets/js/365.b65d2767.js"><link rel="prefetch" href="/assets/js/366.cf03d70a.js"><link rel="prefetch" href="/assets/js/367.b4bbe0db.js"><link rel="prefetch" href="/assets/js/368.914d5412.js"><link rel="prefetch" href="/assets/js/369.9b099efe.js"><link rel="prefetch" href="/assets/js/37.371090d1.js"><link rel="prefetch" href="/assets/js/370.c672552d.js"><link rel="prefetch" href="/assets/js/371.87f1821b.js"><link rel="prefetch" href="/assets/js/372.82e4be2e.js"><link rel="prefetch" href="/assets/js/373.96de1573.js"><link rel="prefetch" href="/assets/js/374.4117ae1c.js"><link rel="prefetch" href="/assets/js/375.0f48d5fe.js"><link rel="prefetch" href="/assets/js/376.11ea841a.js"><link rel="prefetch" href="/assets/js/377.e57737a0.js"><link rel="prefetch" href="/assets/js/378.4f1aa4e6.js"><link rel="prefetch" href="/assets/js/379.27799a36.js"><link rel="prefetch" href="/assets/js/38.27e886c4.js"><link rel="prefetch" href="/assets/js/380.c282bf16.js"><link rel="prefetch" href="/assets/js/381.b251870b.js"><link rel="prefetch" href="/assets/js/382.9b8d594e.js"><link rel="prefetch" href="/assets/js/383.edba6d00.js"><link rel="prefetch" href="/assets/js/384.38792a61.js"><link rel="prefetch" href="/assets/js/385.4f858cda.js"><link rel="prefetch" href="/assets/js/386.43b3e7f0.js"><link rel="prefetch" href="/assets/js/387.1e8b1bca.js"><link rel="prefetch" href="/assets/js/388.ad777b0c.js"><link rel="prefetch" href="/assets/js/389.d2778c85.js"><link rel="prefetch" href="/assets/js/39.2bea46e1.js"><link rel="prefetch" href="/assets/js/390.0b41b23f.js"><link rel="prefetch" href="/assets/js/391.e2aa3c31.js"><link rel="prefetch" href="/assets/js/392.08d66674.js"><link rel="prefetch" href="/assets/js/393.236c62b4.js"><link rel="prefetch" href="/assets/js/394.b3bbe6f3.js"><link rel="prefetch" href="/assets/js/395.99c2faf4.js"><link rel="prefetch" href="/assets/js/396.1f04605f.js"><link rel="prefetch" href="/assets/js/397.d3efe3ae.js"><link rel="prefetch" href="/assets/js/398.8a8f0f35.js"><link rel="prefetch" href="/assets/js/399.0c6be981.js"><link rel="prefetch" href="/assets/js/40.5069f7b9.js"><link rel="prefetch" href="/assets/js/400.48318902.js"><link rel="prefetch" href="/assets/js/401.4f281702.js"><link rel="prefetch" href="/assets/js/402.34991da3.js"><link rel="prefetch" href="/assets/js/403.25ec58aa.js"><link rel="prefetch" href="/assets/js/404.aa65a935.js"><link rel="prefetch" href="/assets/js/405.e7310d84.js"><link rel="prefetch" href="/assets/js/406.bc12db33.js"><link rel="prefetch" href="/assets/js/407.510a85fa.js"><link rel="prefetch" href="/assets/js/408.6a2d37f6.js"><link rel="prefetch" href="/assets/js/409.5b6a91ab.js"><link rel="prefetch" href="/assets/js/41.7acd4c1f.js"><link rel="prefetch" href="/assets/js/410.77f74daa.js"><link rel="prefetch" href="/assets/js/411.54eee144.js"><link rel="prefetch" href="/assets/js/412.6bac9eec.js"><link rel="prefetch" href="/assets/js/413.b0e33d0a.js"><link rel="prefetch" href="/assets/js/414.f977b5a9.js"><link rel="prefetch" href="/assets/js/415.b659834b.js"><link rel="prefetch" href="/assets/js/416.813b3fb9.js"><link rel="prefetch" href="/assets/js/417.ffea8a95.js"><link rel="prefetch" href="/assets/js/418.2e6c92d6.js"><link rel="prefetch" href="/assets/js/419.5633feac.js"><link rel="prefetch" href="/assets/js/42.74167a2e.js"><link rel="prefetch" href="/assets/js/420.198a4653.js"><link rel="prefetch" href="/assets/js/421.725b1d3a.js"><link rel="prefetch" href="/assets/js/422.f2bec49d.js"><link rel="prefetch" href="/assets/js/423.bd79c37c.js"><link rel="prefetch" href="/assets/js/424.d2b68f60.js"><link rel="prefetch" href="/assets/js/425.175fcc17.js"><link rel="prefetch" href="/assets/js/426.2f105da2.js"><link rel="prefetch" href="/assets/js/427.944e11a1.js"><link rel="prefetch" href="/assets/js/428.b0022fe6.js"><link rel="prefetch" href="/assets/js/429.5aaba160.js"><link rel="prefetch" href="/assets/js/43.a08f2844.js"><link rel="prefetch" href="/assets/js/430.2c115268.js"><link rel="prefetch" href="/assets/js/431.a13146d3.js"><link rel="prefetch" href="/assets/js/432.61e43e71.js"><link rel="prefetch" href="/assets/js/433.6fa7a555.js"><link rel="prefetch" href="/assets/js/434.b41278cd.js"><link rel="prefetch" href="/assets/js/435.aece757b.js"><link rel="prefetch" href="/assets/js/436.bb18daae.js"><link rel="prefetch" href="/assets/js/437.2f6a7e4e.js"><link rel="prefetch" href="/assets/js/438.509027e7.js"><link rel="prefetch" href="/assets/js/439.aef490af.js"><link rel="prefetch" href="/assets/js/44.fcbaa8b5.js"><link rel="prefetch" href="/assets/js/440.c3de28dd.js"><link rel="prefetch" href="/assets/js/441.c17b32f0.js"><link rel="prefetch" href="/assets/js/442.618ac531.js"><link rel="prefetch" href="/assets/js/443.3e6e6a25.js"><link rel="prefetch" href="/assets/js/444.0345d904.js"><link rel="prefetch" href="/assets/js/445.745909d0.js"><link rel="prefetch" href="/assets/js/446.3bb6d732.js"><link rel="prefetch" href="/assets/js/447.8a754244.js"><link rel="prefetch" href="/assets/js/448.d5bf5584.js"><link rel="prefetch" href="/assets/js/449.86eb5144.js"><link rel="prefetch" href="/assets/js/45.5446ff28.js"><link rel="prefetch" href="/assets/js/450.45dc7bae.js"><link rel="prefetch" href="/assets/js/451.2476df07.js"><link rel="prefetch" href="/assets/js/452.12b20843.js"><link rel="prefetch" href="/assets/js/453.b1f7c6ad.js"><link rel="prefetch" href="/assets/js/454.d0c69556.js"><link rel="prefetch" href="/assets/js/455.ec29b2df.js"><link rel="prefetch" href="/assets/js/456.dc86754b.js"><link rel="prefetch" href="/assets/js/457.d0f6a91b.js"><link rel="prefetch" href="/assets/js/458.b8336337.js"><link rel="prefetch" href="/assets/js/459.fb6637be.js"><link rel="prefetch" href="/assets/js/46.943c0d34.js"><link rel="prefetch" href="/assets/js/460.f3944a29.js"><link rel="prefetch" href="/assets/js/461.3d55326f.js"><link rel="prefetch" href="/assets/js/462.e6d87054.js"><link rel="prefetch" href="/assets/js/463.50afd2e7.js"><link rel="prefetch" href="/assets/js/464.d5c3c482.js"><link rel="prefetch" href="/assets/js/465.3c3c48dc.js"><link rel="prefetch" href="/assets/js/466.6a20609e.js"><link rel="prefetch" href="/assets/js/467.63d72787.js"><link rel="prefetch" href="/assets/js/468.8febc3fb.js"><link rel="prefetch" href="/assets/js/469.82fb6804.js"><link rel="prefetch" href="/assets/js/47.76ace16f.js"><link rel="prefetch" href="/assets/js/470.b83e6f93.js"><link rel="prefetch" href="/assets/js/471.c8611e3c.js"><link rel="prefetch" href="/assets/js/472.daa5a5b3.js"><link rel="prefetch" href="/assets/js/473.5f330161.js"><link rel="prefetch" href="/assets/js/474.0f55f5ff.js"><link rel="prefetch" href="/assets/js/475.8a436343.js"><link rel="prefetch" href="/assets/js/476.d43a0802.js"><link rel="prefetch" href="/assets/js/477.b5eb95e6.js"><link rel="prefetch" href="/assets/js/478.6bc64bc5.js"><link rel="prefetch" href="/assets/js/479.64d16a91.js"><link rel="prefetch" href="/assets/js/48.739263d5.js"><link rel="prefetch" href="/assets/js/480.4599cdd7.js"><link rel="prefetch" href="/assets/js/49.65437a65.js"><link rel="prefetch" href="/assets/js/5.f15c72b7.js"><link rel="prefetch" href="/assets/js/50.d2ee3f55.js"><link rel="prefetch" href="/assets/js/51.311d5ade.js"><link rel="prefetch" href="/assets/js/52.bfdc8e9f.js"><link rel="prefetch" href="/assets/js/53.5359ac8b.js"><link rel="prefetch" href="/assets/js/54.f8010d21.js"><link rel="prefetch" href="/assets/js/55.fe595a55.js"><link rel="prefetch" href="/assets/js/56.c0f0c3a8.js"><link rel="prefetch" href="/assets/js/57.136294b7.js"><link rel="prefetch" href="/assets/js/58.7f208b82.js"><link rel="prefetch" href="/assets/js/59.fdbd0d41.js"><link rel="prefetch" href="/assets/js/6.f2722aef.js"><link rel="prefetch" href="/assets/js/60.8c0d65fe.js"><link rel="prefetch" href="/assets/js/61.7d48bcd3.js"><link rel="prefetch" href="/assets/js/62.d724e4aa.js"><link rel="prefetch" href="/assets/js/63.c2559e67.js"><link rel="prefetch" href="/assets/js/64.649291bd.js"><link rel="prefetch" href="/assets/js/65.0f6c617f.js"><link rel="prefetch" href="/assets/js/66.672f4c77.js"><link rel="prefetch" href="/assets/js/67.f3a71885.js"><link rel="prefetch" href="/assets/js/68.e3d4937d.js"><link rel="prefetch" href="/assets/js/69.6fb7bc4d.js"><link rel="prefetch" href="/assets/js/70.dd124372.js"><link rel="prefetch" href="/assets/js/71.4a756005.js"><link rel="prefetch" href="/assets/js/72.c2b6894c.js"><link rel="prefetch" href="/assets/js/73.5a1916b7.js"><link rel="prefetch" href="/assets/js/74.8eb238c0.js"><link rel="prefetch" href="/assets/js/75.9aaf8408.js"><link rel="prefetch" href="/assets/js/76.80203376.js"><link rel="prefetch" href="/assets/js/77.f3f8794f.js"><link rel="prefetch" href="/assets/js/78.0090e20b.js"><link rel="prefetch" href="/assets/js/79.e6f4b2b0.js"><link rel="prefetch" href="/assets/js/8.49e45d52.js"><link rel="prefetch" href="/assets/js/80.aa562b5f.js"><link rel="prefetch" href="/assets/js/81.de8f199b.js"><link rel="prefetch" href="/assets/js/82.b78e5955.js"><link rel="prefetch" href="/assets/js/83.d7c0e01e.js"><link rel="prefetch" href="/assets/js/84.1ddbe7a4.js"><link rel="prefetch" href="/assets/js/85.9fe8d47e.js"><link rel="prefetch" href="/assets/js/86.f795b7ab.js"><link rel="prefetch" href="/assets/js/87.effa924a.js"><link rel="prefetch" href="/assets/js/88.d9854d1e.js"><link rel="prefetch" href="/assets/js/89.b7d54d15.js"><link rel="prefetch" href="/assets/js/9.9578969c.js"><link rel="prefetch" href="/assets/js/90.b17ee25c.js"><link rel="prefetch" href="/assets/js/91.c5c7c6e3.js"><link rel="prefetch" href="/assets/js/92.72d4d2ea.js"><link rel="prefetch" href="/assets/js/93.fadf96ec.js"><link rel="prefetch" href="/assets/js/94.53efcdf4.js"><link rel="prefetch" href="/assets/js/95.2928f167.js"><link rel="prefetch" href="/assets/js/96.62918d30.js"><link rel="prefetch" href="/assets/js/97.3bb50446.js"><link rel="prefetch" href="/assets/js/98.12e7a055.js"><link rel="prefetch" href="/assets/js/99.3daa2010.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b07bbc3a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/index/logo.png" alt="Young Kbt blog" class="logo"> <span class="site-name can-hide">Young Kbt blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>java基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/se/" class="nav-link">Java基础</a></li><li class="dropdown-subitem"><a href="/java/collection/" class="nav-link">Java集合</a></li><li class="dropdown-subitem"><a href="/java/se/reflect/" class="nav-link">Java反射</a></li><li class="dropdown-subitem"><a href="/java/juc/" class="nav-link">JavaJUC</a></li><li class="dropdown-subitem"><a href="/java/jvm/" class="nav-link">JavaJVM</a></li></ul></li><li class="dropdown-item"><h4>Java容器</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/javaweb/concept/" class="nav-link">JavaWeb</a></li></ul></li><li class="dropdown-item"><h4>Java版本新特性</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/new-features/" class="nav-link">Java新特性</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/database/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL 数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/oracle/" class="nav-link">Oracle</a></li></ul></li><li class="dropdown-item"><h4>NoSQL 数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/es/" class="nav-link">ElasticSearch</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/frames/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mybatis/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/mybatis-plus/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>消息中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/activemq/" class="nav-link">ActiveMQ</a></li><li class="dropdown-subitem"><a href="/rabbitmq/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/rocketmq/" class="nav-link">RocketMQ</a></li><li class="dropdown-subitem"><a href="/kafka/" class="nav-link">Kafka</a></li></ul></li><li class="dropdown-item"><h4>进阶服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/nginx/" class="nav-link">Nginx</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring生态" class="dropdown-title"><a href="/spring-ecology/" class="link-title">Spring生态</a> <span class="title" style="display:none;">Spring生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/spring-boot/" class="nav-link">Spring Boot</a></li><li class="dropdown-item"><!----> <a href="/spring-security/" class="nav-link">Spring Security</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><a href="/dev-guide/" class="link-title">开发</a> <span class="title" style="display:none;">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/knowledge/" class="nav-link">知识</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tool/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maven/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/git/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>部署</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/jenkins/" class="nav-link router-link-active">Jenkins</a></li><li class="dropdown-subitem"><a href="/kubernetes/" class="nav-link">Kubernetes</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/typescript/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/vue2/" class="nav-link">Vue2</a></li><li class="dropdown-subitem"><a href="/vue3/" class="nav-link">Vue3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whells-use/" class="nav-link">轮子工具</a></li><li class="dropdown-item"><!----> <a href="/projects/" class="nav-link">项目工程</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>本站</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>我的</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whell/web/" class="nav-link">收藏</a></li><li class="dropdown-subitem"><a href="/about/website/introduce/" class="nav-link">关于</a></li><li class="dropdown-subitem"><a href="https://vue2-admin.youngkbt.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue2-Admin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://vue3-admin.youngkbt.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3-Admin（完善）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/Kele-Bingtang/pure-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/user/avatar2.png"> <div class="blogger-info"><h3>Shp Liu</h3> <span>朝圣的使徒，正在走向编程的至高殿堂！</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>java基础</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/se/" class="nav-link">Java基础</a></li><li class="dropdown-subitem"><a href="/java/collection/" class="nav-link">Java集合</a></li><li class="dropdown-subitem"><a href="/java/se/reflect/" class="nav-link">Java反射</a></li><li class="dropdown-subitem"><a href="/java/juc/" class="nav-link">JavaJUC</a></li><li class="dropdown-subitem"><a href="/java/jvm/" class="nav-link">JavaJVM</a></li></ul></li><li class="dropdown-item"><h4>Java容器</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/javaweb/concept/" class="nav-link">JavaWeb</a></li></ul></li><li class="dropdown-item"><h4>Java版本新特性</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/java/new-features/" class="nav-link">Java新特性</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/database/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>SQL 数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mysql/" class="nav-link">MySQL</a></li><li class="dropdown-subitem"><a href="/oracle/" class="nav-link">Oracle</a></li></ul></li><li class="dropdown-item"><h4>NoSQL 数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/redis/" class="nav-link">Redis</a></li><li class="dropdown-subitem"><a href="/es/" class="nav-link">ElasticSearch</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><a href="/frames/" class="link-title">框架</a> <span class="title" style="display:none;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/mybatis/" class="nav-link">MyBatis</a></li><li class="dropdown-subitem"><a href="/mybatis-plus/" class="nav-link">MyBatis-Plus</a></li></ul></li><li class="dropdown-item"><h4>消息中间件</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/activemq/" class="nav-link">ActiveMQ</a></li><li class="dropdown-subitem"><a href="/rabbitmq/" class="nav-link">RabbitMQ</a></li><li class="dropdown-subitem"><a href="/rocketmq/" class="nav-link">RocketMQ</a></li><li class="dropdown-subitem"><a href="/kafka/" class="nav-link">Kafka</a></li></ul></li><li class="dropdown-item"><h4>进阶服务</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/nginx/" class="nav-link">Nginx</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring生态" class="dropdown-title"><a href="/spring-ecology/" class="link-title">Spring生态</a> <span class="title" style="display:none;">Spring生态</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/spring/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/spring-boot/" class="nav-link">Spring Boot</a></li><li class="dropdown-item"><!----> <a href="/spring-security/" class="nav-link">Spring Security</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="开发" class="dropdown-title"><a href="/dev-guide/" class="link-title">开发</a> <span class="title" style="display:none;">开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/design-pattern/" class="nav-link">设计模式</a></li><li class="dropdown-item"><!----> <a href="/algorithm/" class="nav-link">算法</a></li><li class="dropdown-item"><!----> <a href="/knowledge/" class="nav-link">知识</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="工具" class="dropdown-title"><a href="/tool/" class="link-title">工具</a> <span class="title" style="display:none;">工具</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>管理</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/maven/" class="nav-link">Maven</a></li><li class="dropdown-subitem"><a href="/git/" class="nav-link">Git</a></li></ul></li><li class="dropdown-item"><h4>部署</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/linux/" class="nav-link">Linux</a></li><li class="dropdown-subitem"><a href="/docker/" class="nav-link">Docker</a></li><li class="dropdown-subitem"><a href="/jenkins/" class="nav-link router-link-active">Jenkins</a></li><li class="dropdown-subitem"><a href="/kubernetes/" class="nav-link">Kubernetes</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/front/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>进阶</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/typescript/" class="nav-link">TypeScript</a></li></ul></li><li class="dropdown-item"><h4>框架</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/react/" class="nav-link">React</a></li><li class="dropdown-subitem"><a href="/vue2/" class="nav-link">Vue2</a></li><li class="dropdown-subitem"><a href="/vue3/" class="nav-link">Vue3</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><!----> <span class="title" style="display:;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/whells-use/" class="nav-link">轮子工具</a></li><li class="dropdown-item"><!----> <a href="/projects/" class="nav-link">项目工程</a></li><li class="dropdown-item"><!----> <a href="/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>本站</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4>我的</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/whell/web/" class="nav-link">收藏</a></li><li class="dropdown-subitem"><a href="/about/website/introduce/" class="nav-link">关于</a></li><li class="dropdown-subitem"><a href="https://vue2-admin.youngkbt.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue2-Admin
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://vue3-admin.youngkbt.cn/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Vue3-Admin（完善）
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div> <a href="https://github.com/Kele-Bingtang/pure-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>版本管理 - Maven</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>开发管理 - Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>操作系统 - Linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>容器部署 - Docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>持续集成 - Jenkins</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jenkins/introduce/" class="sidebar-link">Jenkins - 介绍</a></li><li><a href="/jenkins/install-configure/" class="sidebar-link">Jenkins - 安装和配置</a></li><li><a href="/jenkins/projects/" class="sidebar-link">Jenkins - 多个项目搭建</a></li><li><a href="/jenkins/devops/" aria-current="page" class="active sidebar-link">Jenkins - DevOps</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#devops-介绍" class="sidebar-link">DevOps 介绍</a></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#code-阶段工具" class="sidebar-link">Code 阶段工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#git-安装" class="sidebar-link">Git 安装</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#gitlab-安装" class="sidebar-link">GitLab 安装</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#build-阶段工具" class="sidebar-link">Build 阶段工具</a></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#operate-阶段工具" class="sidebar-link">Operate 阶段工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#docker-安装" class="sidebar-link">Docker 安装</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#docker-compose-安装" class="sidebar-link">Docker-Compose 安装</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#integrate-工具" class="sidebar-link">Integrate 工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-介绍" class="sidebar-link">Jenkins 介绍</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-安装" class="sidebar-link">Jenkins 安装</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-入门配置" class="sidebar-link">Jenkins 入门配置</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#构建任务" class="sidebar-link">构建任务</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#配置源码拉取地址" class="sidebar-link">配置源码拉取地址</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#配置-maven-构建代码" class="sidebar-link">配置 Maven 构建代码</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#配置-publish-发布-远程操作" class="sidebar-link">配置 Publish 发布 &amp; 远程操作</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#ci、cd-入门操作" class="sidebar-link">CI、CD 入门操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#持续集成" class="sidebar-link">持续集成</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#持续交付、部署" class="sidebar-link">持续交付、部署</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#集成-sonar-qube" class="sidebar-link">集成 Sonar Qube</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#sonar-qube-介绍" class="sidebar-link">Sonar Qube 介绍</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#sonar-qube-环境搭建" class="sidebar-link">Sonar Qube 环境搭建</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#sonar-qube-安装" class="sidebar-link">Sonar Qube 安装</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#安装中文插件" class="sidebar-link">安装中文插件</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#sonar-qube-基本使用" class="sidebar-link">Sonar Qube 基本使用</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#maven-实现代码检测" class="sidebar-link">Maven 实现代码检测</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#sonar-scanner-实现代码检测" class="sidebar-link">Sonar-scanner 实现代码检测</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-集成-sonar-qube" class="sidebar-link">Jenkins 集成 Sonar Qube</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#jenkins-安装插件" class="sidebar-link">Jenkins 安装插件</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#jenkins-配置-sonar-qube" class="sidebar-link">Jenkins 配置 Sonar Qube</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#配置-sonar-scanner" class="sidebar-link">配置 Sonar-scanner</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#构建任务-2" class="sidebar-link">构建任务</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#集成-harbor" class="sidebar-link">集成 Harbor</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#harbor-介绍" class="sidebar-link">Harbor 介绍</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#harbor-安装" class="sidebar-link">Harbor 安装</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#harbor-使用方式" class="sidebar-link">Harbor 使用方式</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#添加用户构建项目" class="sidebar-link">添加用户构建项目</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#发布镜像到-harbor" class="sidebar-link">发布镜像到 Harbor</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#从-harbor-拉取镜像" class="sidebar-link">从 Harbor 拉取镜像</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#jenkins-容器使用宿主机-docker" class="sidebar-link">Jenkins 容器使用宿主机 Docker</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#编写部署脚本" class="sidebar-link">编写部署脚本</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#配置构建后操作" class="sidebar-link">配置构建后操作</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#jenkins-流水线" class="sidebar-link">Jenkins 流水线</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-流水线任务介绍" class="sidebar-link">Jenkins 流水线任务介绍</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-流水线任务" class="sidebar-link">Jenkins 流水线任务</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#构建-jenkins-流水线任务" class="sidebar-link">构建 Jenkins 流水线任务</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#groovy-脚本" class="sidebar-link">Groovy 脚本</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#jenkinsfile-实现" class="sidebar-link">Jenkinsfile 实现</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-流水线任务实现" class="sidebar-link">Jenkins 流水线任务实现</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#参数化构建" class="sidebar-link">参数化构建</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#拉取-git-代码" class="sidebar-link">拉取 Git 代码</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#构建代码" class="sidebar-link">构建代码</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#代码质量检测" class="sidebar-link">代码质量检测</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#制作自定义镜像并发布" class="sidebar-link">制作自定义镜像并发布</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-流水线整合钉钉" class="sidebar-link">Jenkins 流水线整合钉钉</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/jenkins/devops/#kubernetes-编排工具" class="sidebar-link">Kubernetes 编排工具</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#kubernetes-介绍" class="sidebar-link">Kubernetes 介绍</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#kubernetes-架构" class="sidebar-link">Kubernetes 架构</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#kubernetes-安装" class="sidebar-link">Kubernetes 安装</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#kubernetes-操作" class="sidebar-link">Kubernetes 操作</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#namespace" class="sidebar-link">Namespace</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#pod" class="sidebar-link">Pod</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#deployment" class="sidebar-link">Deployment</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#service" class="sidebar-link">Service</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#ingress" class="sidebar-link">Ingress</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#jenkins-集成-kubernetes" class="sidebar-link">Jenkins 集成 Kubernetes</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#准备部署的-yml-文件" class="sidebar-link">准备部署的 yml 文件</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#harbor-私服配置" class="sidebar-link">Harbor 私服配置</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#测试使用效果" class="sidebar-link">测试使用效果</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#jenkins-远程调用" class="sidebar-link">Jenkins 远程调用</a></li><li class="sidebar-sub-header level3"><a href="/jenkins/devops/#基于-gitlab-的-webhooks" class="sidebar-link">基于 GitLab 的 WebHooks</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#webhooks-通知" class="sidebar-link">WebHooks 通知</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#修改配置" class="sidebar-link">修改配置</a></li><li class="sidebar-sub-header level4"><a href="/jenkins/devops/#滚动更新" class="sidebar-link">滚动更新</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>容器管理 - kubernetes</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/categories/?category=%E5%B7%A5%E5%85%B7" title="分类" data-v-06225672>工具</a></li><li data-v-06225672><a href="/categories/?category=%E6%8C%81%E7%BB%AD%E9%9B%86%E6%88%90%20-%20Jenkins" title="分类" data-v-06225672>持续集成 - Jenkins</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://www.youngkbt.cn" target="_blank" title="作者" class="beLink" data-v-06225672>Young Kbt </a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-07-09</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Jenkins - DevOps<!----></h1> <!----> <div class="theme-vdoing-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#devops-介绍">DevOps 介绍</a></li><li><a href="#code-阶段工具">Code 阶段工具</a><ul><li><a href="#git-安装">Git 安装</a></li><li><a href="#gitlab-安装">GitLab 安装</a></li></ul></li><li><a href="#build-阶段工具">Build 阶段工具</a></li><li><a href="#operate-阶段工具">Operate 阶段工具</a><ul><li><a href="#docker-安装">Docker 安装</a></li><li><a href="#docker-compose-安装">Docker-Compose 安装</a></li></ul></li><li><a href="#integrate-工具">Integrate 工具</a><ul><li><a href="#jenkins-介绍">Jenkins 介绍</a></li><li><a href="#jenkins-安装">Jenkins 安装</a></li><li><a href="#jenkins-入门配置">Jenkins 入门配置</a></li></ul></li><li><a href="#ci、cd-入门操作">CI、CD 入门操作</a><ul><li><a href="#持续集成">持续集成</a></li><li><a href="#持续交付、部署">持续交付、部署</a></li></ul></li><li><a href="#集成-sonar-qube">集成 Sonar Qube</a><ul><li><a href="#sonar-qube-介绍">Sonar Qube 介绍</a></li><li><a href="#sonar-qube-环境搭建">Sonar Qube 环境搭建</a></li><li><a href="#sonar-qube-基本使用">Sonar Qube 基本使用</a></li><li><a href="#jenkins-集成-sonar-qube">Jenkins 集成 Sonar Qube</a></li></ul></li><li><a href="#集成-harbor">集成 Harbor</a><ul><li><a href="#harbor-介绍">Harbor 介绍</a></li><li><a href="#harbor-安装">Harbor 安装</a></li><li><a href="#harbor-使用方式">Harbor 使用方式</a></li></ul></li><li><a href="#jenkins-流水线">Jenkins 流水线</a><ul><li><a href="#jenkins-流水线任务介绍">Jenkins 流水线任务介绍</a></li><li><a href="#jenkins-流水线任务">Jenkins 流水线任务</a></li><li><a href="#jenkins-流水线任务实现">Jenkins 流水线任务实现</a></li><li><a href="#jenkins-流水线整合钉钉">Jenkins 流水线整合钉钉</a></li></ul></li><li><a href="#kubernetes-编排工具">Kubernetes 编排工具</a><ul><li><a href="#kubernetes-介绍">Kubernetes 介绍</a></li><li><a href="#kubernetes-架构">Kubernetes 架构</a></li><li><a href="#kubernetes-安装">Kubernetes 安装</a></li><li><a href="#kubernetes-操作">Kubernetes 操作</a></li><li><a href="#jenkins-集成-kubernetes">Jenkins 集成 Kubernetes</a></li><li><a href="#基于-gitlab-的-webhooks">基于 GitLab 的 WebHooks</a></li></ul></li></ul></div><p></p> <p>学习自：<code>https://www.bilibili.com/video/BV1To4y1g7G4</code>。</p> <h2 id="devops-介绍"><a href="#devops-介绍" class="header-anchor">#</a> DevOps 介绍</h2> <p>软件开发最开始是由两个团队组成：</p> <ul><li>开发计划由 <strong>开发团队</strong> 从头开始设计和整体系统的构建。需要系统不停的迭代更新</li> <li><strong>运维团队</strong> 将开发团队的 Code 进行测试后部署上线。希望系统稳定安全运行</li></ul> <p>这看似两个目标不同的团队需要协同完成一个软件的开发。</p> <p>在开发团队指定好计划并完成 coding 后，需要提供到运维团队。</p> <p>运维团队向开发团队反馈需要修复的BUG以及一些需要返工的任务。</p> <p>这时开发团队需要经常等待运维团队的反馈。这无疑延长了事件并推迟了整个软件开发的周期。</p> <p>会有一种方式，在开发团队等待的时候，让开发团队转移到下一个项目中。等待运维团队为之前的代码提供反馈。</p> <p>可是这样就意味着一个完整的项目需要一个更长的周期才可以开发出最终代码。</p> <p>基于现在的互联网现状，更推崇敏捷式开发，这样就导致项目的迭代速度更快，但是由于开发团队与运维团队的沟通问题，会导致新版本上线的时间成本很高。这又违背的敏捷式开发的最初的目的。</p> <p>那么如果让开发团队和运维团队整合到成一个团队，协同应对一套软件呢？这就被称为 <strong>DevOps</strong>。</p> <p>DevOps，字面意思是 Development &amp; Operations 的缩写，也就是开发 &amp; 运维。</p> <p>虽然字面意思只涉及到了开发团队和运维团队，其实 QA 测试团队也是参与其中的。</p> <p>网上可以查看到 DevOps 的符号类似于一个无穷大的符号</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230708235644.png" alt="image-20211124130409521"></p> <p>这表明 DevOps 是一个不断提高效率并且持续不断工作的过程</p> <p>DevOps 的方式可以让公司能够更快地应对更新和市场发展变化，开发可以快速交付，部署也更加稳定。</p> <p>核心就在于 <strong>简化 Dev 和 Ops 团队之间的流程，使整体软件开发过程更快速</strong>。</p> <p>整体的软件开发流程包括：</p> <ul><li>PLAN：开发团队根据客户的目标制定开发计划</li> <li>CODE：根据PLAN开始编码过程，需要将不同版本的代码存储在一个库中</li> <li>BUILD：编码完成后，需要将代码构建并且运行</li> <li>TEST：成功构建项目后，需要测试代码是否存在BUG或错误</li> <li>DEPLOY：代码经过手动测试和自动化测试后，认定代码已经准备好部署并且交给运维团队</li> <li>OPERATE：运维团队将代码部署到生产环境中</li> <li>MONITOR：项目部署上线后，需要持续的监控产品</li> <li>INTEGRATE：然后将监控阶段收到的反馈发送回PLAN阶段，整体反复的流程就是 DevOps 的核心，即持续集成、持续部署</li></ul> <p>为了保证整体流程可以高效的完成，各个阶段都有比较常见的工具，如下图：</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230708235651.png" alt="2021-11-23_175935"></p> <p>最终可以给 DevOps 下一个定义：DevOps 强调的是高效组织团队之间如何通过自动化的工具协作和沟通来完成软件的生命周期管理，从而更快、更频繁地交付更稳定的软件。</p> <p>自动化的工具协作和沟通来完成软件的生命周期管理。</p> <h2 id="code-阶段工具"><a href="#code-阶段工具" class="header-anchor">#</a> Code 阶段工具</h2> <p>在 code 阶段，我们需要将不同版本的代码存储到一个仓库中，常见的版本控制工具就是 SVN 或者 Git，这里我们采用 Git 作为版本控制工具，GitLab 作为远程仓库。</p> <h3 id="git-安装"><a href="#git-安装" class="header-anchor">#</a> Git 安装</h3> <p><code>https://git-scm.com/</code>（傻瓜式安装）</p> <h3 id="gitlab-安装"><a href="#gitlab-安装" class="header-anchor">#</a> GitLab 安装</h3> <p>单独准备服务器，采用 Docker 安装</p> <ul><li><p>查看 GitLab 镜像</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> search gitlab
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>拉取 GitLab 镜像</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> pull gitlab/gitlab-ce
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>准备 docker-compose.yml 文件</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'3.1'</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">gitlab</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">'gitlab/gitlab-ce:latest'</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> gitlab
    <span class="token key atrule">restart</span><span class="token punctuation">:</span> always
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">GITLAB_OMNIBUS_CONFIG</span><span class="token punctuation">:</span> <span class="token punctuation">|</span><span class="token scalar string">
        external_url 'http://192.168.11.11:8929'
        gitlab_rails['gitlab_shell_ssh_port'] = 2224</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'8929:8929'</span>
      <span class="token punctuation">-</span> <span class="token string">'2224:2224'</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">'./config:/etc/gitlab'</span>
      <span class="token punctuation">-</span> <span class="token string">'./logs:/var/log/gitlab'</span>
      <span class="token punctuation">-</span> <span class="token string">'./data:/var/opt/gitlab'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>启动容器（需要稍等一小会）</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker-compose</span> up <span class="token parameter variable">-d</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>访问 GitLab 首页，端口是 8929</p></li> <li><p>查看 root 用户初始密码</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> gitlab <span class="token function">cat</span> /etc/gitlab/initial_root_password
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>登录 root 用户</p></li> <li><p>第一次登录后需要修改密码</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709224325.png" alt="image-20211124193444561"></p></li></ul> <p>搞定后，即可像 Gitee、GitHub 一样使用。</p> <h2 id="build-阶段工具"><a href="#build-阶段工具" class="header-anchor">#</a> Build 阶段工具</h2> <p>构建 Java 项目的工具一般有两种选择，一个是 Maven，一个是 Gradle。</p> <p>这里我们选择 Maven 作为项目的编译工具。</p> <p>具体安装 Maven 流程不做阐述，但是需要确保配置好 Maven 仓库私服以及 JDK 编译版本。</p> <h2 id="operate-阶段工具"><a href="#operate-阶段工具" class="header-anchor">#</a> Operate 阶段工具</h2> <p>部署过程，会采用 Docker 进行部署，暂时只安装 Docker 即可，后续还需安装 Kubenetes</p> <h3 id="docker-安装"><a href="#docker-安装" class="header-anchor">#</a> Docker 安装</h3> <ul><li><p>准备测试环境&amp;生产环境</p></li> <li><p>下载Docker依赖组件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> yum-utils device-mapper-persistent-data lvm2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>设置下载Docker的镜像源为阿里云</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>安装Docker服务</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> docker-ce
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>安装成功后，启动Docker并设置开机自启</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 启动Docker服务</span>
systemctl start <span class="token function">docker</span>
<span class="token comment"># 设置开机自动启动</span>
systemctl <span class="token builtin class-name">enable</span> <span class="token function">docker</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>测试安装成功</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h3 id="docker-compose-安装"><a href="#docker-compose-安装" class="header-anchor">#</a> Docker-Compose 安装</h3> <ul><li><p>下载 Docker/Compose：<code>https://github.com/docker/compose</code></p></li> <li><p>将下载好的 <code>docker-compose-Linux-x86_64]</code>文件移动到 Linux 操作系统</p></li> <li><p>设置 <code>docker-compose-Linux-x86_64</code> 文件权限，并移动到 <code>$PATH</code> 目录中</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 设置文件权限</span>
<span class="token function">chmod</span> a+x docker-compose-Linux-x86_64
<span class="token comment"># 移动到 /usr/bin 目录下，并重命名为 docker-compose</span>
<span class="token function">mv</span> docker-compose-Linux-x86_64 /usr/bin/docker-compose
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li> <li><p>测试安装成功</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker-compose</span> version
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h2 id="integrate-工具"><a href="#integrate-工具" class="header-anchor">#</a> Integrate 工具</h2> <p>持续集成、持续部署的工具很多，其中 Jenkins 是一个开源的持续集成平台。</p> <p>Jenkins 涉及到将编写完毕的代码发布到测试环境和生产环境的任务，并且还涉及到了构建项目等任务。</p> <p>Jenkins 需要大量的插件保证工作，安装成本较高，下面会基于 Docker 搭建 Jenkins。</p> <h3 id="jenkins-介绍"><a href="#jenkins-介绍" class="header-anchor">#</a> Jenkins 介绍</h3> <p>Jenkins 是一个开源软件项目，是基于 Java 开发的一种持续集成工具</p> <p>Jenkins 应用广泛，大多数互联网公司都采用 Jenkins 配合 GitLab、Docker、K8s 作为实现 <code>DevOps</code>的核心工具。</p> <p>Jenkins 最强大的就在于插件，Jenkins 官方提供了大量的插件库，来自动化 CI/CD 过程中的各种琐碎功能。</p> <p>Jenkins 最主要的工作就是将 GitLab 上可以构建的工程代码拉取并且进行构建，再根据流程可以选择发布到测试环境或是生产环境。</p> <p>一般是 GitLab 上的代码经过大量的测试后，确定发行版本，再发布到生产环境。</p> <p>CI/CD 可以理解为：</p> <ul><li>CI 过程即是通过 Jenkins 将代码拉取、构建、制作镜像交给测试人员测试
<ul><li>持续集成：让软件代码可以持续的集成到主干上，并自动构建和测试</li></ul></li> <li>CD 过程即是通过 Jenkins 将打好标签的发行版本代码拉取、构建、制作镜像交给运维人员部署
<ul><li>持续交付：让经过持续集成的代码可以进行手动部署</li> <li>持续部署：让可以持续交付的代码随时随地的自动化部署</li></ul></li></ul> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709224550.png" alt="image-20211125154112097"></p> <h3 id="jenkins-安装"><a href="#jenkins-安装" class="header-anchor">#</a> Jenkins 安装</h3> <ul><li><p>拉取 Jenkins 镜像</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker pull jenkins/jenkins
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>编写 docker-compose.yml</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.1&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">jenkins</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> jenkins/jenkins
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> jenkins
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8080<span class="token punctuation">:</span><span class="token number">8080</span>
      <span class="token punctuation">-</span> 50000<span class="token punctuation">:</span><span class="token number">50000</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./data/<span class="token punctuation">:</span>/var/jenkins_home/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>首次启动会因为数据卷 data 目录没有权限导致启动失败，设置 data 目录写权限</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709224635.png" alt="image-20211124202610243"></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">chmod</span> <span class="token parameter variable">-R</span> a+w data/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>重新启动 Jenkins 容器后，由于 Jenkins 需要下载大量内容，但是由于默认下载地址下载速度较慢，需要重新设置下载地址为国内镜像站</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 修改数据卷中的hudson.model.UpdateCenter.xml文件</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">'1.1'</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">'UTF-8'</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>sites<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>site<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id<span class="token operator">&gt;</span>default<span class="token operator">&lt;</span>/id<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>url<span class="token operator">&gt;</span>https://updates.jenkins.io/update-center.json<span class="token operator">&lt;</span>/url<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/site<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/sites<span class="token operator">&gt;</span>
<span class="token comment"># 将下载地址替换为http://mirror.esuni.jp/jenkins/updates/update-center.json</span>
<span class="token operator">&lt;</span>?xml <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token string">'1.1'</span> <span class="token assign-left variable">encoding</span><span class="token operator">=</span><span class="token string">'UTF-8'</span>?<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>sites<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>site<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>id<span class="token operator">&gt;</span>default<span class="token operator">&lt;</span>/id<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>url<span class="token operator">&gt;</span>http://mirror.esuni.jp/jenkins/updates/update-center.json<span class="token operator">&lt;</span>/url<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/site<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/sites<span class="token operator">&gt;</span>
<span class="token comment"># 清华大学的插件源也可以https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>再次重启 Jenkins 容器，访问 Jenkins（需要稍微等会）</p></li> <li><p>查看密码登录 Jenkins，并登录下载插件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> jenkins <span class="token function">cat</span> /var/jenkins_home/secrets/initialAdminPassword
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>选择需要安装的插件（搜索 Git 和 public）</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709224854.png" alt="image-20211124205854418"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709224901.png" alt="image-20211124205858730"></p></li> <li><p>下载完毕设置信息进入首页（可能会出现下载失败的插件）</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709224930.png" alt="image-20211124211635550"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709224943.png" alt="image-20211124211700999"></p></li></ul> <h3 id="jenkins-入门配置"><a href="#jenkins-入门配置" class="header-anchor">#</a> Jenkins 入门配置</h3> <p>由于 Jenkins 需要从 Git 拉取代码、需要本地构建、甚至需要直接发布自定义镜像到 Docker 仓库，所以 Jenkins 需要配置大量内容。</p> <h4 id="构建任务"><a href="#构建任务" class="header-anchor">#</a> 构建任务</h4> <p>准备好 GitLab 仓库中的项目，并且通过 Jenkins 配置项目的实现当前项目的 <code>DevOps</code> 基本流程。</p> <ul><li><p>构建 Maven 工程发布到 GitLab（Gitee、Github 均可）</p></li> <li><p>Jenkins 点击左侧导航新建任务</p></li> <li><p>选择自由风格构建任务</p></li></ul> <h4 id="配置源码拉取地址"><a href="#配置源码拉取地址" class="header-anchor">#</a> 配置源码拉取地址</h4> <p>Jenkins 需要将 Git 上存放的源码存储到 Jenkins 服务所在磁盘的本地</p> <ul><li><p>配置任务源码拉取的地址</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225043.png" alt="image-20211125170418337"></p></li> <li><p>Jenkins 点击任务test中的立即构建</p></li> <li><p>查看构建工程的日志，点击下面的任务条即可</p> <p>可以看到源码已经拉取带 Jenkins 本地，可以根据第三行日志信息，查看 Jenkins 本地拉取到的源码。</p></li> <li><p>查看 Jenkins 容器中 <code>/var/jenkins_home/workspace/test</code> 的源码</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225215.png" alt="image-20211125201919108"></p></li></ul> <h4 id="配置-maven-构建代码"><a href="#配置-maven-构建代码" class="header-anchor">#</a> 配置 Maven 构建代码</h4> <p>代码拉取到 Jenkins 本地后，需要在 Jenkins 中对代码进行构建，这里需要 Maven 的环境，而 Maven 需要 Java 的环境，接下来需要在 Jenkins 中安装 JDK 和 Maven，并且配置到 Jenkins 服务。</p> <ul><li><p>准备 JDK、Maven 压缩包通过数据卷映射到 Jenkins 容器内部</p></li> <li><p>解压压缩包，并配置Maven的settings.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- 阿里云镜像地址 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirror</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>alimaven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>aliyun maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>  
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url</span><span class="token punctuation">&gt;</span></span>http://maven.aliyun.com/nexus/content/groups/public/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>central<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirrorOf</span><span class="token punctuation">&gt;</span></span>          
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mirror</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- JDK1.8编译插件 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>jdk-1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activation</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jdk</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jdk</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activation</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.target</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maven.compiler.compilerVersion</span><span class="token punctuation">&gt;</span></span>1.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maven.compiler.compilerVersion</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>        
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div></li> <li><p>Jenkins 配置 JDK &amp; Maven 并保存</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225407.png" alt="image-20211125205027013"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225415.png" alt="image-20211125205020738"></p></li> <li><p>配置 Jenkins 任务构建代码</p></li> <li><p>立即构建测试，查看target下的jar包</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225436.png" alt="image-20211125205725948"></p></li></ul> <h4 id="配置-publish-发布-远程操作"><a href="#配置-publish-发布-远程操作" class="header-anchor">#</a> 配置 Publish 发布 &amp; 远程操作</h4> <p>jar 包构建好之后，就可以根据情况发布到测试或生产环境，这里需要用到之前下载好的插件 Publish Over SSH。</p> <ul><li><p>配置 Publish Over SSH 连接测试、生产环境</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225513.png" alt="image-20211125210148202"></p></li> <li><p>配置任务的构建后操作，发布 jar 包到目标服务</p> <table><thead><tr><th style="text-align:center;">配置构建后操作</th></tr></thead> <tbody><tr><td style="text-align:center;"><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225545.png" alt="image-20211125205027013"></td></tr> <tr><td style="text-align:center;"><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225556.png" alt="image-20211125210424346"></td></tr> <tr><td style="text-align:center;"><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225601.png" alt="image-20211125210626631"></td></tr></tbody></table></li> <li><p>立即构建任务，并去目标服务查看</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225619.png" alt="image-20211125210755556"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709225626.png" alt="image-20211125210826057"></p></li></ul> <h2 id="ci、cd-入门操作"><a href="#ci、cd-入门操作" class="header-anchor">#</a> CI、CD 入门操作</h2> <p>基于 Jenkins 拉取 GitLab 的 SpringBoot 代码进行构建发布到测试环境实现持续集成</p> <p>基于 Jenkins 拉取 GitLab 指定发行版本的 SpringBoot 代码进行构建发布到生产环境实现CD实现持续部署</p> <h3 id="持续集成"><a href="#持续集成" class="header-anchor">#</a> 持续集成</h3> <p>为了让程序代码可以自动推送到测试环境基于 Docker 服务运行，需要添加 Docker 配置和脚本文件让程序可以在集成到主干的同时运行起来。</p> <ul><li><p>添加 Dockerfile 文件</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Spring%20Boot/20230709233449.png" alt="image-20211126161304485"></p></li> <li><p>添加 docker-compose.yml 文件</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233554.png" alt="image-20211126161331991"></p></li> <li><p>追加 Jenkins 构建后操作脚本命令</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233623.png" alt="image-20211126161408514"></p></li> <li><p>发布到 GitLab 后由 Jenkins 立即构建并托送到目标服务器</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233631.png" alt="image-20211126161448527"></p></li> <li><p>测试部署到目标服务器程序</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233633.png" alt="image-20211126161504715"></p></li></ul> <h3 id="持续交付、部署"><a href="#持续交付、部署" class="header-anchor">#</a> 持续交付、部署</h3> <p>程序代码在经过多次集成操作到达最终可以交付，持续交付整体流程和持续集成类似，不过需要选取指定的发行版本</p> <ul><li><p>下载 Git Parameter 插件</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233635.png" alt="image-20211126165209057"></p></li> <li><p>设置项目参数化构建</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233638.png" alt="image-20211126165444124"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233639.png" alt="image-20211126172828266"></p></li> <li><p>给项目添加 tag 版本</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234306.png" alt="image-20211126165639286"></p></li> <li><p>任务构建时，采用 Shell 方式构建，拉取指定 tag 版本代码</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233641.png" alt="image-20211126174715028"></p></li> <li><p>基于 Parameter 构建任务，任务发布到目标服务器</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233647.png" alt="image-20211126174159487"></p></li></ul> <h2 id="集成-sonar-qube"><a href="#集成-sonar-qube" class="header-anchor">#</a> 集成 Sonar Qube</h2> <h3 id="sonar-qube-介绍"><a href="#sonar-qube-介绍" class="header-anchor">#</a> Sonar Qube 介绍</h3> <p>Sonar Qube 是一个开源的代码分析平台，支持 Java、Python、PHP、JavaScript、CSS 等 25 种以上的语言，可以检测出重复代码、代码漏洞、代码规范和安全性漏洞的问题。</p> <p>Sonar Qube 可以与多种软件整合进行代码扫描，比如 Maven，Gradle，Git，Jenkins 等，并且会将代码检测结果推送回 Sonar Qube 并且在系统提供的 UI 界面上显示出来</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233649.png" alt="image-20211129190039986"></p> <h3 id="sonar-qube-环境搭建"><a href="#sonar-qube-环境搭建" class="header-anchor">#</a> Sonar Qube 环境搭建</h3> <h4 id="sonar-qube-安装"><a href="#sonar-qube-安装" class="header-anchor">#</a> Sonar Qube 安装</h4> <p>Sonar Qube 在 7.9 版本中已经放弃了对 MySQL 的支持，并且建议在商业环境中采用 PostgreSQL，那么安装 Sonar Qube 时需要依赖 PostgreSQL。</p> <p>并且这里会安装 Sonar Qube 的长期支持版本 8.9</p> <ul><li><p>拉取镜像</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> pull postgres
<span class="token function">docker</span> pull sonarqube:8.9.3-community
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>编写 docker-compoe.yml</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.1&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">db</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> postgres
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> db
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 5432<span class="token punctuation">:</span><span class="token number">5432</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> sonarnet
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">POSTGRES_USER</span><span class="token punctuation">:</span> sonar
      <span class="token key atrule">POSTGRES_PASSWORD</span><span class="token punctuation">:</span> sonar
  <span class="token key atrule">sonarqube</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> sonarqube<span class="token punctuation">:</span>8.9.3<span class="token punctuation">-</span>community
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> sonarqube
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> db
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;9000:9000&quot;</span>
    <span class="token key atrule">networks</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> sonarnet
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">SONAR_JDBC_URL</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>postgresql<span class="token punctuation">:</span>//db<span class="token punctuation">:</span>5432/sonar
      <span class="token key atrule">SONAR_JDBC_USERNAME</span><span class="token punctuation">:</span> sonar
      <span class="token key atrule">SONAR_JDBC_PASSWORD</span><span class="token punctuation">:</span> sonar
<span class="token key atrule">networks</span><span class="token punctuation">:</span>
  <span class="token key atrule">sonarnet</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver</span><span class="token punctuation">:</span> bridge
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div></li> <li><p>启动容器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker-compose up -d
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>需要设置 sysctl.conf 文件信息，设置 vm.max_map_count：</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233713.png" alt="image-20211207145215817"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233715.png" alt="image-20211207145342350"></p> <p>并执行命令刷新</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sysctl -p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>重新启动需要一定时间启动，可以可以查看容器日志，看到如下内容代表启动成功</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233717.png" alt="image-20211129191426344"></p></li> <li><p>访问 Sonar Qube 首页</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233718.png" alt="image-20211129191537050"></p></li> <li><p>还需要重新设置一次密码</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233720.png" alt="image-20211129193824428"></p></li> <li><p>Sonar Qube 首页</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233722.png" alt="image-20211129194148239"></p></li></ul> <h4 id="安装中文插件"><a href="#安装中文插件" class="header-anchor">#</a> 安装中文插件</h4> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233729.png" alt="image-20211129194621820"></p> <p>安装成功后需要重启，安装失败重新点击 install 重装即可。</p> <p>安装成功后，会查看到重启按钮，点击即可</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233730.png" alt="image-20211129194748765">重启后查看效果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233734.png" alt="image-20211129194931944"></p> <h3 id="sonar-qube-基本使用"><a href="#sonar-qube-基本使用" class="header-anchor">#</a> Sonar Qube 基本使用</h3> <p>Sonar Qube 的使用方式很多，Maven 可以整合，也可以采用 sonar-scanner 的方式，再查看 Sonar Qube 的检测效果</p> <h4 id="maven-实现代码检测"><a href="#maven-实现代码检测" class="header-anchor">#</a> Maven 实现代码检测</h4> <ul><li><p>修改 Maven 的 settings.xml 文件配置 Sonar Qube 信息</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>sonar<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activation</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activation</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sonar.login</span><span class="token punctuation">&gt;</span></span>admin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sonar.login</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sonar.password</span><span class="token punctuation">&gt;</span></span>123456789<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sonar.password</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sonar.host.url</span><span class="token punctuation">&gt;</span></span>http://192.168.11.11:9000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sonar.host.url</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>在代码位置执行命令：mvn sonar:sonar</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233738.png" alt="image-20211129195430146"></p></li> <li><p>查看 Sonar Qube 界面检测结果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233741.png" alt="image-20211129195503762"></p></li></ul> <h4 id="sonar-scanner-实现代码检测"><a href="#sonar-scanner-实现代码检测" class="header-anchor">#</a> Sonar-scanner 实现代码检测</h4> <ul><li><p>下载 Sonar-scanner：https://binaries.sonarsource.com/Distribution/sonar-scanner-cli/</p> <p>下载 4.6.x 版本即可，要求 Linux 版本</p></li> <li><p>解压并配置 sonar 服务端信息</p> <ul><li><p>由于是 zip 压缩包，需要安装 unzip 解压插件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>yum <span class="token parameter variable">-y</span> <span class="token function">install</span> <span class="token function">unzip</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>解压压缩包</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">unzip</span> sonar-scanner-cli/sonar-scanner-cli-4.6.0.2311-linux.zip
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>配置 sonarQube 服务端地址，修改 conf 下的 sonar-scanner.properties</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233820.png" alt="image-20211130140043382"></p></li></ul></li> <li><p>执行命令检测代码</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 在项目所在目录执行以下命令</span>
~/sonar-scanner/bin/sonar-scanner <span class="token parameter variable">-Dsonar.sources</span><span class="token operator">=</span>./ <span class="token parameter variable">-Dsonar.projectname</span><span class="token operator">=</span>demo <span class="token parameter variable">-Dsonar.projectKey</span><span class="token operator">=</span>java <span class="token parameter variable">-Dsonar.java.binaries</span><span class="token operator">=</span>target/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Ps：主要查看我的 sonar-scanner 执行命令的位置</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233824.png" alt="image-20211130141303457"></p></li> <li><p>查看SonarQube界面检测结果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233827.png" alt="image-20211130144608025"></p></li></ul> <h3 id="jenkins-集成-sonar-qube"><a href="#jenkins-集成-sonar-qube" class="header-anchor">#</a> Jenkins 集成 Sonar Qube</h3> <p>Jenkins 继承 Sonar Qube 实现代码扫描需要先下载整合插件</p> <h4 id="jenkins-安装插件"><a href="#jenkins-安装插件" class="header-anchor">#</a> Jenkins 安装插件</h4> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233829.png" alt="image-20211129201625561"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233831.png" alt="image-20211129201607240"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234313.png" alt="image-20211129202147390"></p> <h4 id="jenkins-配置-sonar-qube"><a href="#jenkins-配置-sonar-qube" class="header-anchor">#</a> Jenkins 配置 Sonar Qube</h4> <ul><li><p>开启 Sonar Qube 权限验证</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233837.png" alt="image-20211130144850186"></p></li> <li><p>获取 Sonar Qube 的令牌</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233839.png" alt="image-20211129203102334"></p></li> <li><p>配置 Jenkins 的 Sonar Qube 信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233843.png" alt="image-20211129203235019"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233844.png" alt="image-20211129203342171"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233846.png" alt="image-20211129203457604"></p></li></ul> <h4 id="配置-sonar-scanner"><a href="#配置-sonar-scanner" class="header-anchor">#</a> 配置 Sonar-scanner</h4> <ul><li><p>将 Sonar-scaner 添加到 Jenkins 数据卷中并配置全局配置</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233847.png" alt="image-20211130153628925"></p></li> <li><p>配置任务的Sonar-scanner</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233852.png" alt="image-20211130155849143"></p></li></ul> <h4 id="构建任务-2"><a href="#构建任务-2" class="header-anchor">#</a> 构建任务</h4> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233854.png" alt="image-20211130160017465"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233855.png" alt="image-20211130160047648"></p> <h2 id="集成-harbor"><a href="#集成-harbor" class="header-anchor">#</a> 集成 Harbor</h2> <h3 id="harbor-介绍"><a href="#harbor-介绍" class="header-anchor">#</a> Harbor 介绍</h3> <p>前面在部署项目时，我们主要采用 Jenkins 推送 jar 包到指定服务器，再通过脚本命令让目标服务器对当前 jar 进行部署，这种方式在项目较多时，每个目标服务器都需要将 jar 包制作成自定义镜像再通过 docker 进行启动，重复操作比较多，会降低项目部署时间。</p> <p>我们可以通过 Harbor 作为私有的 Docker 镜像仓库。让 Jenkins 统一将项目打包并制作成 Docker 镜像发布到 Harbor 仓库中，只需要通知目标服务，让目标服务统一去 Harbor 仓库上拉取镜像并在本地部署即可。</p> <p>Docker 官方提供了 Registry 镜像仓库，但是 Registry 的功能相对简陋。Harbor 是 VMware 公司提供的一款镜像仓库，提供了权限控制、分布式发布、强大的安全扫描与审查机制等功能</p> <h3 id="harbor-安装"><a href="#harbor-安装" class="header-anchor">#</a> Harbor 安装</h3> <p>这里采用原生的方式安装 Harbor。</p> <ul><li><p>下载 Harbor 安装包：<code>https://github.com/goharbor/harbor/releases/download/v2.3.4/harbor-offline-installer-v2.3.4.tgz</code></p></li> <li><p>拖拽到 Linux 并解压：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tar -zxvf harbor-offline-installer-v2.3.4.tgz -C /usr/local/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>修改 Harbor 配置文件：</p> <ul><li><p>首先复制一份 harbor.yml 配置</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">cp</span> harbor.yml.tmpl harbor.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>编辑 harbor.yml 配置文件</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233859.png" alt="image-20211130215555218"></p></li></ul></li> <li><p>启动 Harbor</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./install.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233900.png" alt="image-20211130215941857"></p></li> <li><p>登录 Harbor</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233903.png" alt="image-20211130220028840"></p></li> <li><p>首页信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233904.png" alt="image-20211130220111602"></p></li></ul> <h3 id="harbor-使用方式"><a href="#harbor-使用方式" class="header-anchor">#</a> Harbor 使用方式</h3> <p>Harbor 作为镜像仓库，主要的交互方式就是将镜像上传到 Harbor 上，以及从 Harbor 上下载指定镜像</p> <p>在传输镜像前，可以先使用 Harbor 提供的权限管理，将项目设置为私有项目，并对不同用户设置不同角色，从而更方便管理镜像。</p> <h4 id="添加用户构建项目"><a href="#添加用户构建项目" class="header-anchor">#</a> 添加用户构建项目</h4> <ul><li><p>创建用户</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233906.png" alt="image-20211201213427157"></p></li> <li><p>构建项目（设置为私有）</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233908.png" alt="image-20211201213751780"></p></li> <li><p>给项目追加用户</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233909.png" alt="image-20211201213832458"></p></li> <li><p>切换测试用户</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233910.png" alt="image-20211201214008303"></p></li></ul> <h4 id="发布镜像到-harbor"><a href="#发布镜像到-harbor" class="header-anchor">#</a> 发布镜像到 Harbor</h4> <ul><li><p>修改镜像名称</p> <p>名称要求：harbor 地址/项目名/镜像名:版本</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233912.png" alt="image-20211201221040200"></p></li> <li><p>修改daemon.json，支持Docker仓库，并重启Docker</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233913.png" alt="image-20211201215931237"></p></li> <li><p>设置登录仓库信息</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> login <span class="token parameter variable">-u</span> 用户名 <span class="token parameter variable">-p</span> 密码 Harbor地址
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>推送镜像到 Harbor</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233914.png" alt="image-20211201221225196"></p></li></ul> <h4 id="从-harbor-拉取镜像"><a href="#从-harbor-拉取镜像" class="header-anchor">#</a> 从 Harbor 拉取镜像</h4> <p>跟传统方式一样，不过需要先配置 <code>/etc/docker/daemon.json</code> 文件</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;registry-mirrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;https://pee6w651.mirror.aliyuncs.com&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;insecure-registries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;192.168.11.11:80&quot;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233916.png" alt="image-20211201222450091"></p> <h4 id="jenkins-容器使用宿主机-docker"><a href="#jenkins-容器使用宿主机-docker" class="header-anchor">#</a> Jenkins 容器使用宿主机 Docker</h4> <p>构建镜像和发布镜像到 Harbor 都需要使用到 Docker 命令。而在 Jenkins 容器内部安装 Docker 官方推荐直接采用宿主机带的 Docker 即可。</p> <p>设置 Jenkins 容器使用宿主机 Docker</p> <ul><li><p>设置宿主机 docker.sock 权限：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sudo</span> <span class="token function">chown</span> root:root /var/run/docker.sock
<span class="token function">sudo</span> <span class="token function">chmod</span> o+rw /var/run/docker.sock
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>添加数据卷</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.1&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">jenkins</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> jenkins/jenkins
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> jenkins
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> 8080<span class="token punctuation">:</span><span class="token number">8080</span>
      <span class="token punctuation">-</span> 50000<span class="token punctuation">:</span><span class="token number">50000</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> ./data/<span class="token punctuation">:</span>/var/jenkins_home/
      <span class="token punctuation">-</span> /usr/bin/docker<span class="token punctuation">:</span>/usr/bin/docker
      <span class="token punctuation">-</span> /var/run/docker.sock<span class="token punctuation">:</span>/var/run/docker.sock
      <span class="token punctuation">-</span> /etc/docker/daemon.json<span class="token punctuation">:</span>/etc/docker/daemon.json
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li></ul> <h5 id="添加构建操作"><a href="#添加构建操作" class="header-anchor">#</a> 添加构建操作</h5> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233918.png" alt="image-20211229155834500"></p> <h4 id="编写部署脚本"><a href="#编写部署脚本" class="header-anchor">#</a> 编写部署脚本</h4> <p>部署项目需要通过 Publish Over SSH 插件，让目标服务器执行命令。为了方便一次性实现拉取镜像和启动的命令，推荐采用脚本文件的方式。</p> <p>添加脚本文件到目标服务器，再通过 Publish Over SSH 插件让目标服务器执行脚本即可。</p> <ul><li><p>编写脚本文件，添加到目标服务器</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">harbor_url</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable">harbor_project_name</span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token assign-left variable">project_name</span><span class="token operator">=</span><span class="token variable">$3</span>
<span class="token assign-left variable">tag</span><span class="token operator">=</span><span class="token variable">$4</span>
<span class="token assign-left variable">port</span><span class="token operator">=</span><span class="token variable">$5</span>

<span class="token assign-left variable">imageName</span><span class="token operator">=</span><span class="token variable">$harbor_url</span>/<span class="token variable">$harbor_project_name</span>/<span class="token variable">$project_name</span><span class="token builtin class-name">:</span><span class="token variable">$tag</span>

<span class="token assign-left variable">containerId</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">docker</span> <span class="token function">ps</span> <span class="token parameter variable">-a</span> <span class="token operator">|</span> <span class="token function">grep</span> $<span class="token punctuation">{</span>project_name<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $1}'</span><span class="token variable">`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$containerId</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">docker</span> stop <span class="token variable">$containerId</span>
    <span class="token function">docker</span> <span class="token function">rm</span> <span class="token variable">$containerId</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Delete Container Success&quot;</span>
<span class="token keyword">fi</span>

<span class="token assign-left variable">imageId</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">docker</span> images <span class="token operator">|</span> <span class="token function">grep</span> $<span class="token punctuation">{</span>project_name<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'{print $3}'</span><span class="token variable">`</span></span>

<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$imageId</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token function">docker</span> rmi <span class="token parameter variable">-f</span> <span class="token variable">$imageId</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;Delete Image Success&quot;</span>
<span class="token keyword">fi</span>

<span class="token function">docker</span> login <span class="token parameter variable">-u</span> DevOps <span class="token parameter variable">-p</span> P@ssw0rd <span class="token variable">$harbor_url</span>

<span class="token function">docker</span> pull <span class="token variable">$imageName</span>

<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-p</span> <span class="token variable">$port</span><span class="token builtin class-name">:</span><span class="token variable">$port</span> <span class="token parameter variable">--name</span> <span class="token variable">$project_name</span> <span class="token variable">$imageName</span>

<span class="token builtin class-name">echo</span> <span class="token string">&quot;Start Container Success&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$project_name</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>并设置权限为可执行</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">chmod</span> a+x deploy.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234322.png" alt="image-20211203192047357"></p></li></ul> <h4 id="配置构建后操作"><a href="#配置构建后操作" class="header-anchor">#</a> 配置构建后操作</h4> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/Jenkins/20230709233922.png" alt="image-20211229155949038"></p> <h2 id="jenkins-流水线"><a href="#jenkins-流水线" class="header-anchor">#</a> Jenkins 流水线</h2> <h3 id="jenkins-流水线任务介绍"><a href="#jenkins-流水线任务介绍" class="header-anchor">#</a> Jenkins 流水线任务介绍</h3> <p>之前采用 Jenkins 的自由风格构建的项目，每个步骤流程都要通过不同的方式设置，并且构建过程中整体流程是不可见的，无法确认每个流程花费的时间，并且问题不方便定位问题。</p> <p>Jenkins 的 Pipeline 可以让项目的发布整体流程可视化，明确执行的阶段，可以快速的定位问题。并且整个项目的生命周期可以通过一个 Jenkinsfile 文件管理，而且 Jenkinsfile 文件是可以放在项目中维护。</p> <p>所以 Pipeline 相对自由风格或者其他的项目风格更容易操作。</p> <h3 id="jenkins-流水线任务"><a href="#jenkins-流水线任务" class="header-anchor">#</a> Jenkins 流水线任务</h3> <h4 id="构建-jenkins-流水线任务"><a href="#构建-jenkins-流水线任务" class="header-anchor">#</a> 构建 Jenkins 流水线任务</h4> <ul><li><p>构建任务</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234045.png" alt="image-20211202144429302"></p></li> <li><p>生成 Groovy 的 Hello World 脚本生成</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234046.png" alt="image-20211202144531749"></p></li> <li><p>构建后查看视图</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234047.png" alt="image-20211202144616117"></p></li></ul> <h4 id="groovy-脚本"><a href="#groovy-脚本" class="header-anchor">#</a> Groovy 脚本</h4> <ul><li><p>Groovy 脚本基础语法</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code><span class="token comment">// 所有脚本命令包含在pipeline{}中</span>
pipeline <span class="token punctuation">{</span>  
	<span class="token comment">// 指定任务在哪个节点执行（Jenkins支持分布式）</span>
    agent any
    
    <span class="token comment">// 配置全局环境，指定变量名=变量值信息</span>
    environment<span class="token punctuation">{</span>
    	host <span class="token operator">=</span> <span class="token string">'192.168.11.11'</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 存放所有任务的合集</span>
    stages <span class="token punctuation">{</span>
    	<span class="token comment">// 单个任务</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'任务1'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        	<span class="token comment">// 实现任务的具体流程</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'do something'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
		<span class="token comment">// 单个任务</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'任务2'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        	<span class="token comment">// 实现任务的具体流程</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'do something'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// ……</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div></li> <li><p>编写例子测试</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any

    <span class="token comment">// 存放所有任务的合集</span>
    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'拉取Git代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'拉取Git代码'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'检测代码质量'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'检测代码质量'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'构建代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'构建代码'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'制作自定义镜像并发布Harbor'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'制作自定义镜像并发布Harbor'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'基于Harbor部署工程'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                echo <span class="token string">'基于Harbor部署工程'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234049.png" alt="image-20211202145155428"></p></li> <li><p>查看效果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234051.png" alt="image-20211202145240166"></p></li></ul> <p>Ps：涉及到特定脚本，Jenkins 给予了充足的提示，可以自动生成命令</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234052.png" alt="image-20211202145349043"></p> <h4 id="jenkinsfile-实现"><a href="#jenkinsfile-实现" class="header-anchor">#</a> Jenkinsfile 实现</h4> <p>Jenkinsfile 方式需要将脚本内容编写到项目中的 Jenkinsfile 文件中，每次构建会自动拉取项目并且获取项目中 Jenkinsfile 文件对项目进行构建</p> <ul><li><p>配置 pipeline</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234053.png" alt="image-20211202151127254"></p></li> <li><p>准备 Jenkinsfile</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234055.png" alt="image-20211202151155145"></p></li> <li><p>测试效果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234056.png" alt="image-20211202151225161"></p></li></ul> <h3 id="jenkins-流水线任务实现"><a href="#jenkins-流水线任务实现" class="header-anchor">#</a> Jenkins 流水线任务实现</h3> <h4 id="参数化构建"><a href="#参数化构建" class="header-anchor">#</a> 参数化构建</h4> <p>添加参数化构建，方便选择不的项目版本</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234057.png" alt="image-20211202191944277"></p> <h4 id="拉取-git-代码"><a href="#拉取-git-代码" class="header-anchor">#</a> 拉取 Git 代码</h4> <p>通过流水线语法生成 Checkout 代码的脚本</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234058.png" alt="image-20211202192047619"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234100.png" alt="image-20211202192129895">将 <code>*/master</code> 更改为标签 <code>${tag}</code></p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    stages <span class="token punctuation">{</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'拉取Git代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">checkout</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">$</span><span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'GitSCM'</span><span class="token punctuation">,</span> branches<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> <span class="token string">'${tag}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> userRemoteConfigs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>url<span class="token punctuation">:</span> <span class="token string">'http://49.233.115.171:8929/root/test.git'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="构建代码"><a href="#构建代码" class="header-anchor">#</a> 构建代码</h4> <p>通过脚本执行 mvn 的构建命令</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any

    stages <span class="token punctuation">{</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'拉取Git代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">checkout</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">$</span><span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'GitSCM'</span><span class="token punctuation">,</span> branches<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> <span class="token string">'${tag}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> userRemoteConfigs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>url<span class="token punctuation">:</span> <span class="token string">'http://49.233.115.171:8929/root/test.git'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'构建代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/maven/bin/mvn clean package -DskipTests'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h4 id="代码质量检测"><a href="#代码质量检测" class="header-anchor">#</a> 代码质量检测</h4> <p>通过脚本执行 sonar-scanner 命令即可</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any

    stages <span class="token punctuation">{</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'拉取Git代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">checkout</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">$</span><span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'GitSCM'</span><span class="token punctuation">,</span> branches<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> <span class="token string">'${tag}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> userRemoteConfigs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>url<span class="token punctuation">:</span> <span class="token string">'http://49.233.115.171:8929/root/test.git'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'构建代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/maven/bin/mvn clean package -DskipTests'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'检测代码质量'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=31388be45653876c1f51ec02f0d478e2d9d0e1fa'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="制作自定义镜像并发布"><a href="#制作自定义镜像并发布" class="header-anchor">#</a> 制作自定义镜像并发布</h4> <ul><li><p>生成自定义镜像脚本</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    environment<span class="token punctuation">{</span>
        harborHost <span class="token operator">=</span> <span class="token string">'192.168.11.11:80'</span>
        harborRepo <span class="token operator">=</span> <span class="token string">'repository'</span>
        harborUser <span class="token operator">=</span> <span class="token string">'DevOps'</span>
        harborPasswd <span class="token operator">=</span> <span class="token string">'P@ssw0rd'</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 存放所有任务的合集</span>
    stages <span class="token punctuation">{</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'拉取Git代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">checkout</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">$</span><span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'GitSCM'</span><span class="token punctuation">,</span> branches<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> <span class="token string">'${tag}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> userRemoteConfigs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>url<span class="token punctuation">:</span> <span class="token string">'http://49.233.115.171:8929/root/test.git'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'构建代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/maven/bin/mvn clean package -DskipTests'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'检测代码质量'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=31388be45653876c1f51ec02f0d478e2d9d0e1fa'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'制作自定义镜像并发布Harbor'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'''cp ./target/*.jar ./docker/
                cd ./docker
                docker build -t ${JOB_NAME}:${tag} ./'''</span>

                sh <span class="token string">'''docker login -u ${harborUser} -p ${harborPasswd} ${harborHost}
                docker tag ${JOB_NAME}:${tag} ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}
                docker push ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}'''</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div></li> <li><p>生成 Publish Over SSH 脚本</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any
    environment<span class="token punctuation">{</span>
        harborHost <span class="token operator">=</span> <span class="token string">'192.168.11.11:80'</span>
        harborRepo <span class="token operator">=</span> <span class="token string">'repository'</span>
        harborUser <span class="token operator">=</span> <span class="token string">'DevOps'</span>
        harborPasswd <span class="token operator">=</span> <span class="token string">'P@ssw0rd'</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 存放所有任务的合集</span>
    stages <span class="token punctuation">{</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'拉取Git代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">checkout</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">$</span><span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'GitSCM'</span><span class="token punctuation">,</span> branches<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> <span class="token string">'${tag}'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> userRemoteConfigs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>url<span class="token punctuation">:</span> <span class="token string">'http://49.233.115.171:8929/root/test.git'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'构建代码'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/maven/bin/mvn clean package -DskipTests'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>docker

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'检测代码质量'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=7d66af4b39cfe4f52ac0a915d4c9d5c513207098'</span> 
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'制作自定义镜像并发布Harbor'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'''cp ./target/*.jar ./docker/
                cd ./docker
                docker build -t ${JOB_NAME}:${tag} ./'''</span>

                sh <span class="token string">'''docker login -u ${harborUser} -p ${harborPasswd} ${harborHost}
                docker tag ${JOB_NAME}:${tag} ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}
                docker push ${harborHost}/${harborRepo}/${JOB_NAME}:${tag}'''</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'目标服务器拉取镜像并运行'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">sshPublisher</span><span class="token punctuation">(</span>publishers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">sshPublisherDesc</span><span class="token punctuation">(</span>configName<span class="token punctuation">:</span> <span class="token string">'testEnvironment'</span><span class="token punctuation">,</span> transfers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">sshTransfer</span><span class="token punctuation">(</span>cleanRemote<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> excludes<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> execCommand<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;/usr/bin/deploy.sh </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">harborHost</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">harborRepo</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">JOB_NAME</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">tag</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">port</span></span><span class="token string"> &quot;</span></span><span class="token punctuation">,</span> execTimeout<span class="token punctuation">:</span> <span class="token number">120000</span><span class="token punctuation">,</span> flatten<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> makeEmptyDirs<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> noDefaultExcludes<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> patternSeparator<span class="token punctuation">:</span> <span class="token string">'[, ]+'</span><span class="token punctuation">,</span> remoteDirectory<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> remoteDirectorySDF<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> removePrefix<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> sourceFiles<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> usePromotionTimestamp<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> useWorkspaceInPromotion<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> verbose<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div></li></ul> <p>Ps：由于采用变量，记得使用双引号</p> <h3 id="jenkins-流水线整合钉钉"><a href="#jenkins-流水线整合钉钉" class="header-anchor">#</a> Jenkins 流水线整合钉钉</h3> <p>在程序部署成功后，可以通过钉钉的机器人及时向群众发送部署的最终结果通知</p> <ul><li><p>安装插件</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234103.png" alt="image-20211209151549412"></p></li> <li><p>钉钉内部创建群组并构建机器人</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234105.png" alt="image-20211209152217433"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234106.png" alt="image-20211209152252050"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234107.png" alt="image-20211209152403312"></p> <p>最终或获取到 Webhook 信息</p> <div class="language-http line-numbers-mode"><pre class="language-http"><code><span class="token header"><span class="token header-name keyword">https</span><span class="token punctuation">:</span><span class="token header-value">//oapi.dingtalk.com/robot/send?access_token=kej4ehkj34gjhg34jh5bh5jb34hj53b4</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>系统配置添加钉钉通知</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234108.png" alt="image-20211209162923440"></p></li> <li><p>任务中追加流水线配置</p> <div class="language-groovy line-numbers-mode"><pre class="language-groovy"><code>pipeline <span class="token punctuation">{</span>
    agent any

    environment <span class="token punctuation">{</span>
        sonarLogin <span class="token operator">=</span> <span class="token string">'2bab7bf7d5af25e2c2ca2f178af2c3c55c64d5d8'</span>
        harborUser <span class="token operator">=</span> <span class="token string">'admin'</span>
        harborPassword <span class="token operator">=</span> <span class="token string">'Harbor12345'</span>
        harborHost <span class="token operator">=</span> <span class="token string">'192.168.11.12:8888'</span>
        harborRepo <span class="token operator">=</span> <span class="token string">'repository'</span>
    <span class="token punctuation">}</span>

    stages <span class="token punctuation">{</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'拉取Git代码'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">checkout</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">$</span><span class="token keyword">class</span><span class="token punctuation">:</span> <span class="token string">'GitSCM'</span><span class="token punctuation">,</span> branches<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name<span class="token punctuation">:</span> <span class="token string">'$tag'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> extensions<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> userRemoteConfigs<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>url<span class="token punctuation">:</span> <span class="token string">'http://49.233.115.171:8929/root/lsx.git'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'Maven构建代码'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/maven/bin/mvn clean package -DskipTests'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'SonarQube检测代码'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.sources=./ -Dsonar.projectname=${JOB_NAME} -Dsonar.projectKey=${JOB_NAME} -Dsonar.java.binaries=target/ -Dsonar.login=${sonarLogin}'</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'制作自定义镜像'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'''cd docker
                mv ../target/*.jar ./
                docker build -t ${JOB_NAME}:$tag .
                '''</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'推送自定义镜像'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh <span class="token string">'''docker login -u ${harborUser} -p ${harborPassword} ${harborHost}
                docker tag ${JOB_NAME}:$tag ${harborHost}/${harborRepo}/${JOB_NAME}:$tag
                docker push ${harborHost}/${harborRepo}/${JOB_NAME}:$tag'''</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">stage</span><span class="token punctuation">(</span><span class="token string">'通知目标服务器'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                <span class="token function">sshPublisher</span><span class="token punctuation">(</span>publishers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">sshPublisherDesc</span><span class="token punctuation">(</span>configName<span class="token punctuation">:</span> <span class="token string">'centos-docker'</span><span class="token punctuation">,</span> transfers<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token function">sshTransfer</span><span class="token punctuation">(</span>cleanRemote<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> excludes<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> execCommand<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;/usr/bin/deploy.sh </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">harborHost</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">harborRepo</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">JOB_NAME</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">tag</span></span><span class="token string"> </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">port</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span> execTimeout<span class="token punctuation">:</span> <span class="token number">120000</span><span class="token punctuation">,</span> flatten<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> makeEmptyDirs<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> noDefaultExcludes<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> patternSeparator<span class="token punctuation">:</span> <span class="token string">'[, ]+'</span><span class="token punctuation">,</span> remoteDirectory<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> remoteDirectorySDF<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> removePrefix<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">,</span> sourceFiles<span class="token punctuation">:</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> usePromotionTimestamp<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> useWorkspaceInPromotion<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> verbose<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>  
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    post <span class="token punctuation">{</span>
        success <span class="token punctuation">{</span>
            dingtalk <span class="token punctuation">(</span>
                robot<span class="token punctuation">:</span> <span class="token string">'Jenkins-DingDing'</span><span class="token punctuation">,</span>
                type<span class="token punctuation">:</span><span class="token string">'MARKDOWN'</span><span class="token punctuation">,</span>
                title<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;success: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">JOB_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span>
                text<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">&quot;- 成功构建:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">JOB_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">项目!\n- 版本:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">tag</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n- 持续时间:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">currentBuild<span class="token punctuation">.</span>durationString</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n- 任务:#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">JOB_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        failure <span class="token punctuation">{</span>
            dingtalk <span class="token punctuation">(</span>
                robot<span class="token punctuation">:</span> <span class="token string">'Jenkins-DingDing'</span><span class="token punctuation">,</span>
                type<span class="token punctuation">:</span><span class="token string">'MARKDOWN'</span><span class="token punctuation">,</span>
                title<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;fail: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">JOB_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">,</span>
                text<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">&quot;- 失败构建:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">JOB_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">项目!\n- 版本:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">tag</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n- 持续时间:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">currentBuild<span class="token punctuation">.</span>durationString</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">\n- 任务:#</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token expression">JOB_NAME</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">]</span>
            <span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br></div></div></li> <li><p>查看效果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234110.png" alt="image-20211209163021396"></p></li></ul> <h2 id="kubernetes-编排工具"><a href="#kubernetes-编排工具" class="header-anchor">#</a> Kubernetes 编排工具</h2> <p>Kubernetes 完整的知识请看 <a href="/kubernetes/">Kubernetes - 知识体系</a>。</p> <h3 id="kubernetes-介绍"><a href="#kubernetes-介绍" class="header-anchor">#</a> Kubernetes 介绍</h3> <p>Kubernetes 是一个开源的，用于管理云平台中多个主机上的容器化的应用，Kubernetes 的目标是让部署容器化的应用简单并且高效（powerful），Kubernetes 提供了应用部署，规划，更新，维护的一种机制。</p> <p>Kubernetes 一个核心的特点就是能够自主的管理容器来保证云平台中的容器按照用户的期望状态运行着，管理员可以加载一个微型服务，让规划器来找到合适的位置，同时，Kubernetes 也系统提升工具以及人性化方面，让用户能够方便的部署自己的应用。</p> <p>Kubernetes 主要能帮助我们完成：</p> <ul><li><p>服务发现和负载均衡</p> <p>Kubernetes 可以使用 DNS 名称或自己的 IP 地址公开容器，如果进入容器的流量很大， Kubernetes 可以负载均衡并分配网络流量，从而使部署稳定。</p></li> <li><p>存储编排</p> <p>Kubernetes 允许你自动挂载你选择的存储系统，比如本地存储，类似 Docker 的数据卷。</p></li> <li><p>自动部署和回滚</p> <p>你可以使用 Kubernetes 描述已部署容器的所需状态，它可以以受控的速率将实际状态 更改为期望状态。Kubernetes 会自动帮你根据情况部署创建新容器，并删除现有容器给新容器提供资源。</p></li> <li><p>自动完成装箱计算</p> <p>Kubernetes 允许你设置每个容器的资源，比如 CPU 和内存。</p></li> <li><p>自我修复</p> <p>Kubernetes 重新启动失败的容器、替换容器、杀死不响应用户定义的容器，并运行状况检查的容器。</p></li> <li><p>秘钥与配置管理</p> <p>Kubernetes 允许你存储和管理敏感信息，例如密码、OAuth 令牌和 ssh 密钥。你可以在不重建容器镜像的情况下部署和更新密钥和应用程序配置，也无需在堆栈配置中暴露密钥。</p></li></ul> <h3 id="kubernetes-架构"><a href="#kubernetes-架构" class="header-anchor">#</a> Kubernetes 架构</h3> <p>Kubernetes 搭建需要至少两个节点，一个 Master 负责管理，一个 Slave 搭建在工作服务器上负责分配。</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234111.png" alt="image-20211210114507638"></p> <p>从图中可以看到各个组件的基本功能：</p> <ul><li>API Server：作为 K8s 通讯的核心组件，K8s 内部交互以及接收发送指令的组件。</li> <li>controller-manager：作为 K8s 的核心组件，主要做资源调度，根据集群情况分配资源</li> <li>etcd：一个 key-value 的数据库，存储存储集群的状态信息</li> <li>scheduler：负责调度每个工作节点</li> <li>cloud-controller-manager：负责调度其他云服务产品</li> <li>kubelet：管理 Pods 上面的容器。</li> <li>kube-proxy：负责处理其他 Slave 或客户端的请求</li> <li>Pod：可以理解为就是运行的容器</li></ul> <h3 id="kubernetes-安装"><a href="#kubernetes-安装" class="header-anchor">#</a> Kubernetes 安装</h3> <p>这里会采用 <code>https://kuboard.cn/</code> 提供的方式安装 K8s，安装单 Master 节点</p> <ul><li>要求使用 Centos7.8 版本：<code>https://vault.centos.org/7.8.2003/isos/x86_64/CentOS-7-x86_64-Minimal-2003.iso</code></li> <li>至少 2 台 <strong>2 核 4G</strong> 的服务器</li></ul> <p>安装流程</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234113.png" alt="image-20211210190653687"></p> <p>准备好服务器后开始安装</p> <ul><li><p>重新设置 hostname，不允许为 localhost</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 修改 hostname，名字不允许使用下划线、小数点、大写字母，不能叫master</span>
hostnamectl set-hostname your-new-host-name
<span class="token comment"># 查看修改结果</span>
hostnamectl status
<span class="token comment"># 设置 hostname 解析</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;127.0.0.1   <span class="token variable"><span class="token variable">$(</span><span class="token function">hostname</span><span class="token variable">)</span></span>&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>要求 2 台服务之间可以相互通讯</p></li> <li><p>安装软件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 阿里云 docker hub 镜像</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">REGISTRY_MIRROR</span><span class="token operator">=</span>https://registry.cn-hangzhou.aliyuncs.com
<span class="token function">curl</span> <span class="token parameter variable">-sSL</span> https://kuboard.cn/install-script/v1.19.x/install_kubelet.sh <span class="token operator">|</span> <span class="token function">sh</span> <span class="token parameter variable">-s</span> <span class="token number">1.19</span>.5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <p>首先初始化 Master 节点</p> <blockquote><p>关于初始化时用到的环境变量</p> <ul><li><strong>APISERVER_NAME</strong> 不能是 master 的 hostname</li> <li><strong>APISERVER_NAME</strong> 必须全为小写字母、数字、小数点，不能包含减号</li> <li><strong>POD_SUBNET</strong> 所使用的网段不能与 <em><strong>master 节点 / worker 节点</strong></em> 所在的网段重叠。该字段的取值为一个 <a href="https://kuboard.cn/glossary/cidr.html" target="_blank" rel="noopener noreferrer">CIDR<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 值，如果您对 CIDR 这个概念还不熟悉，请仍然执行 export POD_SUBNET=10.100.0.0/16 命令，不做修改</li></ul></blockquote> <ul><li><p>设置 ip，域名，网段并执行初始化操作</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 只在 master 节点执行</span>
<span class="token comment"># 替换 x.x.x.x 为 master 节点实际 IP（请使用内网 IP）</span>
<span class="token comment"># export 命令只在当前 shell 会话中有效，开启新的 shell 窗口后，如果要继续安装过程，请重新执行此处的 export 命令</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">MASTER_IP</span><span class="token operator">=</span><span class="token number">192.168</span>.11.32
<span class="token comment"># 替换 apiserver.demo 为 您想要的 dnsName</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">APISERVER_NAME</span><span class="token operator">=</span>apiserver.demo
<span class="token comment"># Kubernetes 容器组所在的网段，该网段安装完成后，由 kubernetes 创建，事先并不存在于您的物理网络中</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">POD_SUBNET</span><span class="token operator">=</span><span class="token number">10.100</span>.0.1/16
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${MASTER_IP}</span>    <span class="token variable">${APISERVER_NAME}</span>&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/hosts
<span class="token function">curl</span> <span class="token parameter variable">-sSL</span> https://kuboard.cn/install-script/v1.19.x/init_master.sh <span class="token operator">|</span> <span class="token function">sh</span> <span class="token parameter variable">-s</span> <span class="token number">1.19</span>.5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div></li> <li><p>检查 Master 启动状态</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 只在 master 节点执行</span>

<span class="token comment"># 执行如下命令，等待 3-10 分钟，直到所有的容器组处于 Running 状态</span>
<span class="token function">watch</span> kubectl get pod <span class="token parameter variable">-n</span> kube-system <span class="token parameter variable">-o</span> wide

<span class="token comment"># 查看 master 节点初始化结果</span>
kubectl get nodes <span class="token parameter variable">-o</span> wide
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li></ul> <p>Ps：如果出现 NotReady 的情况执行（最新版本的 BUG，1.19 一般没有）</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> pull quay.io/coreos/flannel:v0.10.0-amd64 
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/cni/net.d/
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF<span class="token operator">&gt;</span> /etc/cni/net.d/10-flannel.conf
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;cbr0&quot;</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;flannel&quot;</span>,<span class="token string">&quot;delegate&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;isDefaultGateway&quot;</span><span class="token builtin class-name">:</span> true<span class="token punctuation">}</span><span class="token punctuation">}</span>
EOF
<span class="token function">mkdir</span> /usr/share/oci-umount/oci-umount.d <span class="token parameter variable">-p</span>
<span class="token function">mkdir</span> /run/flannel/
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF<span class="token operator">&gt;</span> /run/flannel/subnet.env
<span class="token assign-left variable">FLANNEL_NETWORK</span><span class="token operator">=</span><span class="token number">172.100</span>.0.0/16
<span class="token assign-left variable">FLANNEL_SUBNET</span><span class="token operator">=</span><span class="token number">172.100</span>.1.0/24
<span class="token assign-left variable">FLANNEL_MTU</span><span class="token operator">=</span><span class="token number">1450</span>
<span class="token assign-left variable">FLANNEL_IPMASQ</span><span class="token operator">=</span>true
EOF
kubectl apply <span class="token parameter variable">-f</span> https://raw.githubusercontent.com/coreos/flannel/v0.9.1/Documentation/kube-flannel.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>安装网络服务插件</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">POD_SUBNET</span><span class="token operator">=</span><span class="token number">10.100</span>.0.0/16
kubectl apply <span class="token parameter variable">-f</span> https://kuboard.cn/install-script/v1.22.x/calico-operator.yaml
<span class="token function">wget</span> https://kuboard.cn/install-script/v1.22.x/calico-custom-resources.yaml
<span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">&quot;s#192.168.0.0/16#<span class="token variable">${POD_SUBNET}</span>#&quot;</span> calico-custom-resources.yaml
kubectl apply <span class="token parameter variable">-f</span> calico-custom-resources.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>初始化 worker 节点</p> <ul><li><p>获取 Join 命令参数，在 Master 节点执行</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 只在 master 节点执行</span>
kubeadm token create --print-join-command
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234326.png" alt="image-20211213183025291"></p></li> <li><p>在 worker 节点初始化</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 只在 worker 节点执行</span>
<span class="token comment"># 替换 x.x.x.x 为 master 节点的内网 IP</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">MASTER_IP</span><span class="token operator">=</span><span class="token number">192.168</span>.11.32
<span class="token comment"># 替换 apiserver.demo 为初始化 master 节点时所使用的 APISERVER_NAME</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">APISERVER_NAME</span><span class="token operator">=</span>apiserver.demo
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${MASTER_IP}</span>    <span class="token variable">${APISERVER_NAME}</span>&quot;</span> <span class="token operator">&gt;&gt;</span> /etc/hosts

<span class="token comment"># 替换为 master 节点上 kubeadm token create 命令的输出</span>
kubeadm <span class="token function">join</span> apiserver.demo:6443 <span class="token parameter variable">--token</span> vwfilu.3nhndohc5gn1jv9k     --discovery-token-ca-cert-hash sha256:22ff15cabfe87ab48a7db39b3bbf986fee92ec92eb8efc7fe9b0abe2175ff0c2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li></ul> <p>检查最终运行效果</p> <ul><li><p>在 master 节点上执行</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 只在 master 节点执行</span>
kubectl get nodes <span class="token parameter variable">-o</span> wide
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <p>Ps：如果出现 NotReady 的情况执行（最新版本的 BUG，1.19 一般没有）</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">docker</span> pull quay.io/coreos/flannel:v0.10.0-amd64 
<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /etc/cni/net.d/
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF<span class="token operator">&gt;</span> /etc/cni/net.d/10-flannel.conf
<span class="token punctuation">{</span><span class="token string">&quot;name&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;cbr0&quot;</span>,<span class="token string">&quot;type&quot;</span><span class="token builtin class-name">:</span><span class="token string">&quot;flannel&quot;</span>,<span class="token string">&quot;delegate&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">{</span><span class="token string">&quot;isDefaultGateway&quot;</span><span class="token builtin class-name">:</span> true<span class="token punctuation">}</span><span class="token punctuation">}</span>
EOF
<span class="token function">mkdir</span> /usr/share/oci-umount/oci-umount.d <span class="token parameter variable">-p</span>
<span class="token function">mkdir</span> /run/flannel/
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span>EOF<span class="token operator">&gt;</span> /run/flannel/subnet.env
<span class="token assign-left variable">FLANNEL_NETWORK</span><span class="token operator">=</span><span class="token number">172.100</span>.0.0/16
<span class="token assign-left variable">FLANNEL_SUBNET</span><span class="token operator">=</span><span class="token number">172.100</span>.1.0/24
<span class="token assign-left variable">FLANNEL_MTU</span><span class="token operator">=</span><span class="token number">1450</span>
<span class="token assign-left variable">FLANNEL_IPMASQ</span><span class="token operator">=</span>true
EOF
kubectl apply <span class="token parameter variable">-f</span> https://raw.githubusercontent.com/coreos/flannel/v0.9.1/Documentation/kube-flannel.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><ul><li><p>输出结果如下所示：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@k8smaster ~<span class="token punctuation">]</span><span class="token comment"># kubectl get nodes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234116.png" alt="image-20211210184851810"></p></li></ul> <p>安装 Kuboard 管理 K8s 集群</p> <ul><li><p>安装 Kuboard</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>kubectl apply <span class="token parameter variable">-f</span> https://addons.kuboard.cn/kuboard/kuboard-v3.yaml
<span class="token comment"># 您也可以使用下面的指令，唯一的区别是，该指令使用华为云的镜像仓库替代 docker hub 分发 Kuboard 所需要的镜像</span>
<span class="token comment"># kubectl apply -f https://addons.kuboard.cn/kuboard/kuboard-v3-swr.yaml</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>查看启动情况</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">watch</span> kubectl get pods <span class="token parameter variable">-n</span> kuboard
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234118.png" alt="image-20211213184701784"></p></li> <li><p>在浏览器中打开链接 http://your-node-ip-address:30080</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234119.png" alt="image-20211213184742709"></p></li> <li><p>输入初始用户名和密码，并登录</p> <ul><li><p>用户名： <code>admin</code></p></li> <li><p>密码： <code>Kuboard123</code></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234121.png" alt="image-20211213184840120"></p></li></ul></li></ul> <h3 id="kubernetes-操作"><a href="#kubernetes-操作" class="header-anchor">#</a> Kubernetes 操作</h3> <p>首先我们要了解 Kubernetes 在运行我们的资源时，关联到了哪些内容</p> <ul><li><p>资源的构建方式：</p> <ul><li>采用 kubectl 的命令方式</li> <li>yaml 文件方式</li></ul></li></ul> <h4 id="namespace"><a href="#namespace" class="header-anchor">#</a> Namespace</h4> <ul><li><p>命名空间：主要是为了对 Kubernetes 中运行的资源进行过隔离， 但是网络是互通的，类似 Docker 的容器，可以将多个资源配置到一个 NameSpace 中。而 NameSpace 可以对不同环境进行资源隔离，默认情况下 Kubernetes 提供了 default 命名空间，在构建资源时，如果不指定资源，默认采用 default 资源。</p> <p>命令方式：</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 查看现有的全部命名空间</span>
kubectl get ns

<span class="token comment"># 构建命名空间</span>
kubectl create ns 命名空间名称

<span class="token comment"># 删除现有命名空间， 并且会删除空间下的全部资源</span>
kubectl delete ns 命名空间名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>yaml文件方式：（构建资源时，设置命名空间）</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Namespace
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h4 id="pod"><a href="#pod" class="header-anchor">#</a> Pod</h4> <ul><li><p>Pod：Kubernetes 运行的一组容器，Pod 是 Kubernetes 的最小单位，但是对于 Docker 而然，Pod 中会运行多个 Docker 容器</p> <ul><li><p>命令方式：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 查看所有运行的 pod</span>
kubectl get pods <span class="token parameter variable">-A</span>

<span class="token comment"># 查看指定 Namespace 下的 Pod</span>
kubectl get pod <span class="token punctuation">[</span>-n 命名空间<span class="token punctuation">]</span>  <span class="token comment">#（默认 default）</span>

<span class="token comment"># 创建Pod</span>
kubectl run pod名称 <span class="token parameter variable">--image</span><span class="token operator">=</span>镜像名称

<span class="token comment"># 查看 Pod 详细信息</span>
kubectl describe pod pod名称

<span class="token comment"># 删除 pod</span>
kubectl delete pod pod名称 <span class="token punctuation">[</span>-n 命名空间<span class="token punctuation">]</span>  <span class="token comment">#（默认 default）</span>

<span class="token comment"># 查看 pod 输出的日志</span>
kubectl logs <span class="token parameter variable">-f</span> pod名称

<span class="token comment"># 进去 pod 容器内部</span>
kubectl <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> pod名称 -- <span class="token function">bash</span>

<span class="token comment"># 查看 kubernetes 给 Pod 分配的 ip 信息，并且通过 ip 和容器的端口，可以直接访问</span>
kubectl get pod <span class="token parameter variable">-owide</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li> <li><p>yaml 方式（推荐）</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">run</span><span class="token punctuation">:</span> 运行的pod名称
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod名称
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> 命名空间
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> 镜像名称
    <span class="token key atrule">name</span><span class="token punctuation">:</span> 容器名称

<span class="token comment"># 启动 Pod：kubectl apply -f yaml 文件名称</span>
<span class="token comment"># 删除 Pod：kubectl delete -f yaml 文件名称</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>Pod 中运行多个容器</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">run</span><span class="token punctuation">:</span> 运行的pod名称
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pod名称
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> 命名空间
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> 镜像名称
    <span class="token key atrule">name</span><span class="token punctuation">:</span> 容器名称
  <span class="token punctuation">-</span> <span class="token key atrule">image</span><span class="token punctuation">:</span> 镜像名称
    <span class="token key atrule">name</span><span class="token punctuation">:</span> 容器名称
…………    
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>启动后可以查看到</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234123.png" alt="image-20220104203155749"></p></li></ul></li></ul> <h4 id="deployment"><a href="#deployment" class="header-anchor">#</a> Deployment</h4> <p>部署时，可以通过 Deployment 管理和编排 Pod</p> <p>Deployment 部署实现</p> <ul><li><p>命令方式</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 基于 Deployment 启动容器</span>
kubectl create deployment deployment名称 <span class="token parameter variable">--image</span><span class="token operator">=</span>镜像名称
<span class="token comment"># 用 deployment 启动的容器会在被删除后自动再次创建，达到故障漂移的效果</span>
<span class="token comment"># 需要使用 deploy 的方式删除 deploy</span>
<span class="token comment"># 查看现在的 deployment</span>
kubectl get deployment

<span class="token comment"># 删除deployment</span>
kubectl delete deployment deployment名称

<span class="token comment"># 基于 Deployment 启动容器并设置 Pod 集群数</span>
kubectl create deployment deployment名称 <span class="token parameter variable">--image</span><span class="token operator">=</span>镜像名称 <span class="token parameter variable">--replicas</span> 集群个数
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li> <li><p><a href="https://kubernetes.io/zh/docs/concepts/workloads/controllers/deployment/" target="_blank" rel="noopener noreferrer">配置文件方式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
       <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
       <span class="token key atrule">ports</span><span class="token punctuation">:</span>
       <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>正常使用 kubectl 运行 yaml 即可</p></li></ul> <p>弹性伸缩功能</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 基于 scale 实现弹性伸缩</span>
kubectl scale deploy/Deployment名称 <span class="token parameter variable">--replicas</span> 集群个数
<span class="token comment"># 或者修改 yaml 文件</span>
kubectl edit deploy Deployment名称
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234124.png" alt="image-20220104210823057"></p> <p>灰度发布</p> <p>Deploy 可以在部署新版本数据时，成功启动一个 pod，才会下线一个老版本的 Pod</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>kubectl <span class="token builtin class-name">set</span> image deployment/Deployment名称 容器名<span class="token operator">=</span>镜像:版本
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="service"><a href="#service" class="header-anchor">#</a> Service</h4> <p>可以将多个Pod对外暴露一个 Service，让客户端可以通过 Service 访问到这一组 Pod，并且可以实现负载均衡</p> <p>ClusterIP 方式：</p> <p>ClusterIP 是集群内部 Pod 之间的访问方式</p> <ul><li><p>命令实现效果</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 通过生成 service 映射一个 Deployment 下的所有 pod 中的某一个端口的容器</span>
kubectl expose deployment Deployment名称 <span class="token parameter variable">--port</span><span class="token operator">=</span>Service端口号 --target-port<span class="token operator">=</span>Pod内容器端口
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>之后通过 <code>kubectl get service</code> 查看 Service 提供的 ip，即可访问</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234126.png" alt="image-20220104214659229"></p> <p>也可以通过 <code>Deployment名称.namespace名称.svc</code> 作为域名访问</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234127.png" alt="image-20220104215030265"></p></li></ul> <p>NodePort 方式</p> <p>ClusterIP 的方式只能在 Pod 内部实现访问，但是一般需要对外暴露网关，所以需要 NodePort 的方式 Pod 外暴露访问</p> <ul><li><p>命令实现方式</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 通过生成 service 映射一个 Deployment 下的所有 pod 中的某一个端口的容器</span>
kubectl expose deployment Deployment名称 <span class="token parameter variable">--port</span><span class="token operator">=</span>Service端口号 --target-port<span class="token operator">=</span>Pod内容器端口 <span class="token parameter variable">--type</span><span class="token operator">=</span>NodePort
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234129.png" alt="image-20220104222750733"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234131.png" alt="image-20220104222819455"></p></li></ul> <p>Service 也可以通过 yaml 文件实现</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  labels
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
  <span class="token key atrule">spec</span><span class="token punctuation">:</span>
    <span class="token key atrule">selector</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8888</span>
     <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
     <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>通过 apply 启动就也可以创建 Service</p> <p>测试效果 <code>-Deployment</code> 部署，通过 Service 暴露</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
        <span class="token key atrule">image</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>service
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>service
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>deployment
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8888</span>
    <span class="token key atrule">protocol</span><span class="token punctuation">:</span> TCP
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">80</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>可以查看到暴露的信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234133.png" alt="image-20220105205334996"></p> <h4 id="ingress"><a href="#ingress" class="header-anchor">#</a> Ingress</h4> <p>Kubernetes 推荐将 Ingress 作为所有 Service 的入口，提供统一的入口，避免多个服务之间需要记录大量的IP或者域名，毕竟 IP 可能改变，服务太多域名记录不方便。</p> <p>Ingress 底层其实就是一个 Nginx， 可以在 Kuboard 上直接点击安装</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234329.png" alt="image-20220105153343642"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234135.png" alt="image-20220105153416367"></p> <p>因为副本数默认为 1，但是 k8s 整体集群就 2 个节点，所以显示下面即为安装成功</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234136.png" alt="image-20220105153502619"></p> <p>可以将 Ingress 接收到的请求转发到不同的 Service 中。</p> <p>推荐使用 yaml 文件方式</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>ingress
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ingressClassName</span><span class="token punctuation">:</span> ingress
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> nginx.mashibing.com
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
        <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
        <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">service</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx<span class="token punctuation">-</span>service
            <span class="token key atrule">port</span><span class="token punctuation">:</span>
              <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">8888</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234139.png" alt="image-20220105203819715"></p> <p>Kuboard 安装的 Ingress 有 admission 的校验配置，需要先删除配置再启动</p> <p>找到指定的 ingress 的校验信息，删除即可</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234140.png" alt="image-20220105204434044"></p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># 查看校验webhook的配置</span>
kubectl get <span class="token parameter variable">-A</span> ValidatingWebhookConfiguration

<span class="token comment"># 删除指定的校验</span>
kubectl delete ValidatingWebhookConfiguration ingress-nginx-admission-my-ingress-controller
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>配置本地 hosts 文件</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234141.png" alt="image-20220105204921272"></p> <p>记下来既可以访问在 Service 中暴露的 Nginx 信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234142.png" alt="image-20220105205407393"></p> <h3 id="jenkins-集成-kubernetes"><a href="#jenkins-集成-kubernetes" class="header-anchor">#</a> Jenkins 集成 Kubernetes</h3> <h4 id="准备部署的-yml-文件"><a href="#准备部署的-yml-文件" class="header-anchor">#</a> 准备部署的 yml 文件</h4> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> test
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pipeline
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline    
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> pipeline
        <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.11.102<span class="token punctuation">:</span>80/repo/pipeline<span class="token punctuation">:</span>v4.0.0
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> Always
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> test
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pipeline  
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline
  <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8081</span>
    <span class="token key atrule">targetPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
<span class="token punctuation">---</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> networking.k8s.io/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Ingress
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> test
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pipeline
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">ingressClassName</span><span class="token punctuation">:</span> ingress
  <span class="token key atrule">rules</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">host</span><span class="token punctuation">:</span> mashibing.pipeline.com
    <span class="token key atrule">http</span><span class="token punctuation">:</span>
      <span class="token key atrule">paths</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">path</span><span class="token punctuation">:</span> /
        <span class="token key atrule">pathType</span><span class="token punctuation">:</span> Prefix
        <span class="token key atrule">backend</span><span class="token punctuation">:</span>
          <span class="token key atrule">service</span><span class="token punctuation">:</span>
            <span class="token key atrule">name</span><span class="token punctuation">:</span> pipeline
            <span class="token key atrule">port</span><span class="token punctuation">:</span>
              <span class="token key atrule">number</span><span class="token punctuation">:</span> <span class="token number">8081</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h4 id="harbor-私服配置"><a href="#harbor-私服配置" class="header-anchor">#</a> Harbor 私服配置</h4> <p>在尝试用 kubernetes 的 yml 文件启动 pipeline 服务时，会出现 Kubernetes 无法拉取镜像的问题，这里需要在 kubernetes 所在的 Linux 中配置 Harbor 服务信息，并且保证 Kubernetes 可以拉取 Harbor 上的镜像</p> <ul><li><p>设置 Master 和 Worker 的私服地址信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234144.png" alt="1642498962716"></p></li> <li><p>在Kuboard上设置私服密文信息</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234145.png" alt="1642498994935"></p> <p>按照复制指令的位置测试认证，效果如下</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234147.png" alt="1642499172789"></p></li></ul> <h4 id="测试使用效果"><a href="#测试使用效果" class="header-anchor">#</a> 测试使用效果</h4> <p>执行 kubectl 命令，基于 yml 启动服务，并且基于部署后服务的提示信息以及 Ingress 的设置，直接访问</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234148.png" alt="1642499368121"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234149.png" alt="1642499788199"></p> <h4 id="jenkins-远程调用"><a href="#jenkins-远程调用" class="header-anchor">#</a> Jenkins 远程调用</h4> <ul><li><p>将 pipeline.yml 配置到 Gitlab 中</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234150.png" alt="1642499885324"></p></li> <li><p>配置 Jenkins 的目标服务器，可以将 yml 文件传输到 K8s 的 Master 上</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234151.png" alt="1642499992148"></p></li> <li><p>修改 Jenkinsfile，重新设置流水线任务脚本，并测试效果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234152.png" alt="1642500061153"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234337.png" alt="1642500102996"></p></li> <li><p>设置 Jenkins 无密码登录 k8s-master</p> <p>将 Jenkins 中公钥信息复制到 k8s-master 的 <code>~/.ssh/authorized_keysz</code> 中，保证远程连接无密码</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234157.png" alt="1642500239406"></p></li> <li><p>设置执行 kubectl 的脚本到 Jenkinsfile</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234158.png" alt="1642500378788"></p></li> <li><p>执行查看效果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234159.png" alt="1642500413802"></p> <p>可以查看到 yml 文件是由变化的，这样 k8s 就会重新加载</p></li> <li><p>查看效果</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234200.png" alt="1642500474036"></p></li></ul> <p>Ps：这种方式更适应与CD操作，将项目将基于某个版本部署到指定的目标服务器</p> <h3 id="基于-gitlab-的-webhooks"><a href="#基于-gitlab-的-webhooks" class="header-anchor">#</a> 基于 GitLab 的 WebHooks</h3> <p>这里要实现自动化的一个 CI 操作，也就是开发人员 Push 代码到 Git 仓库后，Jenkins 会自动的构建项目，将最新的提交点代码构建并进行打包部署，这里区别去上述的 CD 操作，CD 操作需要基于某个版本进行部署，而这里每次都是将最新的提交点集成到主干上并测试。</p> <h4 id="webhooks-通知"><a href="#webhooks-通知" class="header-anchor">#</a> WebHooks 通知</h4> <p>开启 Jenkins 的自动构建</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234201.png" alt="1642500817131"></p> <p>设置 Gitlab 的 Webhooks</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234203.png" alt="1642500933316"></p> <p>需要关闭 Jenkins 的 Gitlab 认证</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234204.png" alt="1642501016474"></p> <p>再次测试 Gitlab</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234205.png" alt="1642501065243"></p> <h4 id="修改配置"><a href="#修改配置" class="header-anchor">#</a> 修改配置</h4> <p>修改 Jenkinsfile 实现基于最新提交点实现持续集成效果，将之前引用 <code>${tag}</code> 的全部去掉</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token comment">// 所有的脚本命令都放在pipeline中</span>
pipeline<span class="token punctuation">{</span>
	<span class="token comment">// 指定任务再哪个集群节点中执行</span>
	agent any

	<span class="token comment">// 声明全局变量，方便后面使用</span>
	environment <span class="token punctuation">{</span>
		harborUser = 'admin'
        harborPasswd = 'Harbor12345'
        harborAddress = '<span class="token number">192.168</span>.<span class="token number">11.102</span><span class="token operator">:</span><span class="token number">80</span>'
        harborRepo = 'repo'
	<span class="token punctuation">}</span>

    stages <span class="token punctuation">{</span>
        stage('拉取git仓库代码') <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                checkout(<span class="token punctuation">[</span>$class<span class="token operator">:</span> 'GitSCM'<span class="token punctuation">,</span> branches<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>name<span class="token operator">:</span> '*/master'<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> extensions<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> userRemoteConfigs<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">[</span>url<span class="token operator">:</span> 'http<span class="token operator">:</span><span class="token comment">//192.168.11.101:8929/root/mytest.git']]])</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        stage('通过maven构建项目') <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh '/var/jenkins_home/maven/bin/mvn clean package -DskipTests'
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        stage('通过SonarQube做代码质量检测') <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh '/var/jenkins_home/sonar-scanner/bin/sonar-scanner -Dsonar.source=./ -Dsonar.projectname=$<span class="token punctuation">{</span>JOB_NAME<span class="token punctuation">}</span> -Dsonar.projectKey=$<span class="token punctuation">{</span>JOB_NAME<span class="token punctuation">}</span> -Dsonar.java.binaries=./target/ -Dsonar.login=40306ae8ea69a4792df2ceb4d9d25fe8a6ab1701'
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        stage('通过Docker制作自定义镜像') <span class="token punctuation">{</span>
            steps <span class="token punctuation">{</span>
                sh '''mv ./target<span class="token comment">/*.jar ./docker/
                docker build -t ${JOB_NAME}:latest ./docker/'''
            }
        }
        stage('将自定义镜像推送到Harbor') {
            steps {
                sh '''docker login -u ${harborUser} -p ${harborPasswd} ${harborAddress}
                docker tag ${JOB_NAME}:latest  ${harborAddress}/${harborRepo}/${JOB_NAME}:latest
                docker push ${harborAddress}/${harborRepo}/${JOB_NAME}:latest '''
            }
        }
        stage('将yml文件传到k8s-master上') {
            steps {
                sshPublisher(publishers: [sshPublisherDesc(configName: 'k8s', transfers: [sshTransfer(cleanRemote: false, excludes: '', execCommand: '', execTimeout: 120000, flatten: false, makeEmptyDirs: false, noDefaultExcludes: false, patternSeparator: '[, ]+', remoteDirectory: '', remoteDirectorySDF: false, removePrefix: '', sourceFiles: 'pipeline.yml')], usePromotionTimestamp: false, useWorkspaceInPromotion: false, verbose: false)])
            }
        }
        stage('远程执行k8s-master的kubectl命令') {
            steps {
               sh '''ssh root@192.168.11.201 kubectl apply -f /usr/local/k8s/pipeline.yml
                ssh root@192.168.11.201 kubectl rollout restart deployment pipeline -n test'''
            }
        }

    }
    post {
        success {
            dingtalk(
                robot: 'Jenkins-DingDing',
                type: 'MARKDOWN',
                title: &quot;success: ${JOB_NAME}&quot;,
                text: [&quot;- 成功构建：${JOB_NAME}! \n- 版本：latest \n- 持续时间：${currentBuild.durationString}&quot; ]
            )
        }
        failure {
            dingtalk(
                robot: 'Jenkins-DingDing',
                type: 'MARKDOWN',
                title: &quot;success: ${JOB_NAME}&quot;,
                text: [&quot;- 构建失败：${JOB_NAME}! \n- 版本：latest \n- 持续时间：${currentBuild.durationString}&quot; ]
            )
        }
    }
}

</span></code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br></div></div><p>修改pipeline.yml，更改镜像版本</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> apps/v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Deployment
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> test
  <span class="token key atrule">name</span><span class="token punctuation">:</span> pipeline
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
  <span class="token key atrule">selector</span><span class="token punctuation">:</span>
    <span class="token key atrule">matchLabels</span><span class="token punctuation">:</span>
      <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline
  <span class="token key atrule">template</span><span class="token punctuation">:</span>
    <span class="token key atrule">metadata</span><span class="token punctuation">:</span>
      <span class="token key atrule">labels</span><span class="token punctuation">:</span>
        <span class="token key atrule">app</span><span class="token punctuation">:</span> pipeline    
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">containers</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> pipeline
        <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.11.102<span class="token punctuation">:</span>80/repo/pipeline<span class="token punctuation">:</span>latest   <span class="token comment"># 这里</span>
        <span class="token key atrule">imagePullPolicy</span><span class="token punctuation">:</span> Always
        <span class="token key atrule">ports</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token comment"># 省略其他内容…………</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="滚动更新"><a href="#滚动更新" class="header-anchor">#</a> 滚动更新</h4> <p>因为 pipeline 没有改变时，每次不会重新加载，这样会导致 Pod 中的容器不会动态更新，这里需要使用 kubectl 的 rollout restart 命令滚动更新</p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234208.png" alt="1642501521065"></p> <p><img src="https://cdn.jsdelivr.net/gh/Kele-Bingtang/static/img/DevOps/20230709234209.png" alt="1642501549176"></p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Kele-Bingtang/pure-blog/edit/master/docs/40.工具/50.持续集成 - Jenkins/07.Jenkins - DevOps.md" target="_blank" rel="noopener noreferrer">编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=Jenkins" title="标签">#Jenkins</a></div> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2023/10/23, 18:58:52</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/jenkins/projects/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Jenkins - 多个项目搭建</div></a> <a href="/kubernetes/introduce/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Kubernetes - 介绍</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/jenkins/projects/" class="prev">Jenkins - 多个项目搭建</a></span> <span class="next"><a href="/kubernetes/introduce/">Kubernetes - 介绍</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/ep/magic-change/"><div>
            技术随笔 - Element Plus 修改包名
            <span class="title-tag">
              原创
            </span></div></a> <span class="date">11-02</span></dt></dl><dl><dd>02</dd> <dt><a href="/reactor/extensibility/"><div>
            Reactor - 扩展性
            <!----></div></a> <span class="date">11-02</span></dt></dl><dl><dd>03</dd> <dt><a href="/reactor/best-practices/"><div>
            Reactor - 最佳实践
            <!----></div></a> <span class="date">11-02</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/kele-bingtang" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/kele-bingtang" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://www.youngkbt.cn" title="网站首页" target="_blank" class="iconfont icon-rss"></a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=28761025&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" class="iconfont icon-QQ"></a><a href="https://www.youngkbt.cn/?contact=true" title="联系我" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2024
    <span>Young Kbt  | blog<br> <a href="http://beian.miit.gov.cn/" target="_blank">桂ICP备2021009994号</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div><div></div><!----></div></div>
    <script src="/assets/js/app.7d9f7e76.js" defer></script><script src="/assets/js/2.7b39a60a.js" defer></script><script src="/assets/js/311.daf5fc45.js" defer></script><script src="/assets/js/7.e563704e.js" defer></script><script src="/assets/js/4.e30b0885.js" defer></script>
  </body>
</html>
