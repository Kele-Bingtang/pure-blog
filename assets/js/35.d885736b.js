(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{359:function(t,a,s){"use strict";s.r(a);var n=s(3),e=Object(n.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"推荐资源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#推荐资源"}},[t._v("#")]),t._v(" 推荐资源")]),t._v(" "),a("ul",[a("li",[a("code",[t._v("https://www.bilibili.com/video/BV15b4y1a7yG/")]),t._v("：Spring Boot2")]),t._v(" "),a("li",[a("code",[t._v("https://www.bilibili.com/video/BV1Es4y1q7Bf/")]),t._v("：Spring Boot3")]),t._v(" "),a("li",[a("code",[t._v("https://www.bilibili.com/video/BV19K4y1L7M")]),t._v("：Spring Boot2（p32 - p42 讲解 Spring MVC 源码和内容协商源码）")])]),t._v(" "),a("h2",{attrs:{id:"自动装配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动装配"}},[t._v("#")]),t._v(" 自动装配")]),t._v(" "),a("ol",[a("li",[t._v("导入 "),a("code",[t._v("Starter")])]),t._v(" "),a("li",[t._v("依赖自动导入 "),a("code",[t._v("autoconfigure")])]),t._v(" "),a("li",[t._v("Spring Boot 寻找类路径下 "),a("code",[t._v("META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports")]),t._v(" 文件")]),t._v(" "),a("li",[t._v("启动，加载所有 自动配置类："),a("code",[t._v("xxxAutoConfiguration")]),t._v(" "),a("ol",[a("li",[t._v("给容器中配置 "),a("strong",[t._v("功能")]),t._v(" 组件")]),t._v(" "),a("li",[t._v("组件参数绑定到属性类中："),a("code",[t._v("xxxProperties")])]),t._v(" "),a("li",[t._v("属性类和配置文件前缀项绑定")]),t._v(" "),a("li",[a("code",[t._v("@Contional")]),t._v(" 派生的条件注解进行判断 "),a("strong",[t._v("是否组件生效")])])])])]),t._v(" "),a("p",[t._v("自动装配通过 "),a("code",[t._v("@SpringBootApplication")]),t._v(" 注解来执行，该注解主要功能：")]),t._v(" "),a("ul",[a("li",[t._v("排除一些不需要的组件")]),t._v(" "),a("li",[t._v("扫描主程序所在的包及其子包，将 "),a("code",[t._v("@Component")]),t._v(" 等注解修饰的类添加到容器中")]),t._v(" "),a("li",[t._v("加载所有内置的自动配置类到容器中")])]),t._v(" "),a("p",[a("code",[t._v("@SpringBootConfiguration")]),t._v(" 就是 "),a("code",[t._v("@Configuration")]),t._v("，容器中的组件，配置类。spring IOC 启动就会加载创建这个类对象。")]),t._v(" "),a("ul",[a("li",[a("p",[a("code",[t._v("@SpringBootConfiguration")]),t._v(" 注解里引用了 "),a("code",[t._v("@EnableAutoConfiguration")]),t._v("、"),a("code",[t._v("@ComponentScan")]),t._v(" 注解")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@SpringBootConfiguration")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@EnableAutoConfiguration")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ComponentScan")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("excludeFilters "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FilterType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CUSTOM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" classes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("TypeExcludeFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Filter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("FilterType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("CUSTOM")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" classes "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AutoConfigurationExcludeFilter")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("SpringBootApplication")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])])])]),t._v(" "),a("p",[a("code",[t._v("@EnableAutoConfiguration")]),t._v(" 开启自动配置，该注解引用了 "),a("code",[t._v("@AutoConfigurationPackage")]),t._v(" 注解。")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ElementType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TYPE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Retention")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetentionPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUNTIME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Documented")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Inherited")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@AutoConfigurationPackage")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AutoConfigurationImportSelector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EnableAutoConfiguration")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("p",[a("code",[t._v("@AutoConfigurationPackage")]),t._v("：扫描主程序包：加载自己的组件")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Target")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("ElementType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("TYPE")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Retention")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("RetentionPolicy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("RUNTIME")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Documented")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Inherited")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Import")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AutoConfigurationPackages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Registrar")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@interface")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("AutoConfigurationPackage")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("basePackages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Class")]),a("span",{pre:!0,attrs:{class:"token generics"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("?")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("basePackageClasses")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("ul",[a("li",[a("p",[t._v("该注解利用 "),a("code",[t._v("@Import(AutoConfigurationPackages.Registrar.class)")]),t._v(" 想要给容器中导入组件")])]),t._v(" "),a("li",[a("p",[t._v("把主程序所在的 "),a("strong",[t._v("包")]),t._v(" 的所有组件导入进来")])]),t._v(" "),a("li",[a("p",[t._v("为什么 SpringBoot 默认只扫描主程序所在的包及其子包，就是这个注解 "),a("code",[t._v("AutoConfigurationPackage")]),t._v(" 实现的")])])]),t._v(" "),a("p",[t._v("除此之外 "),a("code",[t._v("@EnableAutoConfiguration")]),t._v(" 使用 "),a("code",[t._v("@Import(AutoConfigurationImportSelector.class)")]),t._v(" 注解，该注解加载所有自动配置类，即 Spring Boot 加载内置的 Starter。")]),t._v(" "),a("p",[a("code",[t._v("@ComponentScan")]),t._v("：组件扫描：排除一些组件（哪些不要）、排除前面已经扫描进来的配置类、和自动配置类。")]),t._v(" "),a("h2",{attrs:{id:"自定义-started-步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义-started-步骤"}},[t._v("#")]),t._v(" 自定义 Started 步骤")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("创建自定义 Starter 项目，引入 "),a("code",[t._v("spring-boot-starter")]),t._v(" 基础依赖")])]),t._v(" "),a("li",[a("p",[t._v("编写模块功能，引入模块所有需要的依赖")])]),t._v(" "),a("li",[a("p",[t._v("编写 "),a("code",[t._v("xxProperties")]),t._v(" 属性类，可以读取 application.yml 的配置")]),t._v(" "),a("div",{staticClass:"language-java line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-java"}},[a("code",[a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@ConfigurationProperties")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("prefix "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"user"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 此属性类和配置文件指定前缀绑定")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[t._v("@Data")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("UserProperties")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" age"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("String")]),t._v(" email"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("写 "),a("code",[t._v("xxxAutoConfiguration")]),t._v(" 自动配置类，导入该项目需要的组件，包括上面的 "),a("code",[t._v("xxProperties")]),t._v(" 组件")])]),t._v(" "),a("li",[a("p",[t._v("引入 "),a("code",[t._v("spring-boot-configuration-processor")]),t._v(" 依赖，该依赖帮助写 application.yml 时有语法提示")])])]),t._v(" "),a("p",[t._v("写完一个 Started 后，我们希望其他项目只需要引入 Started 依赖就可以使用里面的组件，但是遇到一个问题：")]),t._v(" "),a("p",[t._v("为什么这些组件默认不会扫描进去？")]),t._v(" "),a("p",[t._v("因为 Starter 所在的包和引入它的项目的主程序所在的包不是父子层级，因此不能自动扫描到容器。")]),t._v(" "),a("p",[t._v("因此我们有两个方式可以将写的内容导入到项目的容器：")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("Started 提供 "),a("code",[t._v("@EnableXxx")]),t._v(" 注解，开发者在主程序使用 "),a("code",[t._v("@EnableXxx")]),t._v(" 即可导入 Stated 组件，该注解内部其实使用 "),a("code",[t._v("@Import(xxx.class)")]),t._v(" 将 Started 的组件导入到容器")])]),t._v(" "),a("li",[a("p",[t._v("按照 SpringBoot 的 SPI 机制，将需要导入的组件写到 "),a("code",[t._v("resource/META-INF")]),t._v(" 下的 spring.factory（Spring Boot 2.X） 或者 "),a("code",[t._v("META-INF/spring/org.springframework.boot.autoconfigure.AutoConfiguration.imports")]),t._v("（Spring Boot 3.X）里，Spring Boot 会自动扫描该文件")])])]),t._v(" "),a("h2",{attrs:{id:"spring-boot-admin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#spring-boot-admin"}},[t._v("#")]),t._v(" Spring Boot Admin")]),t._v(" "),a("p",[t._v("视频："),a("code",[t._v("https://www.bilibili.com/video/BV15b4y1a7yG?p=137")]),t._v("。")])])}),[],!1,null,null,null);a.default=e.exports}}]);