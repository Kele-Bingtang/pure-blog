(window.webpackJsonp=window.webpackJsonp||[]).push([[280],{610:function(a,s,t){"use strict";t.r(s);var n=t(3),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p"),s("div",{staticClass:"table-of-contents"},[s("ul",[s("li",[s("a",{attrs:{href:"#spring-cloud-alibaba-组件"}},[a._v("Spring Cloud Alibaba 组件")])]),s("li",[s("a",{attrs:{href:"#nacos"}},[a._v("Nacos")]),s("ul",[s("li",[s("a",{attrs:{href:"#安装"}},[a._v("安装")])]),s("li",[s("a",{attrs:{href:"#端口修改"}},[a._v("端口修改")])]),s("li",[s("a",{attrs:{href:"#数据库修改"}},[a._v("数据库修改")])]),s("li",[s("a",{attrs:{href:"#单机"}},[a._v("单机")])]),s("li",[s("a",{attrs:{href:"#集群"}},[a._v("集群")])]),s("li",[s("a",{attrs:{href:"#客户端配置"}},[a._v("客户端配置")])])])]),s("li",[s("a",{attrs:{href:"#sentinel"}},[a._v("Sentinel")]),s("ul",[s("li",[s("a",{attrs:{href:"#概述"}},[a._v("概述")])]),s("li",[s("a",{attrs:{href:"#sentinel-基本概念"}},[a._v("Sentinel 基本概念")])]),s("li",[s("a",{attrs:{href:"#sentinel-的组成"}},[a._v("Sentinel 的组成")])]),s("li",[s("a",{attrs:{href:"#安装控制台"}},[a._v("安装控制台")])]),s("li",[s("a",{attrs:{href:"#客户端配置"}},[a._v("客户端配置")])]),s("li",[s("a",{attrs:{href:"#自定义异常处理器"}},[a._v("自定义异常处理器")])]),s("li",[s("a",{attrs:{href:"#授权规则"}},[a._v("授权规则")])])])]),s("li",[s("a",{attrs:{href:"#seata"}},[a._v("Seata")]),s("ul",[s("li",[s("a",{attrs:{href:"#安装"}},[a._v("安装")])]),s("li",[s("a",{attrs:{href:"#数据库创建"}},[a._v("数据库创建")])]),s("li",[s("a",{attrs:{href:"#配置文件修改"}},[a._v("配置文件修改")])]),s("li",[s("a",{attrs:{href:"#配置同步到-nacos"}},[a._v("配置同步到 Nacos")])]),s("li",[s("a",{attrs:{href:"#手动同步"}},[a._v("手动同步")])]),s("li",[s("a",{attrs:{href:"#脚本同步"}},[a._v("脚本同步")])]),s("li",[s("a",{attrs:{href:"#添加数据库驱动"}},[a._v("添加数据库驱动")])]),s("li",[s("a",{attrs:{href:"#启动"}},[a._v("启动")])]),s("li",[s("a",{attrs:{href:"#客户端配置-rm"}},[a._v("客户端配置（RM）")])]),s("li",[s("a",{attrs:{href:"#使用"}},[a._v("使用")])])])])])]),s("p"),a._v(" "),s("h2",{attrs:{id:"spring-cloud-alibaba-组件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#spring-cloud-alibaba-组件"}},[a._v("#")]),a._v(" Spring Cloud Alibaba 组件")]),a._v(" "),s("p",[a._v("Nacos：注册中心 & 配置中心")]),a._v(" "),s("p",[a._v("Sentienl：流量控制 & 服务熔断、降级")]),a._v(" "),s("p",[a._v("Seata：分布式事务")]),a._v(" "),s("h2",{attrs:{id:"nacos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nacos"}},[a._v("#")]),a._v(" Nacos")]),a._v(" "),s("p",[a._v("Nacos 的全称是 Dynamic Naming and Configuration Service，Na 为 naming/nameServer 即注册中心，co 为 configuration 即注册中心，service 是指该注册/配置中心都是以服务为核心。")]),a._v(" "),s("p",[a._v("Nacos 致力于帮助您发现、配置和管理微服务。Nacos 提供了一组简单易用的特性集，帮助您快速实现动态服务发现、服务配置、服务元数据及流量管理。")]),a._v(" "),s("p",[a._v("官方网址："),s("code",[a._v("https://nacos.io/zh-cn/")]),a._v("。")]),a._v(" "),s("h3",{attrs:{id:"安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[a._v("安装包下载地址："),s("code",[a._v("https://github.com/alibaba/nacos/releases")])]),a._v(" "),s("p",[a._v("解压后会有两个重要的文件夹：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("bin：运行脚本")])]),a._v(" "),s("li",[s("p",[a._v("conf：配置文件")])])]),a._v(" "),s("p",[a._v("主要的安装是配置文件修改：")]),a._v(" "),s("h3",{attrs:{id:"端口修改"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#端口修改"}},[a._v("#")]),a._v(" 端口修改")]),a._v(" "),s("p",[a._v("Nacos 的默认端口是 8848，如果要修改，前往 "),s("code",[a._v("conf/application.properties")]),a._v("（如果没有则复制一份 "),s("code",[a._v("application.properties.example")]),a._v(" 文件，改名即可） 修改，找到 "),s("code",[a._v("server.port=8848")]),a._v(" 进行修改。")]),a._v(" "),s("h3",{attrs:{id:"数据库修改"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据库修改"}},[a._v("#")]),a._v(" 数据库修改")]),a._v(" "),s("p",[a._v("如果将 Nacos 里的配置进行持久化，则配置 MySQL，将配置存到 MySQL。")]),a._v(" "),s("p",[a._v("在 config 找到 nacos-mysql.sql 文件，在 MySQL 先创建 nacos_config 数据库，然后执行该 sql 文件，在 nacos_config 数据库生成 Nacos 需要的表。")]),a._v(" "),s("p",[a._v("最后打开 "),s("code",[a._v("conf/application.properties")]),a._v("，替换为如下配置：")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.sql.init.platform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("### Count of DB:")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.num")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("### Connect URL of DB:")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.url.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:mysql://172.0.0.1:3306/nacos_config?characterEncoding=utf8&connectTimeout=5000&socketTimeout=8000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=UTC")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.user.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("root")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.password.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1234")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("如果实现数据库高可用，则可以配置多个数据库，需要修改 "),s("code",[a._v("db.num")]),a._v(" 和添加多个数据库源。")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("spring.sql.init.platform")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("### Count of DB:")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.num")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("### Connect URL of DB:")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.url.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:mysql://172.0.0.1:3306/nacos_config?characterEncoding=utf8&connectTimeout=5000&socketTimeout=8000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=UTC")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.user.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("root")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.password.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("Arthur10035@202207")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.url.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:mysql://172.0.0.1:3306/nacos_config?characterEncoding=utf8&connectTimeout=5000&socketTimeout=8000&autoReconnect=true&useUnicode=true&useSSL=false&serverTimezone=UTC")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.user.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("root")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("db.password.1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1234")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br")])]),s("p",[a._v("多数据库源通过 "),s("code",[a._v(".0")]),a._v("，"),s("code",[a._v(".1")]),a._v(" 来区分，如果需要更多数据库，依次类推。")]),a._v(" "),s("h3",{attrs:{id:"单机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#单机"}},[a._v("#")]),a._v(" 单机")]),a._v(" "),s("p",[a._v("Nacos 默认是集群启动方式。如果是单机（一台 Nacos）运行，则需要修改启动方式，编辑 "),s("code",[a._v("bin/startup.cmd")]),a._v("（Windows）或者 "),s("code",[a._v("/bin/startup.sh")]),a._v("（Linux）。")]),a._v(" "),s("p",[a._v("如果是 Windows，则找到")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MODE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cluster"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("修改为：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("set")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MODE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"standalone"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("然后双击修改后的该文件启动即可。")]),a._v(" "),s("p",[a._v("如果是 Linux，则找到")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MODE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cluster"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("修改为：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MODE")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"standalone"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#集群"}},[a._v("#")]),a._v(" 集群")]),a._v(" "),s("p",[a._v("Nacos 默认是集群启动方式，所以无需修改启动方式，而是配置多个集群地址即可。打开 "),s("code",[a._v("conf/cluster.conf")]),a._v("（如果没有则复制一份 "),s("code",[a._v("cluster.conf.example")]),a._v(" 文件，改名即可），添加自己的地址和其他 Nacos 的地址（其他 Nacos 也要打开自己的该文件，配置双方 Nacos 地址，实现双向奔赴）。")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("172.16.49.42")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("8848 # 自己的地址")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("172.16.49.46")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("8848 # 其他 Nacos 的地址")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("最后运行脚本 "),s("code",[a._v("startup.cmd")]),a._v(" 或者 "),s("code",[a._v("startup.sh")]),a._v(" 即可。")]),a._v(" "),s("p",[a._v("如果默认端口、本地运行，则访问 "),s("code",[a._v("http://localhost:8848/nacos")]),a._v(" 进入控制台页面。")]),a._v(" "),s("h3",{attrs:{id:"客户端配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端配置"}},[a._v("#")]),a._v(" 客户端配置")]),a._v(" "),s("p",[a._v("安装依赖")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-nacos-config"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-nacos-discovery"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("p",[a._v("一个 Nacos 的配置中心使用，一个是 Nacos 的服务注册使用。")]),a._v(" "),s("p",[a._v("application.yml 配置 Nacos 配置中心和服务注册的地址：")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" generic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("service "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 项目名")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("profiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("active")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" dev "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 运行环境")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置中心")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 172.16.138.184"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Nacos 地址")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("file-extension")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yaml "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 文件后缀名")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 5014d494"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("958a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("4476"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("9aad"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("880c2a0c9498 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 命名空间 ID")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" DEFAULT_GROUP "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 读取文件所在的组")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("discovery")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 服务注册")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("service")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.application.name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 使用微服务的名称作为注册的服务名称")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 172.16.138.184"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Nacos服务地址")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 5014d494"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("958a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("4476"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("9aad"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("880c2a0c9498 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 命名空间 ID")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" DEFAULT_GROUP "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 读取文件所在的组")]),a._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定该项目读取配置中心的文件名")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("import")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" optional"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("nacos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.application.name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.profiles.active"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(".$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.cloud.nacos.config.file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("extension"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" optional"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("nacos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.application.name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(".$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.cloud.nacos.config.file"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("extension"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" optional"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("nacos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("nacos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("discovery.yaml"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("group=DEFAULT_GROUP"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("&refreshEnabled=true")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" nacos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("datasource.yaml"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("group=DEFAULT_GROUP"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("&refreshEnabled=true")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br")])]),s("p",[a._v("其中 optional 表示可选，即当无法在配置中心读取到该配置文件，也是可以运行项目，如上面标识 datasource.yaml 文件必须要读取到，否则项目启动报错。")]),a._v(" "),s("h2",{attrs:{id:"sentinel"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sentinel"}},[a._v("#")]),a._v(" Sentinel")]),a._v(" "),s("h3",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[a._v("#")]),a._v(" 概述")]),a._v(" "),s("p",[a._v("随着微服务的流行，服务和服务之间的稳定性变得越来越重要。Sentinel 是面向分布式、多语言异构化服务架构的流量治理组件，主要以流量为切入点，从流量路由、流量控制、流量整形、熔断降级、系统自适应过载保护、热点流量防护等多个维度来帮助开发者保障微服务的稳定性。")]),a._v(" "),s("p",[a._v("Sentinel 是由阿里巴巴中间件团队开发的开源项目，是一种面向分布式微服务架构的轻量级高可用流量控制组件")]),a._v(" "),s("p",[a._v("Sentinel 主要以流量为切入点，从流量控制、熔断降级、系统负载保护等多个维度帮助用户保护服务的稳定性。")]),a._v(" "),s("p",[a._v("Sentinel 具有以下特征：")]),a._v(" "),s("ul",[s("li",[s("p",[s("strong",[a._v("丰富的应用场景")]),a._v("：Sentinel 承接了阿里巴巴近 10 年的双十一大促流量的核心场景，例如秒杀（即突发流量控制在系统容量可以承受的范围）、消息削峰填谷、集群流量控制、实时熔断下游不可用应用等")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("完备的实时监控")]),a._v("：Sentinel 同时提供实时的监控功能。您可以在控制台中看到接入应用的单台机器秒级数据，甚至 500 台以下规模的集群的汇总运行情况")])]),a._v(" "),s("li",[s("p",[a._v("广泛的开源生态：Sentinel 提供开箱即用的与其它开源框架/库的整合模块，例如与 Spring Cloud、Apache Dubbo、gRPC、Quarkus 的整合。您只需要引入相应的依赖并进行简单的配置即可快速地接入 Sentinel。同时 Sentinel 提供 Java/Go/C++ 等多语言的原生实现")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("完善的 SPI 扩展机制")]),a._v("：Sentinel 提供简单易用、完善的 SPI 扩展接口。您可以通过实现扩展接口来快速地定制逻辑。例如定制规则管理、适配动态数据源等")])])]),a._v(" "),s("h3",{attrs:{id:"sentinel-基本概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sentinel-基本概念"}},[a._v("#")]),a._v(" Sentinel 基本概念")]),a._v(" "),s("blockquote",[s("p",[a._v("资源")])]),a._v(" "),s("p",[a._v("资源是 Sentinel 的关键概念。它可以是 Java 应用程序中的任何内容，例如，由应用程序提供的服务，或由应用程序调用的其它应用提供的服务，甚至可以是一段代码。在接下来的文档中，我们都会用资源来描述代码块。")]),a._v(" "),s("p",[a._v("只要通过 Sentinel API 定义的代码，就是资源，能够被 Sentinel 保护起来。大部分情况下，可以使用方法签名，URL，甚至服务名称作为资源名来标示资源。")]),a._v(" "),s("blockquote",[s("p",[a._v("规则")])]),a._v(" "),s("p",[a._v("围绕资源的实时状态设定的规则，可以包括流量控制规则、熔断降级规则以及系统保护规则。所有规则可以动态实时调整。")]),a._v(" "),s("h3",{attrs:{id:"sentinel-的组成"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#sentinel-的组成"}},[a._v("#")]),a._v(" Sentinel 的组成")]),a._v(" "),s("p",[a._v("Sentinel 主要由以下两个部分组成：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("Sentinel 核心库：Sentinel 的核心库不依赖任何框架或库，能够运行于 Java 8 及以上的版本的运行时环境中，同时对 Spring Cloud、Dubbo 等微服务框架提供了很好的支持")])]),a._v(" "),s("li",[s("p",[a._v("Sentinel 控制台（Dashboard）：Sentinel 提供的一个轻量级的开源控制台，它为用户提供了机器自发现、簇点链路自发现、监控、规则配置等功能")])])]),a._v(" "),s("p",[a._v("Sentinel 核心库不依赖 Sentinel Dashboard，但两者结合使用可以有效的提高效率，让 Sentinel 发挥它最大的作用。")]),a._v(" "),s("h3",{attrs:{id:"安装控制台"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装控制台"}},[a._v("#")]),a._v(" 安装控制台")]),a._v(" "),s("p",[a._v("Sentinel 提供了一个轻量级的开源控制台 Sentinel Dashboard，它提供了机器发现与健康情况管理、监控（单机和集群）、规则管理与推送等多种功能。")]),a._v(" "),s("p",[a._v("Sentinel 控制台提供的功能如下：")]),a._v(" "),s("ul",[s("li",[s("p",[s("strong",[a._v("查看机器列表以及健康情况")]),a._v("：Sentinel 控制台能够收集 Sentinel 客户端发送的心跳包，判断机器是否在线")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("监控（单机和集群聚合）")]),a._v("：Sentinel 控制台通过 Sentinel 客户端暴露的监控 API，可以实现秒级的实时监控")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("规则管理和推送")]),a._v("：通过 Sentinel 控制台，我们还能够针对资源定义和推送规则")])]),a._v(" "),s("li",[s("p",[s("strong",[a._v("鉴权")]),a._v("：从 Sentinel 1.6.0 起，Sentinel 控制台引入基本的登录功能，默认用户名和密码都是 sentinel")])])]),a._v(" "),s("p",[a._v("Sentinel Dashboard 是我们配置和管理规则（例如流控规则、熔断降级规则等）的重要入口之一。通过它，我们不仅可以对规则进行配置和管理，还能实时查看规则的效果。")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/alibaba/Sentinel/releases",target:"_blank",rel:"noopener noreferrer"}},[a._v("下载地址"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("启动：（全部使用默认配置）")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-jar")]),a._v(" sentinel-dashboard-1.8.6.jar\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("启动时指定端口：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dserver.port")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8480")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-jar")]),a._v(" sentinel-dashboard-1.8.6.jar\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("启动时指定端口，是否监控自己，项目名称，登录的帐号和密码：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("java")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dserver.port")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8480")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dcsp.sentinel.dashboard.server")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("localhost:8480 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dproject.name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("sentinel-dashboard "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dsentinel.dashboard.auth.username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("sentinel "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dsentinel.dashboard.auth.password")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("123456")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-jar")]),a._v(" sentinel-dashboard-1.8.6.jar\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("参数说明：(注意：参数要放到 -jar 的前边)")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定控制台的端口为8480")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dserver.port")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8480")]),a._v(" \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定要被哪个控制台监控（这里指定的是自己监控自己）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dcsp.sentinel.dashboard.server")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("localhost:8480 \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定实例名称（名称会在控制台左侧以菜单显示）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dproject.name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("sentinel-dashboard \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置登录的帐号为：sentinel ")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dsentinel.dashboard.auth.username")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("sentinel \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 设置登录的密码为：123456")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dsentinel.dashboard.auth.password")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("123456")]),a._v(" \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("h3",{attrs:{id:"客户端配置-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端配置-2"}},[a._v("#")]),a._v(" 客户端配置")]),a._v(" "),s("p",[a._v("引入依赖：")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-sentinel"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!-- Sentinel Nacos 持久化依赖 --\x3e")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.csp"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("sentinel-datasource-nacos"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("第一个是 Sentinel 的使用，第二个是 Sentinel 读取在 Nacos 的配置。")]),a._v(" "),s("p",[a._v("application.yml 配置 Sentienl 的地址：")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" generic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("service "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 项目名")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("profiles")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("active")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" dev "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 运行环境")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cloud")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("sentinel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("transport")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dashboard")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 172.16.138.184"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 控制台地址")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("web-context-unify")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("false")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("datasource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 读取在 Nacos 的配置(持久化)")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("generic-service")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 随便取，这里以项目名命名")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 172.16.138.184"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# nacos地址")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 5014d494"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("958a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("4476"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("9aad"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("880c2a0c9498 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 命名空间 ID")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dataId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.application.name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("flow"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("rules "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 文件名")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" DEFAULT_GROUP "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 文件所在的分组")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dataType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" json "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 文件是 JSON 格式")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ruleType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" flow "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 规则类型")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Nacos 用户名")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Nacos 密码")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br")])]),s("p",[a._v("此时在 Sentinel 可以读取 Nacos 的配置，但是无法在 Sentinel 添加规则配置时，同步到 Nacos。")]),a._v(" "),s("p",[a._v("换句话说，就是我们目前只能在 Nacos 手动添加 Sentienl 需要的规则配置，然后 Sentienl 去读取，而无法我们在操作 Sentienl 的规则时，这些规则自动同步到 Nacos。也就是 Nacos 单向奔赴。")]),a._v(" "),s("p",[a._v("如果 Sentinel 的规则配置自动同步到 Nacos，需要更改源码，即下载 Sentinel Dashboard 的代码进行更改，然后打包成新的 jar。具体自行百度，或者参考如下链接："),s("code",[a._v("https://blog.csdn.net/weixin_53041251/article/details/129651977")]),a._v("。")]),a._v(" "),s("h3",{attrs:{id:"自定义异常处理器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自定义异常处理器"}},[a._v("#")]),a._v(" 自定义异常处理器")]),a._v(" "),s("p",[a._v("当 Sentinel 里面发生限流降级，授权拦截等等各种异常时，它都会抛出 BlockException。")]),a._v(" "),s("p",[a._v("因此自定义一个类实现 BlockExceptionHandler 接口后，当 Sentinel 抛出内部异常时，将会触发该实现类。")]),a._v(" "),s("p",[a._v("这个方法有三个参数：")]),a._v(" "),s("ul",[s("li",[a._v("HttpServletRequest request：request对象")]),a._v(" "),s("li",[a._v("HttpServletResponse response：response对象")]),a._v(" "),s("li",[a._v("BlockExceptione：被 Sentinel 拦截时抛出的异常")])]),a._v(" "),s("p",[a._v("其中 BlockException 包含多个不同的子类：")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[s("strong",[a._v("异常")])]),a._v(" "),s("th",[s("strong",[a._v("说明")])])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("FlowException")]),a._v(" "),s("td",[a._v("限流异常")])]),a._v(" "),s("tr",[s("td",[a._v("ParamFlowException")]),a._v(" "),s("td",[a._v("热点参数限流的异常")])]),a._v(" "),s("tr",[s("td",[a._v("DegradeException")]),a._v(" "),s("td",[a._v("降级异常")])]),a._v(" "),s("tr",[s("td",[a._v("AuthorityException")]),a._v(" "),s("td",[a._v("授权规则异常")])]),a._v(" "),s("tr",[s("td",[a._v("SystemBlockException")]),a._v(" "),s("td",[a._v("系统规则异常")])])])]),a._v(" "),s("p",[a._v("因此我们就可以对异常类型做个判断，判断是这 5 种中的哪一种，从而去返回不同的结果，做不同处理。")]),a._v(" "),s("div",{staticClass:"language-java line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("SentinelExceptionHandler")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("implements")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("BlockExceptionHandler")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Override")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("handle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HttpServletRequest")]),a._v(" request"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HttpServletResponse")]),a._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" s"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("BlockException")]),a._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("throws")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Exception")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" message "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"未知异常"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" status "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("429")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("instanceof")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("FlowException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            message "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"请求被限流了"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("instanceof")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ParamFlowException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            message "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"请求被热点参数限流"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("instanceof")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("DegradeException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            message "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"请求被降级了"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("else")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("if")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("instanceof")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AuthorityException")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            message "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"没有权限访问"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            status "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("401")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("long")]),a._v(" epochMilli "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Instant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("now")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("atZone")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ZoneId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("systemDefault")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toInstant")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toEpochMilli")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("renderString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"{\\"code\\": "')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("200")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('", \\"message\\": "')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" message "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('", \\"status\\": \\"success\\", \\"data\\": null, \\"timeStamp\\": "')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" epochMilli "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"}"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  \n   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n     * 将字符串渲染到客户端\n     *\n     * @param response 渲染对象\n     * @param jsonMsg  待渲染的字符串\n     * @param status   状态码\n     */")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("renderString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HttpServletResponse")]),a._v(" response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" jsonMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Integer")]),a._v(" status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("try")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setStatus")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("status"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setContentType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"application/json"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setCharacterEncoding")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"utf-8"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            response"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getWriter")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("print")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("jsonMsg"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("catch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("IOException")]),a._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            log"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("error")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br")])]),s("h3",{attrs:{id:"授权规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#授权规则"}},[a._v("#")]),a._v(" 授权规则")]),a._v(" "),s("p",[a._v("Sentinel 有限流、熔断、热线、系统、授权规则。其中大部分都可以在控制台进行配置。")]),a._v(" "),s("p",[a._v("授权规则比较特殊")]),a._v(" "),s("h2",{attrs:{id:"seata"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#seata"}},[a._v("#")]),a._v(" Seata")]),a._v(" "),s("p",[a._v("Seata 是一款开源的分布式事务解决方案，致力于提供高性能和简单易用的分布式事务服务。Seata 将为用户提供了 "),s("strong",[a._v("AT")]),a._v("、"),s("strong",[a._v("TCC")]),a._v("、"),s("strong",[a._v("SAGA")]),a._v(" 和 "),s("strong",[a._v("XA")]),a._v(" 事务模式，为用户打造一站式的分布式解决方案。")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("对业务无侵入：即减少技术架构上的微服务化所带来的分布式事务问题对业务的侵入")])]),a._v(" "),s("li",[s("p",[a._v("高性能：减少分布式事务解决方案所带来的性能消耗")])])]),a._v(" "),s("p",[a._v("官方文档："),s("code",[a._v("https://seata.io/zh-cn/index.html")]),a._v("。")]),a._v(" "),s("p",[a._v("seata 的几种术语：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("TC（Transaction Coordinator）：事务协调者。管理全局的分支事务的状态，用于全局性事务的提交和回滚")])]),a._v(" "),s("li",[s("p",[a._v("TM（Transaction Manager）：事务管理者。用于开启、提交或回滚事务")])]),a._v(" "),s("li",[s("p",[a._v("RM（Resource Manager）：资源管理器。用于分支事务上的资源管理，向 TC 注册分支事务，上报分支事务的状态，接收 TC 的命令来提交或者回滚分支事务")])])]),a._v(" "),s("h3",{attrs:{id:"安装-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装-2"}},[a._v("#")]),a._v(" 安装")]),a._v(" "),s("p",[a._v("下载地址："),s("code",[a._v("http://seata.io/zh-cn/blog/download.html")]),a._v("。")]),a._v(" "),s("p",[a._v("接着解压下载的压缩包。")]),a._v(" "),s("h3",{attrs:{id:"数据库创建"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据库创建"}},[a._v("#")]),a._v(" 数据库创建")]),a._v(" "),s("p",[a._v("在 MySQL 创建 Seata 需要的务日志，回滚日志等表。")]),a._v(" "),s("p",[a._v("先在 MySQL，创建 seata 数据库，然后打开 "),s("code",[a._v("script\\server\\db")]),a._v("，在 MySQL 运行 mysql.sql，最后可以看到 seata 数据库下有 Seata 需要的表。")]),a._v(" "),s("p",[a._v("此时 Seata 还没有和 seata 数据库绑定，下面配置文件修改将进行绑定。")]),a._v(" "),s("h3",{attrs:{id:"配置文件修改"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置文件修改"}},[a._v("#")]),a._v(" 配置文件修改")]),a._v(" "),s("p",[a._v("这里将修改 Seata 的一些配置：")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("绑定 Nacos，从 Nacos 读取需要的配置文件")])]),a._v(" "),s("li",[s("p",[a._v("注册 Nacos，将 Seata 服务注册到 Nacos")])]),a._v(" "),s("li",[s("p",[a._v("持久化 MySQL，Seata 执行过程的事务日志，回滚日志存储到 MySQL")])])]),a._v(" "),s("p",[a._v("打开 "),s("code",[a._v("conf/application.yml")]),a._v(" 文件，将 config、registry 改为 Nacos，store 先去掉，后面 store 的配置将放在 Nacos 里：")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7091")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("server\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("logging")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" classpath"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("logback"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("spring.xml\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("file")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("log.home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("user.home"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("/logs/seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("console")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" seata\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" seata\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("seata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# support: nacos, consul, apollo, zk, etcd3")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 192.168.1.5"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" acf53419"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("d42c"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("4041"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("b97a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("166ce915d92e\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" DEFAULT_GROUP\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("data-id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("server.properties "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 配置文件名")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("registry")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# support: nacos, eureka, redis, zk, consul, etcd3, sofa")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("seata.config.nacos.server"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("addr"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.application.name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("seata.config.nacos.namespace"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("seata.config.nacos.group"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("seata.config.nacos.username"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" $"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("seata.config.nacos.password"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#  server:")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#    service-port: 8091 #If not configured, the default is '${server.port} + 1000'")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("security")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("secretKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SeataSecretKey0c382ef121d778043159209298fd40bf3850a017\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("tokenValidityInMilliseconds")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1800000")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("csrf-ignore-urls")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" /metadata/v1/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ignore")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("urls")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" /"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.css")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.js")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.html")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.map")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.svg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.png")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.jpeg")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**/*.ico")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/api/v1/auth/login"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/version.json"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/health"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/error"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("/vgroup/v1/"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("**")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br"),s("span",{staticClass:"line-number"},[a._v("40")]),s("br"),s("span",{staticClass:"line-number"},[a._v("41")]),s("br"),s("span",{staticClass:"line-number"},[a._v("42")]),s("br"),s("span",{staticClass:"line-number"},[a._v("43")]),s("br"),s("span",{staticClass:"line-number"},[a._v("44")]),s("br"),s("span",{staticClass:"line-number"},[a._v("45")]),s("br")])]),s("p",[a._v("如果需要更多的配置参考，请打开 "),s("code",[a._v("application.example.yml")]),a._v(" 参考。")]),a._v(" "),s("h3",{attrs:{id:"配置同步到-nacos"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置同步到-nacos"}},[a._v("#")]),a._v(" 配置同步到 Nacos")]),a._v(" "),s("p",[a._v("我们需要实现准备 Seata 需要的配置文件，将其放到 Nacos，这样启动的时候 Seata 就能读取到。")]),a._v(" "),s("h3",{attrs:{id:"手动同步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#手动同步"}},[a._v("#")]),a._v(" 手动同步")]),a._v(" "),s("p",[a._v("在 Nacos 新建一个配置，名字叫做 "),s("code",[a._v("seataServer.properties")]),a._v("，这个名字对应上面 Seata 项目的 application.yml 的 "),s("code",[a._v("seata.config.nacos.data-id")]),a._v("。如果想转换为 yaml，则在 Nacos 配置名和项目 "),s("code",[a._v("application.yml")]),a._v(" 同时更改。")]),a._v(" "),s("p",[a._v("然后将 "),s("code",[a._v("script/config-center/config.txt")]),a._v(" 的内容复制过来，其中如果没用到 Redis 和 file，都可以删除，然后三个 store.mode 都改成 db，接着修改 MySQL 的数据库源")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("div",{staticClass:"highlight-lines"},[s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("div",{staticClass:"highlighted"},[a._v(" ")]),s("div",{staticClass:"highlighted"},[a._v(" ")]),s("div",{staticClass:"highlighted"},[a._v(" ")]),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("div",{staticClass:"highlighted"},[a._v(" ")]),s("div",{staticClass:"highlighted"},[a._v(" ")]),s("div",{staticClass:"highlighted"},[a._v(" ")]),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br"),s("br")]),s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("TCP")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NIO")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.heartbeat")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.enableTmClientBatchSendRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.enableRmClientBatchSendRequest")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.enableTcServerBatchSendResponse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.rpcRmRequestTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.rpcTmRequestTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.rpcTcRequestTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.bossThreadPrefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NettyBoss")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.workerThreadPrefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NettyServerNIOWorker")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.serverExecutorThreadPrefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NettyServerBizHandler")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.shareBossWorker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.clientSelectorThreadPrefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NettyClientSelector")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.clientSelectorThreadSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.clientWorkerThreadPrefix")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("NettyClientWorkerThread")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.bossThreadSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.threadFactory.workerThreadSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.shutdown.wait")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("3")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.serialization")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("seata")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("transport.compressor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("none")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Transaction routing rules configuration, only for the client")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.vgroupMapping.default_tx_group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#If you use a registry, you can ignore it")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.default.grouplist")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1:8091")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.disableGlobalTransaction")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.metadataMaxAgeMs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Transaction rule configuration, only for the client")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.asyncCommitBufferLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.lock.retryInterval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.lock.retryTimes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.lock.retryPolicyBranchRollbackOnConflict")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.reportRetryCount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.tableMetaCheckEnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.tableMetaCheckerInterval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("60000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.sqlParserType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("druid")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.reportSuccessEnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.sagaBranchRegisterEnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.sagaJsonParser")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("fastjson")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.tccActionInterceptorOrder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("-2147482648")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.rm.sqlParserType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("druid")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.tm.commitRetryCount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.tm.rollbackRetryCount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.tm.defaultGlobalTransactionTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("60000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.tm.degradeCheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.tm.degradeCheckAllowTimes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.tm.degradeCheckPeriod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.tm.interceptorOrder")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("-2147482648")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.undo.dataValidation")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.undo.logSerialization")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jackson")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.undo.onlyCareUpdateColumns")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.undo.logSaveDays")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("7")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.undo.logDeletePeriod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("86400000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.undo.logTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("undo_log")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.undo.compress.enable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.undo.compress.type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("zip")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("client.undo.compress.threshold")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("64k")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#For TCC transaction mode")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcc.fence.logTableName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("tcc_fence_log")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcc.fence.cleanPeriod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1h")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# You can choose from the following options: fastjson, jackson, gson")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("tcc.contextJsonParserType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("fastjson")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Log rule configuration, for client and server")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("log.exceptionRate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("100")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Transaction storage configuration, only for the server. The file, db, and redis configuration values are optional.")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("db")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.lock.mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("db")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.session.mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("db")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Used for password encryption")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.publicKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#If `store.mode,store.lock.mode,store.session.mode` are not equal to `file`, you can remove the configuration block.")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.file.dir")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("file_store/data")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.file.maxBranchSessionSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("16384")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.file.maxGlobalSessionSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("512")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.file.fileWriteBufferCacheSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("16384")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.file.flushDiskMode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("async")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.file.sessionReloadReadSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("100")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#These configurations are required if the `store mode` is `db`. If `store.mode,store.lock.mode,store.session.mode` are not equal to `db`, you can remove the configuration block.")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.datasource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("druid")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.dbType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("mysql")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.driverClassName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("com.mysql.jdbc.Driver")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jdbc:mysql://127.0.0.1:3306/seata?useUnicode=true&rewriteBatchedStatements=true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.user")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("username")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("password")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.minConn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.maxConn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("30")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.globalTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("global_table")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.branchTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("branch_table")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.distributedLockTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("distributed_lock")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.vgroupTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("vgroup-table")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.queryLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("100")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.lockTable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("lock_table")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.db.maxWait")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("5000")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#These configurations are required if the `store mode` is `redis`. If `store.mode,store.lock.mode,store.session.mode` are not equal to `redis`, you can remove the configuration block.")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("single")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("pipeline")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.single.host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.single.port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("6379")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.sentinel.masterName")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.sentinel.sentinelHosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.sentinel.sentinelPassword")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.maxConn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.minConn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.maxTotal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("100")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.database")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("store.redis.queryLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("100")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Transaction rule configuration, only for the server")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.recovery.committingRetryPeriod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.recovery.asynCommittingRetryPeriod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.recovery.rollbackingRetryPeriod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.recovery.timeoutRetryPeriod")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("1000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.maxCommitRetryTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("-1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.maxRollbackRetryTimeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("-1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.rollbackRetryTimeoutUnlockEnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.distributedLockExpireTime")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("10000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.session.branchAsyncQueueSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("5000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.session.enableBranchAsyncRemove")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.enableParallelRequestHandle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.enableParallelHandleBranch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.applicationDataLimit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("64000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.applicationDataLimitCheck")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("127.0.0.1:7091,127.0.0.1:7092,127.0.0.1:7093")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.snapshotInterval")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("600")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.applyBatch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("32")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.maxAppendBufferSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("262144")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.maxReplicatorInflightMsgs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("256")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.disruptorBufferSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("16384")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.electionTimeoutMs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.reporterEnabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("false")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.reporterInitialDelay")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("60")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.serialization")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("jackson")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.compressor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("none")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("server.raft.sync")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#Metrics configuration, only for the server")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metrics.enabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("true")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metrics.registryType")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("compact")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metrics.exporterList")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("prometheus")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("metrics.exporterPrometheusPort")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("9898")]),a._v("\n")])]),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br"),s("span",{staticClass:"line-number"},[a._v("35")]),s("br"),s("span",{staticClass:"line-number"},[a._v("36")]),s("br"),s("span",{staticClass:"line-number"},[a._v("37")]),s("br"),s("span",{staticClass:"line-number"},[a._v("38")]),s("br"),s("span",{staticClass:"line-number"},[a._v("39")]),s("br"),s("span",{staticClass:"line-number"},[a._v("40")]),s("br"),s("span",{staticClass:"line-number"},[a._v("41")]),s("br"),s("span",{staticClass:"line-number"},[a._v("42")]),s("br"),s("span",{staticClass:"line-number"},[a._v("43")]),s("br"),s("span",{staticClass:"line-number"},[a._v("44")]),s("br"),s("span",{staticClass:"line-number"},[a._v("45")]),s("br"),s("span",{staticClass:"line-number"},[a._v("46")]),s("br"),s("span",{staticClass:"line-number"},[a._v("47")]),s("br"),s("span",{staticClass:"line-number"},[a._v("48")]),s("br"),s("span",{staticClass:"line-number"},[a._v("49")]),s("br"),s("span",{staticClass:"line-number"},[a._v("50")]),s("br"),s("span",{staticClass:"line-number"},[a._v("51")]),s("br"),s("span",{staticClass:"line-number"},[a._v("52")]),s("br"),s("span",{staticClass:"line-number"},[a._v("53")]),s("br"),s("span",{staticClass:"line-number"},[a._v("54")]),s("br"),s("span",{staticClass:"line-number"},[a._v("55")]),s("br"),s("span",{staticClass:"line-number"},[a._v("56")]),s("br"),s("span",{staticClass:"line-number"},[a._v("57")]),s("br"),s("span",{staticClass:"line-number"},[a._v("58")]),s("br"),s("span",{staticClass:"line-number"},[a._v("59")]),s("br"),s("span",{staticClass:"line-number"},[a._v("60")]),s("br"),s("span",{staticClass:"line-number"},[a._v("61")]),s("br"),s("span",{staticClass:"line-number"},[a._v("62")]),s("br"),s("span",{staticClass:"line-number"},[a._v("63")]),s("br"),s("span",{staticClass:"line-number"},[a._v("64")]),s("br"),s("span",{staticClass:"line-number"},[a._v("65")]),s("br"),s("span",{staticClass:"line-number"},[a._v("66")]),s("br"),s("span",{staticClass:"line-number"},[a._v("67")]),s("br"),s("span",{staticClass:"line-number"},[a._v("68")]),s("br"),s("span",{staticClass:"line-number"},[a._v("69")]),s("br"),s("span",{staticClass:"line-number"},[a._v("70")]),s("br"),s("span",{staticClass:"line-number"},[a._v("71")]),s("br"),s("span",{staticClass:"line-number"},[a._v("72")]),s("br"),s("span",{staticClass:"line-number"},[a._v("73")]),s("br"),s("span",{staticClass:"line-number"},[a._v("74")]),s("br"),s("span",{staticClass:"line-number"},[a._v("75")]),s("br"),s("span",{staticClass:"line-number"},[a._v("76")]),s("br"),s("span",{staticClass:"line-number"},[a._v("77")]),s("br"),s("span",{staticClass:"line-number"},[a._v("78")]),s("br"),s("span",{staticClass:"line-number"},[a._v("79")]),s("br"),s("span",{staticClass:"line-number"},[a._v("80")]),s("br"),s("span",{staticClass:"line-number"},[a._v("81")]),s("br"),s("span",{staticClass:"line-number"},[a._v("82")]),s("br"),s("span",{staticClass:"line-number"},[a._v("83")]),s("br"),s("span",{staticClass:"line-number"},[a._v("84")]),s("br"),s("span",{staticClass:"line-number"},[a._v("85")]),s("br"),s("span",{staticClass:"line-number"},[a._v("86")]),s("br"),s("span",{staticClass:"line-number"},[a._v("87")]),s("br"),s("span",{staticClass:"line-number"},[a._v("88")]),s("br"),s("span",{staticClass:"line-number"},[a._v("89")]),s("br"),s("span",{staticClass:"line-number"},[a._v("90")]),s("br"),s("span",{staticClass:"line-number"},[a._v("91")]),s("br"),s("span",{staticClass:"line-number"},[a._v("92")]),s("br"),s("span",{staticClass:"line-number"},[a._v("93")]),s("br"),s("span",{staticClass:"line-number"},[a._v("94")]),s("br"),s("span",{staticClass:"line-number"},[a._v("95")]),s("br"),s("span",{staticClass:"line-number"},[a._v("96")]),s("br"),s("span",{staticClass:"line-number"},[a._v("97")]),s("br"),s("span",{staticClass:"line-number"},[a._v("98")]),s("br"),s("span",{staticClass:"line-number"},[a._v("99")]),s("br"),s("span",{staticClass:"line-number"},[a._v("100")]),s("br"),s("span",{staticClass:"line-number"},[a._v("101")]),s("br"),s("span",{staticClass:"line-number"},[a._v("102")]),s("br"),s("span",{staticClass:"line-number"},[a._v("103")]),s("br"),s("span",{staticClass:"line-number"},[a._v("104")]),s("br"),s("span",{staticClass:"line-number"},[a._v("105")]),s("br"),s("span",{staticClass:"line-number"},[a._v("106")]),s("br"),s("span",{staticClass:"line-number"},[a._v("107")]),s("br"),s("span",{staticClass:"line-number"},[a._v("108")]),s("br"),s("span",{staticClass:"line-number"},[a._v("109")]),s("br"),s("span",{staticClass:"line-number"},[a._v("110")]),s("br"),s("span",{staticClass:"line-number"},[a._v("111")]),s("br"),s("span",{staticClass:"line-number"},[a._v("112")]),s("br"),s("span",{staticClass:"line-number"},[a._v("113")]),s("br"),s("span",{staticClass:"line-number"},[a._v("114")]),s("br"),s("span",{staticClass:"line-number"},[a._v("115")]),s("br"),s("span",{staticClass:"line-number"},[a._v("116")]),s("br"),s("span",{staticClass:"line-number"},[a._v("117")]),s("br"),s("span",{staticClass:"line-number"},[a._v("118")]),s("br"),s("span",{staticClass:"line-number"},[a._v("119")]),s("br"),s("span",{staticClass:"line-number"},[a._v("120")]),s("br"),s("span",{staticClass:"line-number"},[a._v("121")]),s("br"),s("span",{staticClass:"line-number"},[a._v("122")]),s("br"),s("span",{staticClass:"line-number"},[a._v("123")]),s("br"),s("span",{staticClass:"line-number"},[a._v("124")]),s("br"),s("span",{staticClass:"line-number"},[a._v("125")]),s("br"),s("span",{staticClass:"line-number"},[a._v("126")]),s("br"),s("span",{staticClass:"line-number"},[a._v("127")]),s("br"),s("span",{staticClass:"line-number"},[a._v("128")]),s("br"),s("span",{staticClass:"line-number"},[a._v("129")]),s("br"),s("span",{staticClass:"line-number"},[a._v("130")]),s("br"),s("span",{staticClass:"line-number"},[a._v("131")]),s("br"),s("span",{staticClass:"line-number"},[a._v("132")]),s("br"),s("span",{staticClass:"line-number"},[a._v("133")]),s("br"),s("span",{staticClass:"line-number"},[a._v("134")]),s("br"),s("span",{staticClass:"line-number"},[a._v("135")]),s("br"),s("span",{staticClass:"line-number"},[a._v("136")]),s("br"),s("span",{staticClass:"line-number"},[a._v("137")]),s("br"),s("span",{staticClass:"line-number"},[a._v("138")]),s("br"),s("span",{staticClass:"line-number"},[a._v("139")]),s("br"),s("span",{staticClass:"line-number"},[a._v("140")]),s("br"),s("span",{staticClass:"line-number"},[a._v("141")]),s("br"),s("span",{staticClass:"line-number"},[a._v("142")]),s("br"),s("span",{staticClass:"line-number"},[a._v("143")]),s("br"),s("span",{staticClass:"line-number"},[a._v("144")]),s("br"),s("span",{staticClass:"line-number"},[a._v("145")]),s("br"),s("span",{staticClass:"line-number"},[a._v("146")]),s("br"),s("span",{staticClass:"line-number"},[a._v("147")]),s("br"),s("span",{staticClass:"line-number"},[a._v("148")]),s("br"),s("span",{staticClass:"line-number"},[a._v("149")]),s("br"),s("span",{staticClass:"line-number"},[a._v("150")]),s("br"),s("span",{staticClass:"line-number"},[a._v("151")]),s("br")])]),s("h3",{attrs:{id:"脚本同步"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#脚本同步"}},[a._v("#")]),a._v(" 脚本同步")]),a._v(" "),s("p",[a._v("除了手动同步，我们可以采用脚本来进行同步，同步到 Nacos 后，不会是一个配置文件，而是多个配置文件，每个配置文件就是 key，内容是 Value。比如上面 "),s("code",[a._v("seataServer.properties")]),a._v(" 的 "),s("code",[a._v("transport.type")]),a._v(" 作为 "),s("code",[a._v("data-id")]),a._v("，内容为 "),s("code",[a._v("TCP")]),a._v("。")]),a._v(" "),s("p",[a._v("接着打开 "),s("code",[a._v("script/config-center/nacos")]),a._v("，运行 "),s("code",[a._v("nacos-config.sh")]),a._v("，将剩下的其他配置文件推到 Nacos。")]),a._v(" "),s("p",[a._v("如果在 Windows，需要打开 Git-Bash 运行。")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[a._v("nacos-config.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-h")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("172.16")]),a._v(".138.184 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" 08e8c083-a242-4407-94bb-16a096b41d5d "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-u")]),a._v(" nacos "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" nacos\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[s("p",[a._v("h 是 Nacos 的地址")])]),a._v(" "),s("li",[s("p",[a._v("p 是 Nacos 的端口")])]),a._v(" "),s("li",[s("p",[a._v("t 是 Nacos 的命名空间 ID")])]),a._v(" "),s("li",[s("p",[a._v("u 是 Nacos 用户名")])]),a._v(" "),s("li",[s("p",[a._v("w 是 Nacos 密码")])])]),a._v(" "),s("h3",{attrs:{id:"添加数据库驱动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#添加数据库驱动"}},[a._v("#")]),a._v(" 添加数据库驱动")]),a._v(" "),s("p",[a._v("Seata 2.2.0 版本后，已经去掉了数据库的驱动 jar 包，所以需要手动往 "),s("code",[a._v("seata-server\\lib\\jdbc")]),a._v(" 里添加数据库驱动，如 MySQL 的驱动，否则直接启动 seaata 会报错无法找到数据库驱动。")]),a._v(" "),s("h3",{attrs:{id:"启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),s("p",[a._v("双击 "),s("code",[a._v("bin/seata-server.bat")]),a._v("（Windows）或者 "),s("code",[a._v("bin/seata-server.sh")]),a._v("（Linux）文件启动。")]),a._v(" "),s("h3",{attrs:{id:"客户端配置-rm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#客户端配置-rm"}},[a._v("#")]),a._v(" 客户端配置（RM）")]),a._v(" "),s("p",[a._v("添加依赖")]),a._v(" "),s("div",{staticClass:"language-xml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-xml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("com.alibaba.cloud"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("spring-cloud-starter-alibaba-seata"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("保持 "),s("code",[a._v("seata-spring-boot-starter")]),a._v(" 版本和自己的 seata-server.jar 版本一致")]),a._v(" "),s("p",[a._v("application.yml 配置")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("seata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("enabled")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("config")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 172.16.138.184"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("data-id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" seataServer.properties\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SEATA_GROUP\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 08e8c083"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("a242"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("4407"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("94bb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("16a096b41d5d\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("registry")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("nacos")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server-addr")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 172.16.138.184"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8848")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" SEATA_GROUP\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("namespace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 08e8c083"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("a242"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("4407"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("94bb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("16a096b41d5d\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" nacos\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("application")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" seata"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("server\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cluster")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" default\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("tx-service-group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" default_tx_group "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 事务分组配置")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br")])]),s("p",[a._v("注意的是："),s("code",[a._v("seata.tx-service-group")]),a._v(" 的值是 default_tx_group，对应着 Nacos 的 seataServer.properties 里的")]),a._v(" "),s("div",{staticClass:"language-properties line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-properties"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key attr-name"}},[a._v("service.vgroupMapping.default_tx_group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token value attr-value"}},[a._v("default")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("这个规范是 "),s("code",[a._v("seata.service.vgroup-mapping.事务分组名=集群名称")]),a._v("，因为我们有很多客户端，所以我们要配置一个事务分组，即在 application.yml 里的 default_tx_group 就对应 Nacos "),s("code",[a._v("seataServer.properties")]),a._v(" 的 default_tx_group。")]),a._v(" "),s("p",[a._v("而 default 就是集群名称，也就是 Nacos 的集群名称，默认是 default。")]),a._v(" "),s("p",[a._v("如果修改了 Nacos 的集群名称，则 default 要进行修改。")]),a._v(" "),s("p",[a._v("当然也可以在 "),s("code",[a._v("application.yml")]),a._v(" 写如下内容，该内容覆盖 Nacos "),s("code",[a._v("seataServer.properties")]),a._v(" 上的内容：")]),a._v(" "),s("div",{staticClass:"language-yml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("seata")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("service")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("vgroup-mapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("default_tx_group")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" default "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定事务分组至集群映射关系（等号右侧的集群名需要与 Seata-server 注册到 Nacos 的 cluster 保持一致）")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[a._v("#")]),a._v(" 使用")]),a._v(" "),s("blockquote",[s("p",[a._v("AT 模式")])]),a._v(" "),s("p",[a._v("在需要开启事务的方法上加 "),s("code",[a._v("@GlobalTransactional")]),a._v("。")])])}),[],!1,null,null,null);s.default=e.exports}}]);